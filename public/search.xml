<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Oracle数据库管理</title>
      <link href="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/"/>
      <url>/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="Oracle数据库管理"><a href="#Oracle数据库管理" class="headerlink" title="Oracle数据库管理"></a>Oracle数据库管理</h1><h2 id="版本适用范围"><a href="#版本适用范围" class="headerlink" title="版本适用范围"></a>版本适用范围</h2><p>Oracle 12.2</p><h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><p>通过setenv或者export设置ORACLE_HOME和ORACLE_SID</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setenv ORACLE_SID orcl</span><br><span class="line">setenv ORACLE_HOME /u01/app/oracle/product/12.1.0/db_1</span><br><span class="line">setenv LD_LIBRARY_PATH $ ORACLE_HOME / lib：/ usr / lib：/ usr / dt / lib：/ usr / openwin / lib：/ usr / ccs / lib</span><br></pre></td></tr></table></figure><h2 id="连接到数据库"><a href="#连接到数据库" class="headerlink" title="连接到数据库"></a>连接到数据库</h2><p>1.无登陆的方式</p><blockquote><p>sqlplus / nolog</p></blockquote><p>2.以最高权限登陆，操作系统认证的方式进行连接，不需要密码。</p><p>需要设置最高权限的用户组，并且切换到该用户下。多实例的情况下需要切换SID</p><blockquote><p>sqlplus / as sysdba</p></blockquote><p>切换SID</p><blockquote><p>export ORACLE_SID=[SID]</p></blockquote><p>3.切换连接</p><p>连接到sqlplus后，更改用户</p><blockquote><p>conn 账户/密码</p></blockquote><p>切换到远程数据库</p><p>connect [用户名]@”[IP/域名]:[端口]/[数据库服务名]”</p><blockquote><p>connect apps@”10.38.1.140:1552/DEV”</p></blockquote><p>或</p><blockquote><p>conn apps@”10.38.1.140:1552/DEV”</p></blockquote><h2 id="查询数据库版本号"><a href="#查询数据库版本号" class="headerlink" title="查询数据库版本号"></a>查询数据库版本号</h2><blockquote><p>SELECT *<br>FROM product_component_version;</p></blockquote><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112131119-2g9l1pb-image.png" alt="image.png"></p><h2 id="ORACLE参数"><a href="#ORACLE参数" class="headerlink" title="ORACLE参数"></a>ORACLE参数</h2><h3 id="初始化参数"><a href="#初始化参数" class="headerlink" title="初始化参数"></a>初始化参数</h3><h4 id="初始化参数文件"><a href="#初始化参数文件" class="headerlink" title="初始化参数文件"></a>初始化参数文件</h4><p>对于任意参数文件的修改，都需要重启数据库实例后才会生效。</p><p>参数文件存放于 <code>$ORACLE_HOME/dbs</code> 目录下，并且文件名为 <code>init[SID].ora</code></p><p>如：下图，其中initTest.ora是初始化的参数文件</p><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112145658-adh2nkd-image.png" alt="image.png"></p><h4 id="查看初始化参数"><a href="#查看初始化参数" class="headerlink" title="查看初始化参数"></a>查看初始化参数</h4><blockquote><p>show parameter [参数选项]</p></blockquote><p>可用参数选项如下</p><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112144807-ai95qe8-image.png" alt="image.png"></p><p>例如：查看重做日志表空间</p><blockquote><p>show parameter undo_tablespace</p></blockquote><h4 id="修改初始化参数"><a href="#修改初始化参数" class="headerlink" title="修改初始化参数"></a>修改初始化参数</h4><p>使用 <code>alter session set [参数] = [参数值]</code> 进行当前会话临时修改，不会影响其他会话，该参数也不会被保存。</p><p>如修改当前会话的日期格式</p><blockquote><p>ALTER SESSION SET NLS_DATE_FORMAT = ‘yyyy-mm-dd hh24:mi:ss’;</p></blockquote><p>从动态性能视图中查询所有的初始化参数</p><blockquote><p>SELECT *<br>FROM v$parameter;</p></blockquote><p>结果如下：</p><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112151055-20tri5o-image.png" alt="image.png"></p><blockquote><p>该视图的说明</p><p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/V-PARAMETER.html#GUID-C86F3AB0-1191-447F-8EDF-4727D8693754" target="_blank" rel="noopener">https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/V-PARAMETER.html#GUID-C86F3AB0-1191-447F-8EDF-4727D8693754</a></p></blockquote><h3 id="服务器参数"><a href="#服务器参数" class="headerlink" title="服务器参数"></a>服务器参数</h3><h4 id="服务器参数文件"><a href="#服务器参数文件" class="headerlink" title="服务器参数文件"></a>服务器参数文件</h4><ul><li>pfile：文本文件，可以直接修改</li><li>spfile：二进制保存，只能通过命令修改</li></ul><p>持久化存放在 <code>$ORACLE_HOME/dbs</code> 目录下，并且由初始化参数文件中的 <code>SPFILE</code> 参数指定，并且文件名为 <code>spfile[SID].ora</code> 或默认的 <code>spfile.ora</code></p><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112151628-xx3flv3-image.png" alt="image.png"></p><p><strong>Oracle启动过程</strong></p><p>在Oracle启动实例时，会先启动进程加载参数文件，然后根据参数加载实例。</p><p>如果创建了spfile，则oracle会使用启动进程，并从spfile中加载数据库配置；如果没有则直接加载初始化参数文件。</p><p><strong>查询是否启用spfile</strong></p><p>如果查询不为空则启用spfile</p><blockquote><p>SELECT name,value FROM v$parameter WHERE name=’spfile’;</p></blockquote><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112152043-q309olb-image.png" alt="image.png"></p><h4 id="修改参数文件"><a href="#修改参数文件" class="headerlink" title="修改参数文件"></a>修改参数文件</h4><blockquote><p>Alter system set parameter=value &lt;comment=’text’&gt; <deffered> &lt;scope=memory|spfile|both&gt; &lt;sid=’sid|*’&gt;</deffered></p></blockquote><h4 id="查看参数文件"><a href="#查看参数文件" class="headerlink" title="查看参数文件"></a>查看参数文件</h4><p>如果value不为空，则启用服务器参数文件</p><p><img src="/2021/01/12/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86/20210112153043-5md8d7k-image.png" alt="image.png"></p><p>这个图可以发现，没有持久化服务器参数文件。</p><h2 id="常用视图"><a href="#常用视图" class="headerlink" title="常用视图"></a>常用视图</h2><h3 id="静态数据字典"><a href="#静态数据字典" class="headerlink" title="静态数据字典"></a>静态数据字典</h3><h4 id="权限控制"><a href="#权限控制" class="headerlink" title="权限控制"></a>权限控制</h4><ul><li>dba_[表名]：显示所有对象，仅允许有dba权限的用户访问</li><li>all_[表名]：显示所有用户下的对象，允许跨用户访问（如果有权限）</li><li>user_[表名]：仅显示当前用户下的对象</li><li>cdb_[表名]：如果启用多租户架构的容器数据库，则可以跨租户查看（如果有权限）</li></ul><h4 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h4><ul><li>ALL_ALL_TABLES：当前用户可以访问的所有表</li><li>ALL_ARGUMENTS：当前用户可以访问的所有函数和过程</li><li>ALL_CATALOG：当前用户可访问的表，聚类，视图，同义词和序列</li><li>ALL_COL_COMMENTS：当前用户下所有存在注释的字段</li><li>ALL_COLL_TYPES：当前用户下可访问的所有集合类型</li><li>ALL_CONS_COLUMNS：当前用户下可以访问的包含约束的字段</li><li>ALL_CONSTRAINTS：当前用户下可以访问的所有表中的约束</li><li>ALL_DB_LINKS：当前用户下可以访问的所有dblink</li><li>ALL_DEPENDENCIES：当前用户下所有的依赖关系，注意查询时 <code>referenced_link_name</code> 不要为空</li><li>ALL_ERRORS：查询当前用户下所有对象的异常信息，根据字段 <code>sequence</code> 排序</li><li>ALL_IND_COLUMNS：查看当前用户下包含索引的列</li><li>ALL_INDEXES：当前用户下全部索引</li><li>ALL_JOBS：当前用户下所有定时任务</li><li>ALL_OBJECTS：当前用户下所有对象</li><li>ALL_SOURCE：查看所有package中的函数定义</li></ul><h4 id="数据库文件"><a href="#数据库文件" class="headerlink" title="数据库文件"></a>数据库文件</h4><ul><li>ALL_DIRECTORIES：当前用户下可以访问的文件目录</li></ul><h3 id="动态性能视图"><a href="#动态性能视图" class="headerlink" title="动态性能视图"></a>动态性能视图</h3><p>动态性能视图以 <code>v$</code>开头</p><p>只有dba权限的用户能够访问，每一个性能视图都是由数据库实例都是动态生成的，无法进行更新。</p><ul><li><p>V$INSTANCE：当前数据库实例</p></li><li><p>V$SGA：查看SGA信息</p></li><li><p>V$SGAINFO：查看SGA详细信息</p></li><li><p>V$PARAMETER：查看初始化参数</p></li><li><p>V$VERSION：查看数据库版本</p></li><li><p>V$OPTION：查看数据库产品信息</p></li><li><p>V$SESSION：查看会话信息</p></li><li><p>V$PROCESS：查看进程信息</p></li><li><p>V$LOCK：查看占有锁的会话</p></li><li><p>V$TABLESPACE：表空间信息</p></li><li><p>v$parameter：查看所有参数信息</p></li><li><p>数据文件</p><ul><li>V$CONTROLFILE：控制文件路径</li><li>V$DATAFILE：数据文件路径</li><li>V$LOGFILE：日志文件路径</li></ul></li><li><p>SQL</p><ul><li>v$sql：执行过的sql详细信息</li><li>v$sqltext：sql文本，可以与上面的表关联</li><li>注意：并不是所有的 SQL 语句都可以从 V$SQL 中找到，因为 ORACLE 会动态地<br>更新共享池的信息，将一些过旧的 SQL 从共享池中删除</li></ul></li></ul><p>SQL 的解析的过程中，会把硬解析之后的 SQL 放在放在共享池中，如果我们清空了共享池，那么就需要重新做硬分析。</p><blockquote><p>alter system flush shared_pool;</p></blockquote><h5 id="查看sql性能"><a href="#查看sql性能" class="headerlink" title="查看sql性能"></a>查看sql性能</h5><blockquote><p>select * from v$sql ;</p><p>SELECT sql_text,<br>cpu_time / (1000 * 1000) t_cpu,<br>TRUNC (elapsed_time / (1000 * 1000)) t_elap,<br>(cpu_time / elapsed_time / (1000 * 1000)) * 100 pct<br>FROM v$sql<br>WHERE sql_text LIKE ‘SELECT OFFER_GROUP_ID_SEQ.NEXTVAL FROM DUA%’;</p></blockquote><p>对于已经执行完毕的会话，可以在 V$SQL 视图中找到它的执行时间和消耗的 CPU 时间，这些信息对我们分析一些性能上存在问题的 SQL 有用处。比如对比 SQL 消耗的 CPU 和执行时间，就可以大致知道 SQL 语句执行中是否有长时间的等待事件：</p><h2 id="官方参考手册"><a href="#官方参考手册" class="headerlink" title="官方参考手册"></a>官方参考手册</h2><p>1.Database Administrator’s Guide</p><blockquote><p>官方文档 <a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/admin/getting-started-with-database-administration.html#GUID-9563BFC5-2A73-4271-9108-B4149018B8AD" target="_blank" rel="noopener">https://docs.oracle.com/en/database/oracle/oracle-database/12.2/admin/getting-started-with-database-administration.html#GUID-9563BFC5-2A73-4271-9108-B4149018B8AD</a></p></blockquote><p>2.Database Reference</p><blockquote><p>官方文档 <a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/basic-initialization-parameters.html#GUID-D75F1A77-47E2-4F35-B145-44B3A10ED85C" target="_blank" rel="noopener">https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/basic-initialization-parameters.html#GUID-D75F1A77-47E2-4F35-B145-44B3A10ED85C</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Database </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从BIEE 12看数据仓库(一)</title>
      <link href="/2020/06/19/%E4%BB%8EBIEE%E7%9C%8B%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93(%E4%B8%80)/"/>
      <url>/2020/06/19/%E4%BB%8EBIEE%E7%9C%8B%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h1 id="从BIEE-12看数据仓库（一）"><a href="#从BIEE-12看数据仓库（一）" class="headerlink" title="从BIEE 12看数据仓库（一）"></a>从BIEE 12看数据仓库（一）</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h4 id="OLTP"><a href="#OLTP" class="headerlink" title="OLTP"></a>OLTP</h4><ul><li><p>OLTP即联机事务处理(On-Line Transaction Processing)，主要指发生在<strong>操作型系统</strong>上的面向事务的操作，这里的事务特指业务上的统一且不可分割的一系列操作，而不是数据库中增删改查的单个原子操作。</p></li><li><p>OLTP经常触发CRUD操作（CRUD是指在做计算处理时的增加(Create)、读取查询(Retrieve)、更新(Update)和删除(Delete)），是插入和更新密集型操作，要求（超）高并发，响应快。</p><p><strong>ORCALE EBS</strong>系统就是一个例子：用户在订单管理器创建订单，供应商的可用余额扣减，库存的可用量也同时扣减。从数据库角度上看，涉及到两个表（简化模型，实际涉及多张表）的更新操作，也就是发生了两个单独的update；但是从业务的角度上来说，这是同一个事务，即更新供应商余额和扣减库存必须同时成功，其中一个失败，整个事务必须回滚到处理前的结果。</p></li></ul><h4 id="OLAP"><a href="#OLAP" class="headerlink" title="OLAP"></a>OLAP</h4><ul><li><p>OLAP即联机分析处理(On-Line Analytical Processing)，主要指发生在<strong>分析型系统</strong>上的面向多维度查询操作，通常在装载数据前需要清洗和转换。</p></li><li><p>OLAP处理的事务相对<strong>操作型系统</strong>来说较少，但是查询通常对历史的、归档的数据进行非常复杂的逻辑，如聚合计算，大量表关联等，属于查询密集型操作，要求能够体现多维度，多主题，高整合度，能够反映变化趋势的数据。</p><p><strong>ORACLE BIEE</strong>上展现报表诸如<strong>库存账龄、追溯库存历史、现金流</strong>等，是对整个数据库业务数据的高度检索，能够反映出业务数据的同比（去年同期）和环比(同年不同季)。</p></li></ul><table><thead><tr><th>对比项</th><th>OLAP</th><th>OLTP</th></tr></thead><tbody><tr><td>数据源</td><td>可能来源于多个不同的业务系统，主要是历史、归档的数据</td><td>当前系统业务操作的所有明细记录都要保存</td></tr><tr><td>操作</td><td>注重于大量表的查询和聚合计算，数据装载量大</td><td>注重更新和插入，要求执行速度快，并发量大</td></tr><tr><td>应用</td><td>决策支持系统，报表分析系统</td><td>在线的交易、管理系统</td></tr><tr><td>用户</td><td>管理人员、分析人员</td><td>终端用户</td></tr><tr><td>数据模型</td><td>雪花型或星型模型</td><td>实体关系模型</td></tr><tr><td>备份</td><td>按天增量同步，若数据丢失需要从操作型系统重新装载</td><td>全量定期备份，数据不可丢失</td></tr><tr><td>时间</td><td>以年为单位</td><td>从天到年</td></tr><tr><td>空间要求</td><td>存放多个系统的数据的数据仓库，空间要求大</td><td>仅存放当前操作数据，空间要求小</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h4 id="数据仓库定义"><a href="#数据仓库定义" class="headerlink" title="数据仓库定义"></a>数据仓库定义</h4><p>数据仓库描述为一个面向主题的、集成的、随时间变化的、非易失的数据集合,用于支持管理者的决策过程。数据仓库通过抽取一个或多个系统的数据，经过清洗、转换装载到新的数据库中，它是OLAP的基础。</p><h5 id="数据仓库的必要性"><a href="#数据仓库的必要性" class="headerlink" title="数据仓库的必要性"></a>数据仓库的必要性</h5><ul><li>数据的类型非常多，除了不同数据库需要特定的一个仓库兼容以外，还有各种各样的文件类型（如xls、csv、html、xml等）</li><li>出于权限控制的要求，一个用户不能同时访问多个系统或多个数据表</li><li>用户需要看的字段，在数据库中可能需要一定的转换才能呈现，而每次发生业务变更后可能都需要额外编写这些字段，导致工作重复</li><li>系统以联机事务处理为主，频繁访问分析数据，可能会导致性能变差</li></ul><h5 id="数据仓库的特性"><a href="#数据仓库的特性" class="headerlink" title="数据仓库的特性"></a>数据仓库的特性</h5><ul><li>面向主题：拥有通过划分主题定义数据仓库的能力</li><li>集成：即面对多个系统、多个数据库，能够统一转换后存放在一起。同时能够解决命名冲突的问题</li><li>随时间变化：数据仓库关注的是数据随时间变化的情况,并且能反映在过去某个时间点的数据是怎样的。</li><li>稳定：一旦进入到数据仓库中,数据就不应该再有改变。</li><li>粒度：粒度之所以是数据仓库环境的关键设计问题,是因为它极大地影响数据仓库的数据量和可以进行的查询类型。粒度级别越低,数据量越大,查询的细节程度越高,查询范围越广泛,反之亦然。</li></ul><h2 id="数据仓库概念设计"><a href="#数据仓库概念设计" class="headerlink" title="数据仓库概念设计"></a>数据仓库概念设计</h2><h4 id="基本架构"><a href="#基本架构" class="headerlink" title="基本架构"></a>基本架构</h4><img src="/2020/06/19/%E4%BB%8EBIEE%E7%9C%8B%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93(%E4%B8%80)/BIEE%E6%9E%B6%E6%9E%84.jpg" class><h4 id="数据需求"><a href="#数据需求" class="headerlink" title="数据需求"></a>数据需求</h4><h5 id="事实和维度"><a href="#事实和维度" class="headerlink" title="事实和维度"></a>事实和维度</h5><ol><li>明确业务范围，想清楚要设立的主题有哪些，主题下面的分析表有多少，然后确定装载数据的ER实体关系，每一个实体关系就是一个事实。</li><li>明确维度指标的范围，维度的范围随着业务范围改变而改变。<br>财务主题常用的维度一般有账龄、帐簿、成本中心、会计科目、法人、经营单位、客户、供应商、供应商地点、位置、销售员等；<br>库存主题常用的维度一般有物料、库存组织、子库存、货位、批次号、物料账龄等；<br>通用的维度一般有时间维度，按年月日存放。</li><li>明确事实表所选用的数据模型，一般从星型和和雪花型中选择。在雪花模式中,一个维度被规范化成多个关联的表,而在星型模式中,每个维度由一个单一的维度表所表示。<br>例如：单一的时间维度，在星型模型中，包含年份、月份、天，都存放在同一个表里，而雪花型中区分为年份维，月份维和天数维；产品维度分解成产品分类、产品两个表。</li></ol><h5 id="数据需求-1"><a href="#数据需求-1" class="headerlink" title="数据需求"></a>数据需求</h5><ol><li>时效性：明确时间粒度，对于时效性较强的数据，抓取的数据频率要提高，但是对于分析型系统而言一般不需要很强的实时性，一般把抓取数据的频率定为以一天为粒度。</li><li>追溯性：从业务系统中生成到BIEE的分析表要根据实际情况，部分分析表会有查询到某一历史事件点的需求。</li></ol>]]></content>
      
      
      <categories>
          
          <category> ORACLE BIEE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DATAWARE HOUSE </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
