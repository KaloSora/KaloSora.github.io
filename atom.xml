<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>KaloSoraçš„åšå®¢</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-03-16T02:18:10.560Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>KaloSora</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>K8sè‡ªåŠ¨æ‰©å®¹å’Œè‡ªæ„ˆ</title>
    <link href="http://example.com/2025/03/16/K8s%E8%87%AA%E5%8A%A8%E6%89%A9%E5%AE%B9%E5%92%8C%E8%87%AA%E6%84%88/"/>
    <id>http://example.com/2025/03/16/K8s%E8%87%AA%E5%8A%A8%E6%89%A9%E5%AE%B9%E5%92%8C%E8%87%AA%E6%84%88/</id>
    <published>2025-03-16T02:00:11.000Z</published>
    <updated>2025-03-16T02:18:10.560Z</updated>
    
    <content type="html"><![CDATA[<p>â€â€â€</p><h2 id="è‡ªåŠ¨è‡ªæ„ˆ"><a href="#è‡ªåŠ¨è‡ªæ„ˆ" class="headerlink" title="è‡ªåŠ¨è‡ªæ„ˆ"></a>è‡ªåŠ¨è‡ªæ„ˆ</h2><p>ä»€ä¹ˆæ˜¯è‡ªåŠ¨è‡ªæ„ˆï¼Ÿ</p><ul><li>å½“ä¸šåŠ¡è¿›ç¨‹æ„å¤–ä¸­æ–­ï¼Œæˆ–è€…èŠ‚ç‚¹äº§ç”Ÿæ•…éšœæ—¶ï¼Œç³»ç»Ÿå¯ä»¥å¿«é€Ÿè¯†åˆ«ï¼Œè‡ªåŠ¨é‡å¯å¹¶æ¢å¤æœåŠ¡ã€‚</li><li>è‡ªæ„ˆèƒ½å¤Ÿè‡ªåŠ¨è½¬ç§»æ•…éšœï¼Œä¹Ÿå°±æ˜¯è®©ä¸šåŠ¡ä¸å¥åº·çš„èŠ‚ç‚¹ä¸æ¥æ”¶æµé‡ï¼Œä¿è¯ç”¨æˆ·ä½“éªŒã€‚</li></ul><p>é€šè¿‡è‡ªåŠ¨è‡ªæ„ˆæ‘†è„± 7*24 å°æ—¶ OncallğŸ˜€</p><p>â€</p><p><strong>é¦–å…ˆ</strong>ï¼Œé€šè¿‡ kubectl create deployment åˆ›å»ºå¦ä¸€ç§å·¥ä½œè´Ÿè½½ç±»å‹ï¼šDeploymentã€‚</p><p>ä¾‹å¦‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl create deployment hello-docker-flask --image=kalosora/hello-docker-flask:latest --replicas=2</span><br><span class="line">deployment.apps/hello-docker-flask created</span><br></pre></td></tr></table></figure><ul><li>hello-docker-flaskï¼Œä»£è¡¨å·¥ä½œè´Ÿè½½çš„åç§°</li><li>â€“ imageï¼Œä»£è¡¨é•œåƒåç§°</li><li>â€“replicasï¼Œ ä»£è¡¨podçš„å‰¯æœ¬æ•°</li><li>è¿˜å¯ä»¥æ·»åŠ  â€“dry-run&#x3D;client å’Œ -o å‚æ•°ï¼Œå•çº¯è¾“å‡º Manifest å†…å®¹</li></ul><p>æœ¬è´¨ä¸Šï¼Œè¿™æ¡å‘½ä»¤ä¼šç”Ÿæˆ Deployment Manifestï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ kubectl apply å°† Manifest åº”ç”¨åˆ°é›†ç¾¤å†…ï¼Œçœç•¥äº†æˆ‘ä»¬æ‰‹åŠ¨ç¼–å†™ Manifest çš„è¿‡ç¨‹</p><p>â€</p><p><strong>ç„¶å</strong>ï¼Œä½¿ç”¨ kubectl create service å‘½ä»¤åˆ›å»º Serviceï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl create service clusterip hello-docker-flask --tcp=5000:5000</span><br><span class="line">service/hello-docker-flask created</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p><strong>æ­¤å¤–</strong>ï¼Œä½¿ç”¨ kubectl create ingress å‘½ä»¤åˆ›å»º Ingressï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create ingress hello-docker-flask --rule=&quot;/=hello-docker-flask:5000&quot;</span><br></pre></td></tr></table></figure><p>â€</p><p><strong>æœ€å</strong>ï¼Œéƒ¨ç½²Ingress-nginx</p><p><a href="https://github.com/KaloSora/K8s-Learn/blob/main/resource/ingress-nginx/ingress-nginx.yaml">ingress-nginx</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl create -f https://ghfast.top/https://raw.githubusercontent.com/lyzhang1999/resource/main/ingress-nginx/ingress-nginx.yaml</span><br><span class="line">namespace/ingress-nginx created</span><br><span class="line">serviceaccount/ingress-nginx created</span><br><span class="line">serviceaccount/ingress-nginx-admission created</span><br><span class="line">role.rbac.authorization.k8s.io/ingress-nginx created</span><br><span class="line">role.rbac.authorization.k8s.io/ingress-nginx-admission created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/ingress-nginx created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/ingress-nginx-admission created</span><br><span class="line">rolebinding.rbac.authorization.k8s.io/ingress-nginx created</span><br><span class="line">rolebinding.rbac.authorization.k8s.io/ingress-nginx-admission created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/ingress-nginx created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/ingress-nginx-admission created</span><br><span class="line">configmap/ingress-nginx-controller created</span><br><span class="line">service/ingress-nginx-controller created</span><br><span class="line">service/ingress-nginx-controller-admission created</span><br><span class="line">deployment.apps/ingress-nginx-controller created</span><br><span class="line">job.batch/ingress-nginx-admission-create created</span><br><span class="line">job.batch/ingress-nginx-admission-patch created</span><br><span class="line">ingressclass.networking.k8s.io/nginx created</span><br><span class="line">validatingwebhookconfiguration.admissionregistration.k8s.io/ingress-nginx-admission created</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œä¸Šè¿°æ­¥éª¤ä»¥åï¼š</p><ol><li>Pod ä¼šè¢« Deployment å·¥ä½œè´Ÿè½½ç®¡ç†èµ·æ¥ï¼Œä¾‹å¦‚åˆ›å»ºå’Œé”€æ¯ç­‰ï¼›</li><li>Service ç›¸å½“äºå¼¹æ€§ä¼¸ç¼©ç»„çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œå®ƒèƒ½ä»¥åŠ æƒè½®è®­çš„æ–¹å¼å°†æµé‡è½¬å‘åˆ°å¤šä¸ª Pod å‰¯æœ¬ä¸Šï¼›</li><li>Ingress ç›¸å½“äºé›†ç¾¤çš„å¤–ç½‘è®¿é—®å…¥å£ã€‚</li></ol><p>â€</p><p><strong>å¼€å§‹K8sè‡ªæ„ˆå®éªŒã€‚</strong></p><p>æŸ¥çœ‹ç°æœ‰çš„pod</p><p>â€‹<img src="/2025/03/16/K8s%E8%87%AA%E5%8A%A8%E6%89%A9%E5%AE%B9%E5%92%8C%E8%87%AA%E6%84%88/image-20250315224138-a9l4fdq.png" alt="image">â€‹</p><p>æœ‰äº† Ingress-nginxï¼Œæˆ‘ä»¬è®¿é—® Pod å°±ä¸å†éœ€è¦è¿›è¡Œç«¯å£è½¬å‘äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—® 127.0.0.1ã€‚ä¸‹é¢çš„å‘½ä»¤ä¼šæ¯éš” 1 ç§’é’Ÿå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œå¹¶æ‰“å°å‡ºæ—¶é—´å’Œè¿”å›å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % while true; do sleep 1; curl http://127.0.0.1; echo -e &#x27;\n&#x27;$(date);done</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-txhbk</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†21ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-ccjnc</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†22ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-ccjnc</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†23ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-txhbk</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†24ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-txhbk</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†25ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-ccjnc</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†26ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-ccjnc</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†27ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-txhbk</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†28ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-ccjnc</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†29ç§’ CST</span><br><span class="line">Hello, my first docker images! hello-docker-flask-5dccc98654-ccjnc</span><br><span class="line">2025å¹´ 3æœˆ15æ—¥ æ˜ŸæœŸå…­ 22æ—¶42åˆ†30ç§’ CST</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥å‘ç°ï¼Œè¯·æ±‚è¢«åˆ†é…åˆ°äº†ä¸¤ä¸ª Pod ä¸Šï¼ŒPod åç§°æ˜¯äº¤æ›¿å‡ºç°çš„ã€‚</p><p>â€</p><p>æ¨¡æ‹Ÿå…¶ä¸­çš„ä¸€ä¸ª Pod å®•æœºï¼Œè§‚å¯Ÿè¿”å›å†…å®¹ã€‚</p><p>å¼€å¯æ–°çš„å‘½ä»¤è¡Œçª—å£ï¼Œç»ˆæ­¢å…¶ä¸­ä¸€ä¸ªpodçš„pythonè¿›ç¨‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl exec -it hello-docker-flask-5dccc98654-ccjnc -- bash -c &quot;killall python3&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><p>ç­‰å¾…å‡ ç§’é’Ÿåå¯ä»¥çœ‹è§ï¼Œæ‰€æœ‰çš„æµé‡éƒ½è¢«è½¬å‘åˆ°äº† <code>hello-docker-flask-5dccc98654-txhbk</code>â€‹</p><p>â€‹<img src="/2025/03/16/K8s%E8%87%AA%E5%8A%A8%E6%89%A9%E5%AE%B9%E5%92%8C%E8%87%AA%E6%84%88/image-20250315224808-cbfg1rf.png" alt="image">â€‹</p><p>ç´§æ¥ç€ï¼Œ<code>hello-docker-flask-5dccc98654-ccjnc</code>â€‹ä¹Ÿæ¢å¤äº†æœåŠ¡</p><p>â€</p><h2 id="è‡ªåŠ¨æ‰©å®¹"><a href="#è‡ªåŠ¨æ‰©å®¹" class="headerlink" title="è‡ªåŠ¨æ‰©å®¹"></a>è‡ªåŠ¨æ‰©å®¹</h2><p>è‡ªåŠ¨æ‰©å®¹ä¾èµ–äº K8s Metric Server æä¾›çš„ç›‘æ§æŒ‡æ ‡ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…å®ƒï¼š</p><p><a href="https://github.com/KaloSora/K8s-Learn/blob/main/resource/metrics/metrics.yaml">metrics.yaml</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl apply -f https://ghfast.top/https://raw.githubusercontent.com/lyzhang1999/resource/main/metrics/metrics.yaml</span><br><span class="line">serviceaccount/metrics-server created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/system:metrics-server created</span><br><span class="line">rolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/system:metrics-server created</span><br><span class="line">service/metrics-server created</span><br><span class="line">deployment.apps/metrics-server created</span><br><span class="line">apiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created</span><br></pre></td></tr></table></figure><p>â€</p><p>å®‰è£…å®Œæˆåï¼Œç­‰å¾… Metric å·¥ä½œè´Ÿè½½å°±ç»ªï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl wait deployment -n kube-system metrics-server --for condition=Available=True --timeout=90s</span><br><span class="line">deployment.apps/metrics-server condition met</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p>Metric Server å°±ç»ªåï¼Œé€šè¿‡ kubectl autoscale å‘½ä»¤æ¥ä¸º Deployment åˆ›å»ºè‡ªåŠ¨æ‰©å®¹ç­–ç•¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl autoscale deployment hello-docker-flask --cpu-percent=50 --min=2 --max=10</span><br><span class="line">horizontalpodautoscaler.autoscaling/hello-docker-flask autoscaled</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€“cpu-percent è¡¨ç¤º CPU ä½¿ç”¨ç‡é˜ˆå€¼ï¼Œå½“ CPU è¶…è¿‡ 50% æ—¶å°†è¿›è¡Œè‡ªåŠ¨æ‰©å®¹ï¼›</p><p>â€“min ä»£è¡¨æœ€å°çš„ Pod å‰¯æœ¬æ•°ï¼›</p><p>â€“max ä»£è¡¨æœ€å¤§æ‰©å®¹çš„å‰¯æœ¬æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªåŠ¨æ‰©å®¹ä¼šæ ¹æ® CPU çš„ä½¿ç”¨ç‡åœ¨ 2 ä¸ªå‰¯æœ¬å’Œ 10 ä¸ªå‰¯æœ¬ä¹‹é—´è¿›è¡Œæ‰©ç¼©å®¹</p><p>â€</p><p>æœ€åï¼Œè¦ä½¿è‡ªåŠ¨æ‰©å®¹ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦ä¸ºåˆšæ‰éƒ¨ç½²çš„ hello-docker-flask Deployment è®¾ç½®èµ„æºé…é¢ã€‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥é…ç½®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl patch deployment hello-docker-flask --type=&#x27;json&#x27; -p=&#x27;[&#123;&quot;op&quot;: &quot;add&quot;, &quot;path&quot;: &quot;/spec/template/spec/containers/0/resources&quot;, &quot;value&quot;: &#123;&quot;requests&quot;: &#123;&quot;memory&quot;: &quot;100Mi&quot;, &quot;cpu&quot;: &quot;100m&quot;&#125;&#125;&#125;]&#x27;</span><br><span class="line">deployment.apps/hello-docker-flask patched</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p>ç°åœ¨ï¼ŒDeployment å°†ä¼šé‡æ–°åˆ›å»ºä¸¤ä¸ªæ–°çš„ Podï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç­›é€‰å‡ºæ–°çš„ Podï¼š</p><p>â€‹<img src="/2025/03/16/K8s%E8%87%AA%E5%8A%A8%E6%89%A9%E5%AE%B9%E5%92%8C%E8%87%AA%E6%84%88/image-20250316094914-emi0rys.png" alt="image">â€‹</p><p>å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl get pod --field-selector=status.phase==Running</span><br><span class="line">NAME                                  READY   STATUS    RESTARTS   AGE</span><br><span class="line">hello-docker-flask-7b8f894675-bvnj6   1/1     Running   0          81s</span><br><span class="line">hello-docker-flask-7b8f894675-pn5br   1/1     Running   0          86s</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p>é€‰æ‹©ä¸€ä¸ª Pod å¹¶ä½¿ç”¨ kubectl exec è¿›å…¥åˆ°å®¹å™¨å†…ã€‚æ¨¡æ‹Ÿä¸šåŠ¡é«˜å³°æœŸåœºæ™¯ï¼Œä½¿ç”¨ ab å‘½ä»¤æ¥åˆ›å»ºå¹¶å‘è¯·æ±‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@hello-docker-flask-7b8f894675-bvnj6:/app#</span><br><span class="line">root@hello-docker-flask-7b8f894675-bvnj6:/app# ab -c 50 -n 10000 http://127.0.0.1:5000/</span><br><span class="line">This is ApacheBench, Version 2.3 &lt;$Revision: 1913912 $&gt;</span><br><span class="line">Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/</span><br><span class="line">Licensed to The Apache Software Foundation, http://www.apache.org/</span><br><span class="line"></span><br><span class="line">Benchmarking 127.0.0.1 (be patient)</span><br></pre></td></tr></table></figure><p>â€</p><p>å¼€å¯æ–°çš„å‘½ä»¤è¡Œçª—å£ï¼ŒæŒç»­ç›‘æ§ Pod çš„çŠ¶æ€ï¼Œâ€“watch å‚æ•°ä¼šä¸€ç›´ç­‰å¾…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods --watch</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯ä»¥è§‚å¯Ÿåˆ°K8så·²ç»æ„ŸçŸ¥åˆ°äº†Podçš„å‹åŠ›ï¼Œå¹¶ä¸”æ­£åœ¨è‡ªåŠ¨æ¨ªå‘æ‰©å®¹</p><p>â€‹<img src="/2025/03/16/K8s%E8%87%AA%E5%8A%A8%E6%89%A9%E5%AE%B9%E5%92%8C%E8%87%AA%E6%84%88/image-20250316095640-f39x90m.png" alt="image">â€‹</p><p>â€</p><p>å®éªŒçš„æœ€åï¼Œæ‰§è¡Œ kind delete cluster æ¥åˆ é™¤é›†ç¾¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Last login: Sun Mar 16 09:54:59 on ttys001</span><br><span class="line">(base) yihui.li@yihuilideMBP ~ % kind delete cluster</span><br><span class="line">Deleting cluster &quot;kind&quot; ...</span><br><span class="line">Deleted nodes: [&quot;kind-control-plane&quot;]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€â€â€&lt;/p&gt;
&lt;h2 id=&quot;è‡ªåŠ¨è‡ªæ„ˆ&quot;&gt;&lt;a href=&quot;#è‡ªåŠ¨è‡ªæ„ˆ&quot; class=&quot;headerlink&quot; title=&quot;è‡ªåŠ¨è‡ªæ„ˆ&quot;&gt;&lt;/a&gt;è‡ªåŠ¨è‡ªæ„ˆ&lt;/h2&gt;&lt;p&gt;ä»€ä¹ˆæ˜¯è‡ªåŠ¨è‡ªæ„ˆï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ä¸šåŠ¡è¿›ç¨‹æ„å¤–ä¸­æ–­ï¼Œæˆ–è€…èŠ‚ç‚¹äº§ç”Ÿæ•…éšœæ—¶ï¼Œç³»ç»Ÿå¯ä»¥å¿«é€Ÿè¯†åˆ«ï¼Œ</summary>
      
    
    
    
    <category term="Cloud Native" scheme="http://example.com/categories/Cloud-Native/"/>
    
    
    <category term="Kubernetes" scheme="http://example.com/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>éƒ¨ç½²å®¹å™¨é•œåƒåˆ°K8s</title>
    <link href="http://example.com/2025/03/15/%E9%83%A8%E7%BD%B2%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%88%B0K8s/"/>
    <id>http://example.com/2025/03/15/%E9%83%A8%E7%BD%B2%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%88%B0K8s/</id>
    <published>2025-03-15T14:03:11.000Z</published>
    <updated>2025-03-16T01:31:40.874Z</updated>
    
    <content type="html"><![CDATA[<p>â€â€â€</p><h2 id="å®‰è£…Kubernetes"><a href="#å®‰è£…Kubernetes" class="headerlink" title="å®‰è£…Kubernetes"></a>å®‰è£…Kubernetes</h2><p>é¦–å…ˆå®‰è£…Kubernetes cli tool <code>Kubectl</code>â€‹ï¼Œå®ƒå…è®¸å¼€å‘è€…é€šè¿‡å‘½ä»¤åç®¡ç†Kubernetesçš„èµ„æºã€‚</p><p>*Macå¯ä»¥ä½¿ç”¨<code>Homebrew</code>â€‹å®‰è£…</p><p><a href="https://kubernetes.io/docs/reference/kubectl/">ä»€ä¹ˆæ˜¯Kubectl</a></p><p><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-macos/">å®‰è£…Kubectl</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP hello_docker %</span><br><span class="line">yihui.li@yihuilideMBP hello_docker % kubectl version --client</span><br><span class="line">Client Version: v1.28.2</span><br><span class="line">Kustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3</span><br><span class="line">yihui.li@yihuilideMBP hello_docker %</span><br></pre></td></tr></table></figure><p>â€</p><p>æ ¹æ®å®˜æ–¹æ­¥éª¤å®‰è£…<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-macos/">Kind</a>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œä½¿ç”¨éå¸¸ç®€å•ã€‚</p><p>â€</p><p>å¼€å§‹åˆ›å»ºK8s</p><p>å°†ä»¥ä¸‹å†…å®¹ä¿å­˜ä¸º config.yamlï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">kind: Cluster</span><br><span class="line">apiVersion: kind.x-k8s.io/v1alpha4</span><br><span class="line">nodes:</span><br><span class="line">- role: control-plane</span><br><span class="line">  kubeadmConfigPatches:</span><br><span class="line">  - |</span><br><span class="line">    kind: InitConfiguration</span><br><span class="line">    nodeRegistration:</span><br><span class="line">      kubeletExtraArgs:</span><br><span class="line">        node-labels: &quot;ingress-ready=true&quot;</span><br><span class="line">  extraPortMappings:</span><br><span class="line">  - containerPort: 80</span><br><span class="line">    hostPort: 80</span><br><span class="line">    protocol: TCP</span><br><span class="line">  - containerPort: 443</span><br><span class="line">    hostPort: 443</span><br><span class="line">    protocol: TCP</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œ kind create å‘½ä»¤ï¼Œåˆ›å»º K8s é›†ç¾¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kind create cluster --config config.yaml</span><br><span class="line">Creating cluster &quot;kind&quot; ...</span><br><span class="line"> âœ“ Ensuring node image (kindest/node:v1.32.2) ğŸ–¼</span><br><span class="line"> âœ“ Preparing nodes ğŸ“¦</span><br><span class="line"> âœ“ Writing configuration ğŸ“œ</span><br><span class="line"> âœ“ Starting control-plane ğŸ•¹ï¸</span><br><span class="line"> âœ“ Installing CNI ğŸ”Œ</span><br><span class="line"> âœ“ Installing StorageClass ğŸ’¾</span><br><span class="line">Set kubectl context to &quot;kind-kind&quot;</span><br><span class="line">You can now use your cluster with:</span><br><span class="line"></span><br><span class="line">kubectl cluster-info --context kind-kind</span><br><span class="line"></span><br><span class="line">Have a question, bug, or feature request? Let us know! https://kind.sigs.k8s.io/#community ğŸ™‚</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p>æ£€æŸ¥K8sé›†ç¾¤çŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl cluster-info</span><br><span class="line">Kubernetes control plane is running at https://127.0.0.1:51848</span><br><span class="line">CoreDNS is running at https://127.0.0.1:51848/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><br><span class="line"></span><br><span class="line">To further debug and diagnose cluster problems, use &#x27;kubectl cluster-info dump&#x27;.</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>â€</p><p><strong>æ—¢ç„¶å·²ç»æœ‰äº†Dokcerï¼Œä¸ºä»€ä¹ˆéœ€è¦K8sï¼Ÿ</strong></p><p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä½ éœ€è¦åŒæ—¶å¯åŠ¨ 10 ä¸ªä¸åŒçš„å®¹å™¨é•œåƒï¼Œéœ€è¦è¿è¡Œ 10 æ¬¡ docker run å‘½ä»¤ã€‚<br>æ­¤å¤–ï¼Œå¦‚æœå®¹å™¨ä¹‹é—´æœ‰ä¾èµ–é¡ºåºï¼Œè¿˜éœ€è¦é¢å¤–è®°ä½è¿™ 10 æ¡å‘½ä»¤ç‰¹å®šçš„å¯åŠ¨é¡ºåºã€‚</p><p>K8s çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œå®ƒä¸ºæˆ‘ä»¬æŠ½è±¡äº†è¯¸å¦‚â€œå¯åŠ¨ 10 ä¸ªå®¹å™¨é•œåƒâ€è¿™æ ·çš„è¿‡ç¨‹å¼çš„å‘½ä»¤ï¼Œä½ åªéœ€è¦å‘ K8s æè¿°â€œæˆ‘éœ€è¦ 10 ä¸ªå®¹å™¨â€ã€‚10 ä¸ªå®¹å™¨æ˜¯æˆ‘æœŸæœ›çš„<strong>æœ€ç»ˆçŠ¶æ€</strong>ï¼Œæˆ‘ä¸ç®¡æ€ä¹ˆæ‰§è¡Œå‘½ä»¤ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡å‘½ä»¤ç­‰è¿‡ç¨‹ï¼Œæˆ‘æƒ³è¦çš„å°±æ˜¯è¿™ä¸ªç»“æœã€‚</p><p>ç”¨æ¥å‘ K8s æè¿°â€œæœŸæœ›æœ€ç»ˆçŠ¶æ€â€çš„æ–‡ä»¶ï¼Œå°±å«åš <strong>K8s Manifest</strong>ï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºæ¸…å•æ–‡ä»¶ã€‚Manifest å°±å¥½æ¯”é¤å…çš„èœå•ï¼Œä½ åªç®¡ç‚¹èœï¼Œåšèœçš„è¿‡ç¨‹æˆ‘ä¸ç®¡ã€‚</p><p>â€</p><h2 id="éƒ¨ç½²å®¹å™¨é•œåƒ"><a href="#éƒ¨ç½²å®¹å™¨é•œåƒ" class="headerlink" title="éƒ¨ç½²å®¹å™¨é•œåƒ"></a>éƒ¨ç½²å®¹å™¨é•œåƒ</h2><p><strong>é€šè¿‡Kubectlä¸K8sé›†ç¾¤äº¤äº’</strong></p><p>Kubectl æ˜¯ä¸€ä¸ªä¸ K8s é›†ç¾¤äº¤äº’çš„å·¥å…·ï¼Œé€šè¿‡ Kubectlï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°ä»¥ Manifest ä¸ºåª’ä»‹æ“ä½œ K8s é›†ç¾¤çš„å¯¹è±¡ã€‚å°±åƒæ“ä½œæ•°æ®åº“ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ Manifest æ‰€æè¿°çš„å¯¹è±¡è¿›è¡Œåˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥æ‰¾ç­‰æ“ä½œ</p><p>â€</p><p><strong>ç¼–å†™Manifestï¼Œå°†å®¹å™¨é•œåƒéƒ¨ç½²åˆ°K8sé›†ç¾¤</strong></p><p>å°†ä¸‹é¢çš„å†…å®¹ä¿å­˜ä¸º flask-pod.yamlï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: hello-world-flask</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">    - name: flask</span><br><span class="line">      image: kalosora/hello-docker-flask</span><br><span class="line">      ports:</span><br><span class="line">        - containerPort: 5000</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Manifestå…³é”®å­—è§£é‡Š:</p><ul><li>Kindï¼Œè¡¨ç¤º K8s çš„å·¥ä½œè´Ÿè½½ç±»å‹ã€‚åœ¨ K8s ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½åƒ Docker ä¸€æ ·ç›´æ¥è¿è¡Œä¸€ä¸ªå®¹å™¨é•œåƒï¼Œé•œåƒéœ€è¦ä¾èµ–äº K8s æ›´ä¸Šå±‚çš„å°è£…æ–¹å¼è¿è¡Œï¼Œè¿™ç§å°è£…æ–¹å¼ä¹Ÿå°±æ˜¯å·¥ä½œè´Ÿè½½ï¼ŒPod æ˜¯å·¥ä½œè´Ÿè½½çš„ä¸€ç§ç±»å‹ã€‚<strong>åœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç›´æ¥åˆ›å»º Pod ç±»å‹çš„å·¥ä½œè´Ÿè½½ã€‚Podæ˜¯K8sè°ƒåº¦çš„æœ€å°å•ä½ã€‚</strong></li><li>Containersï¼Œè¡¨ç¤º Pod è¦è¿è¡Œçš„å®¹å™¨é…ç½®ï¼Œä¾‹å¦‚åç§°ã€é•œåƒå’Œç«¯å£ç­‰ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ª Pod é‡Œé¢é…ç½®å¤šä¸ªå®¹å™¨</li><li>Imageï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„å®¹å™¨é•œåƒ</li><li>Portsï¼Œè¡¨ç¤ºå®¹å™¨è¦æš´éœ²çš„ç«¯å£ï¼Œç›¸å½“äº docker run çš„ p å‚æ•°</li></ul><p>â€</p><p>æ‰§è¡Œkubectl applyåº”ç”¨è¿™æ®µManifest:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl apply -f flask-pod.yaml</span><br><span class="line">pod/hello-world-flask created</span><br><span class="line">yihui.li@yihuilideMBP k8sdemo %</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆåŠŸçœ‹åˆ°è¾“å‡ºå†…å®¹ pod&#x2F;hello-world-flask createdï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»æŠŠè¿™æ®µ Manifest æäº¤åˆ°é›†ç¾¤é‡Œäº†ã€‚å‚æ•° -f è¡¨ç¤ºâ€œæŒ‡å®šä¸€ä¸ª Manifest æ–‡ä»¶â€ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æƒ³è¦å‘ K8s æäº¤ Manifest çš„æ—¶å€™ï¼Œåªéœ€è¦è®°ä½ä¸€æ¡å‘½ä»¤ï¼Œé‚£å°±æ˜¯ kubectl applyã€‚</p><p>â€</p><h2 id="æŸ¥çœ‹å’Œè®¿é—®Pod"><a href="#æŸ¥çœ‹å’Œè®¿é—®Pod" class="headerlink" title="æŸ¥çœ‹å’Œè®¿é—®Pod"></a>æŸ¥çœ‹å’Œè®¿é—®Pod</h2><p>è¦æŸ¥çœ‹ K8s é›†ç¾¤æ­£åœ¨è¿è¡Œä¸­çš„ Podï¼Œå¯ä»¥ä½¿ç”¨ kubectl get pods ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl get pods</span><br><span class="line">NAME                READY   STATUS    RESTARTS   AGE</span><br><span class="line">hello-world-flask   1/1     Running   0          15m</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><p>è¦åœ¨æœ¬åœ°è®¿é—®é›†ç¾¤å†…çš„ Podï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ kubectl port-forward å‘½ä»¤è¿›è¡Œç«¯å£è½¬å‘æ“ä½œï¼Œæ‰“é€šå®¹å™¨å’Œæœ¬åœ°ç½‘ç»œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl port-forward pod/hello-world-flask 8000:5000</span><br><span class="line">Forwarding from 127.0.0.1:8000 -&gt; 5000</span><br><span class="line">Forwarding from [::1]:8000 -&gt; 5000</span><br></pre></td></tr></table></figure><p>Manifest é‡Œå®šä¹‰äº† Ports å‚æ•°åœ¨é›†ç¾¤å†…éƒ¨æš´éœ²äº†ç«¯å£ï¼Œ5000çš„ç«¯å£åªèƒ½åœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ã€‚</p><p>æœ¬åœ°å’Œé›†ç¾¤çš„ç½‘ç»œæ˜¯éš”ç¦»çš„ï¼Œå¦‚æœéœ€è¦ä»é›†ç¾¤å¤–éƒ¨è®¿é—®ï¼Œåˆ™éœ€è¦æ˜ å°„åˆ°æœ¬åœ°ç½‘ç»œçš„ç«¯å£ã€‚</p><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® 127.0.0.1:8000</p><p>â€</p><p>ä½¿ç”¨ kubectl exec è¿›å…¥åˆ° Pod å®¹å™¨å†…éƒ¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl exec -it hello-world-flask -- bash</span><br><span class="line">root@hello-world-flask:/app#</span><br></pre></td></tr></table></figure><p>â€</p><p>ä½¿ç”¨ kubectl delete å‘½ä»¤æ¥åˆ é™¤ Podï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yihui.li@yihuilideMBP k8sdemo % kubectl delete pod hello-world-flask</span><br><span class="line">pod &quot;hello-world-flask&quot; deleted</span><br></pre></td></tr></table></figure><p>â€</p><p><strong>ä¸šåŠ¡è¿›ç¨‹ã€å®¹å™¨é•œåƒå’Œå·¥ä½œè´Ÿè½½ä¹‹é—´çš„å…³ç³»</strong></p><p>é€šè¿‡è¿™å¼ å›¾å¯ä»¥çœ‹å‡ºï¼Œæœ€å†…å±‚æ˜¯æˆ‘ä»¬çš„ä¸šåŠ¡åº”ç”¨è¿›ç¨‹ï¼Œå¤–å±‚é€šè¿‡ Docker é•œåƒä»¥å®¹å™¨åŒ–çš„å½¢å¼è¿è¡Œï¼Œå†å¾€å¤–æ˜¯ K8s çš„æœ€å°è°ƒåº¦å•ä½ Podã€‚</p><p>â€‹<img src="/2025/03/15/%E9%83%A8%E7%BD%B2%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%88%B0K8s/image-20250315220015-tr78a9d.png" alt="image">â€‹</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€â€â€&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£…Kubernetes&quot;&gt;&lt;a href=&quot;#å®‰è£…Kubernetes&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…Kubernetes&quot;&gt;&lt;/a&gt;å®‰è£…Kubernetes&lt;/h2&gt;&lt;p&gt;é¦–å…ˆå®‰è£…Kubernetes cli </summary>
      
    
    
    
    <category term="Cloud Native" scheme="http://example.com/categories/Cloud-Native/"/>
    
    
    <category term="Docker" scheme="http://example.com/tags/Docker/"/>
    
    <category term="Kubernetes" scheme="http://example.com/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>Docker åŸºç¡€</title>
    <link href="http://example.com/2025/03/04/Docker%E5%9F%BA%E7%A1%80/"/>
    <id>http://example.com/2025/03/04/Docker%E5%9F%BA%E7%A1%80/</id>
    <published>2025-03-04T01:30:11.000Z</published>
    <updated>2025-03-16T01:30:09.011Z</updated>
    
    <content type="html"><![CDATA[<p>â€â€</p><h2 id="åˆè¯†å®¹å™¨"><a href="#åˆè¯†å®¹å™¨" class="headerlink" title="åˆè¯†å®¹å™¨"></a>åˆè¯†å®¹å™¨</h2><p>é¦–å…ˆåœ¨æœºå™¨ä¸Šå®‰è£…å¥½dockerï¼Œå¹¶ä¸”é€šè¿‡å‘½ä»¤è¡Œç¡®è®¤çŠ¶æ€ã€‚</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304084250-9itzqkc.png" alt="image">â€‹</p><p>å°è¯•ä»å®˜æ–¹é•œåƒä»“åº“æ‹‰å–é•œåƒ</p><p>Docker ä¼šé»˜è®¤ä» docker.io å®˜æ–¹é•œåƒä»“åº“ä¸­æœç´¢ã€‚</p><p>â€‹<code>:latest</code>â€‹æŒ‡çš„æ˜¯è·å–æœ€æ–°çš„ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šç‰ˆæœ¬å·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker pull lyzhang1999/hello-world-flask:latest</span></span><br></pre></td></tr></table></figure><p>â€</p><p>ä½¿ç”¨å‘½ä»¤åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„é•œåƒ(images)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker images</span></span><br></pre></td></tr></table></figure><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304084713-xfggiuk.png" alt="image">â€‹</p><p>è¿è¡Œé•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d -p 8000:5000 lyzhang1999/hello-world-flask:latest</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>-d ä»£è¡¨â€œåœ¨åå°è¿è¡Œå®¹å™¨â€ï¼ŒåŒæ—¶å®ƒä¼šè¾“å‡ºå®¹å™¨ IDï¼Œè¿™æ˜¯è¿è¡Œå®¹å™¨çš„å”¯ä¸€æ ‡è¯†ã€‚</p><p>-p ä»£è¡¨â€œå°†å®¹å™¨å†…çš„ 5000 ç«¯å£æš´éœ²åˆ°å®¿ä¸»æœºï¼ˆæœ¬åœ°çš„ 8000 ç«¯å£ï¼‰â€ï¼Œè¿™å¯ä»¥æ–¹ä¾¿æˆ‘ä»¬åœ¨æœ¬åœ°è¿›è¡Œè®¿é—®ã€‚</p><p>çœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºè¯´æ˜æˆ‘ä»¬æˆåŠŸå¯åŠ¨äº† hello-world-flask é•œåƒã€‚</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304085847-m0rvxfj.png" alt="image">â€‹</p><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® localhost:8000ï¼Œå¯ä»¥çœ‹åˆ°ï¼š</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304085933-o8zexy8.png" alt="image">â€‹</p><p>â€</p><h2 id="è¿æ¥å®¹å™¨"><a href="#è¿æ¥å®¹å™¨" class="headerlink" title="è¿æ¥å®¹å™¨"></a>è¿æ¥å®¹å™¨</h2><p>é¦–å…ˆæŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨åˆ—è¡¨ï¼Œæ‰¾åˆ°<code>CONTAINER ID</code>â€‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker ps</span></span><br><span class="line">CONTAINER ID   IMAGE                                  COMMAND                   CREATED         STATUS         PORTS                    NAMES</span><br><span class="line">c3f7297de428   lyzhang1999/hello-world-flask:latest   &quot;python3 -m flask ruâ€¦&quot;   2 minutes ago   Up 2 minutes   0.0.0.0:8000-&gt;5000/tcp   cool_mendel</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œå‘½ä»¤è¿›å…¥å®¹å™¨å†…éƒ¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker <span class="built_in">exec</span> -it c3f7297de428 bash</span></span><br></pre></td></tr></table></figure><p>-it çš„å«ä¹‰æ˜¯â€œä¿æŒ STDIN æ‰“å¼€çŠ¶æ€ï¼Œå¹¶ä¸”åˆ†é…ä¸€ä¸ªè™šæ‹Ÿçš„ç»ˆç«¯ï¼ˆTerminalï¼‰â€ã€‚å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œæˆ‘ä»¬é€šè¿‡ SSH ç™»å½•åˆ°äº†å®¹å™¨å†…éƒ¨ï¼Œåœ¨å½“å‰ç»ˆç«¯ä¸‹è¿è¡Œçš„æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯åŸºäºå®¹å™¨å†…çš„</p><p>è¿”å›çš„ç»“æœå¦‚ä¸‹</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304090320-u1xget2.png" alt="image">â€‹</p><p>å°è¯•ç¼–è¾‘å®¹å™¨å†…éƒ¨çš„æ–‡ä»¶<code>app.py</code>â€‹ï¼Œä¿å­˜å¹¶é€€å‡º</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304090438-v3utilc.png" alt="image">â€‹</p><p>å†æ¬¡è®¿é—® <a href="http://localhost:8000/">http://localhost:8000</a> å¯ä»¥çœ‹åˆ°é¡µé¢å·²ç»å‘ç”Ÿäº†å˜åŒ–</p><p>è¾“å…¥<code>exit</code>â€‹é€€å‡ºå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@c3f7297de428:/app# exit</span><br></pre></td></tr></table></figure><p>â€</p><p>æœ€åå¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤åœæ­¢å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker stop [å®¹å™¨<span class="built_in">id</span>]</span></span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304090815-631tc5h.png" alt="image">â€‹</p><p>â€</p><p><strong>å…³äºå®¹å™¨å’Œé•œåƒ</strong></p><p>é€šä¿—åœ°è¯´ï¼Œé•œåƒæ˜¯ä¸€ä¸ªåŒæ—¶åŒ…å«ä¸šåŠ¡åº”ç”¨å’Œè¿è¡Œç¯å¢ƒçš„â€œç³»ç»Ÿå®‰è£…åŒ…â€ï¼Œå®ƒéœ€è¦è¿è¡Œèµ·æ¥ä¹‹åæ‰èƒ½æä¾›æœåŠ¡ï¼Œè¿è¡Œåé•œåƒçš„â€œå®ä¾‹åŒ–â€ç§°ä¸ºå®¹å™¨ï¼ˆContainerï¼‰ã€‚ä½ å¯ä»¥å¯¹åŒä¸€ä¸ªé•œåƒå®ä¾‹åŒ–å¤šæ¬¡ï¼Œäº§ç”Ÿå¤šä¸ªç‹¬ç«‹çš„å®¹å™¨ï¼Œè¿™äº›å®¹å™¨æ‹¥æœ‰ä¸åŒçš„å®¹å™¨ IDï¼Œä¸åŒçš„å®¹å™¨ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚</p><p>è¿›ä¸€æ­¥ç†è§£ï¼Œä½ å¯ä»¥æŠŠå®¹å™¨æ¯”å–»ä¸ºè™šæ‹Ÿæœºï¼Œè™šæ‹Ÿæœºä¹Ÿæ˜¯ï¼Œå½¼æ­¤ä¹‹é—´çš„æ•°æ®å’ŒçŠ¶æ€éƒ½æ˜¯éš”ç¦»çš„ã€‚</p><p>â€</p><h2 id="æ„å»ºé•œåƒ"><a href="#æ„å»ºé•œåƒ" class="headerlink" title="æ„å»ºé•œåƒ"></a>æ„å»ºé•œåƒ</h2><p>ä½¿ç”¨ Python ç¼–å†™çš„ Flask Web åº”ç”¨ä½œä¸ºä¾‹å­</p><p>å¤åˆ¶ä»¥ä¸‹ä»£ç ï¼Œå¹¶ä¿å­˜ä¸º<code>app.py</code>â€‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, my first docker images! &#x27;</span> + os.getenv(<span class="string">&quot;HOSTNAME&quot;</span>) + <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„å«ä¹‰éå¸¸ç®€å•ï¼Œå¯åŠ¨ä¸€ä¸ª Web æœåŠ¡å™¨ï¼Œå½“æ¥æ”¶åˆ° HTTP è¯·æ±‚æ—¶ï¼Œè¿”å› â€œHello, my first docker images!â€ ä»¥åŠ HOSTNAME ç¯å¢ƒå˜é‡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œåˆ›å»º Python çš„ä¾èµ–æ–‡ä»¶ requirements.txt ï¼Œç”¨å®ƒæ¥å®‰è£…ä¾èµ–çš„ Flask æ¡†æ¶ã€‚ä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥åˆ›å»º requirements.txt æ–‡ä»¶å¹¶å°† Flask&#x3D;&#x3D;2.2.2 å†…å®¹å†™å…¥è¯¥æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;Flask==2.3.3&quot;</span> &gt;&gt; requirements.txt</span></span><br></pre></td></tr></table></figure><p>æœ‰äº†è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥åœ¨æœ¬åœ°å¯åŠ¨è¿™ä¸ª Python Web åº”ç”¨äº†ã€‚</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304091801-u43j8m8.png" alt="image">â€‹</p><p><strong>æ¥ä¸‹æ¥ï¼Œå°†è¿™æ®µæœ€ç®€å•çš„ Python ä¸šåŠ¡ä»£ç åˆ¶ä½œæˆé•œåƒã€‚</strong></p><p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–‡ä»¶æ¥æè¿°é•œåƒæ˜¯å¦‚ä½•è¢«æ„å»ºçš„ï¼Œè¿™ä¸ªæ–‡ä»¶å«åš <code>Dockerfile</code>â€‹ã€‚</p><p>å°†ä»¥ä¸‹å†…å®¹ä¿å­˜ä¸º Dockerfile æ–‡ä»¶ã€‚</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax=docker/dockerfile:1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.8</span>-slim-buster</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y procps vim apache2-utils &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt requirements.txt</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip3 install -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;python3&quot;</span>, <span class="string">&quot;-m&quot;</span> , <span class="string">&quot;flask&quot;</span>, <span class="string">&quot;run&quot;</span>, <span class="string">&quot;--host=0.0.0.0&quot;</span>]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹ Dockerfile æ–‡ä»¶é‡Œçš„è¿™å‡ ä¸ªå‘½ä»¤</p><p>ç¬¬ä¸€è¡Œä»¥ syntax å¼€å¤´çš„æ˜¯è§£æå™¨æ³¨é‡Šï¼Œå®ƒä¸ Docker æ„å»ºé•œåƒçš„å·¥å…· buildkit ç›¸å…³ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µï¼Œå»ºè®®ä½¿ç”¨ docker&#x2F;dockerfile:1ï¼Œå®ƒä»£è¡¨å§‹ç»ˆæŒ‡å‘æœ€æ–°çš„è¯­æ³•ç‰ˆæœ¬ã€‚</p><p>FROM å‘½ä»¤ï¼Œè¡¨ç¤ºä½¿ç”¨å®˜æ–¹ä»“åº“çš„ python:3.8-slim-buster é•œåƒä½œä¸ºåŸºç¡€é•œåƒã€‚åœ¨æˆ‘ä»¬ç†Ÿæ‚‰çš„ç¼–ç¨‹æ–¹æ³•ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºä»è¯¥é•œåƒç»§æ‰¿ã€‚è¿™ä¸ªé•œåƒå·²ç»å®‰è£…äº† Python3 å’Œ Pip3 ç­‰æ‰€æœ‰çš„ Python ç›¸å…³çš„å·¥å…·å’ŒåŒ…ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><p>RUN çš„å«ä¹‰æ˜¯åœ¨é•œåƒå†…è¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ºé•œåƒå®‰è£…äº†ä¸€äº›å¿…è¦çš„å·¥å…·ã€‚ WORKDIR çš„å«ä¹‰æ˜¯é•œåƒçš„å·¥ä½œç›®å½•ï¼Œä½ å¯ä»¥ç†è§£ä¸ºåç»­æ‰€æœ‰çš„å‘½ä»¤éƒ½å°†ä»¥æ­¤ä¸ºåŸºå‡†è·¯å¾„ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åç»­çš„å‘½ä»¤ä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„è€Œä¸æ˜¯å®Œæ•´è·¯å¾„äº†ã€‚</p><p>COPY çš„å«ä¹‰æ˜¯å°†æœ¬åœ°çš„æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°é•œåƒå†…æŒ‡å®šçš„ä½ç½®ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨æœ¬åœ°æ–‡ä»¶æˆ–ç›®å½•ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨è¦å¤åˆ¶åˆ°é•œåƒå†…çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸ƒè¡Œ COPY è¡¨ç¤ºï¼Œå°†æœ¬åœ°å½“å‰ç›®å½•ä¸‹çš„ requirements.txt æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒå·¥ä½œç›®å½• &#x2F;app ä¸­ï¼Œæ–‡ä»¶å‘½ååŒæ ·ä¸º requirements.txtã€‚ ç¬¬åè¡Œ RUN çš„å«ä¹‰æ˜¯åœ¨é•œåƒé‡Œè¿è¡Œ pip3 å®‰è£… Python ä¾èµ–ã€‚<strong>è¯·æ³¨æ„ï¼Œè¿™äº›ä¾èµ–å°†ä¼šè¢«å®‰è£…åœ¨é•œåƒé‡Œè€Œä¸æ˜¯æœ¬åœ°</strong>ã€‚ æ¥ä¸‹æ¥ï¼Œç¬¬åè¡Œåˆå‡ºç°äº†ä¸€ä¸ª COPY å‘½ä»¤ï¼Œå®ƒçš„å«ä¹‰æ˜¯å°†å½“å‰ç›®å½•æ‰€æœ‰çš„æºä»£ç å¤åˆ¶åˆ°é•œåƒçš„å·¥ä½œç›®å½• &#x2F;app ä¸‹ï¼Œå¤åˆ¶ç›®å½•çš„è¯­æ³•å’Œæˆ‘ä»¬ä¹‹å‰æåˆ°çš„å¤åˆ¶æ–‡ä»¶æ˜¯ç±»ä¼¼çš„ã€‚ æœ€åä¸€è¡Œ CMD çš„å«ä¹‰æ˜¯é•œåƒçš„å¯åŠ¨å‘½ä»¤ã€‚åœ¨ä¸€ä¸ª Dockerfile ä¸­ï¼Œåªèƒ½æœ‰ä¸€ä¸ª CMD å‘½ä»¤ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œé‚£ä¹ˆåªæœ‰æœ€åä¸€ä¸ª CMD å‘½ä»¤ä¼šèµ·ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨é•œåƒè¢«è¿è¡Œæ—¶å¯åŠ¨ Python Flask Web æœåŠ¡å™¨ï¼Œå¹¶ç›‘å¬åœ¨ç‰¹å®šä¸»æœºä¸Šã€‚CMD çš„ç¬¬ä¸€ä¸ªå‚æ•° python3 æ˜¯æˆ‘ä»¬å¸Œæœ›è¿è¡Œçš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œåé¢çš„å‚æ•°è¡¨ç¤ºè¿è¡Œ python3 å‘½ä»¤æ‰€éœ€è¦çš„å‚æ•°ã€‚</p><p>â€</p><p><strong>å‡†å¤‡æ„å»ºç¬¬ä¸€ä¸ªé•œåƒ</strong></p><p>ç¡®ä¿å½“å‰ç›®å½•ä¸‹æœ‰æ‰€éœ€çš„æ–‡ä»¶</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250304092657-capxx14.png" alt="image">â€‹</p><p>åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker build -t hello-docker-flask .</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>-t ä»£è¡¨çš„æ˜¯é•œåƒåã€‚è¿™é‡Œéšå«äº†é•œåƒç‰ˆæœ¬ï¼ŒDocker ä¼šé»˜è®¤ç”¨ latest ä½œä¸ºç‰ˆæœ¬å·ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œhello-docker-flask ä¸ hello-docker-flask:latest çš„å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„æœ€åé¢æœ‰ä¸€ä¸ª â€œ.â€ ï¼Œè¿™ä»£è¡¨äº†æ„å»ºé•œåƒçš„ä¸Šä¸‹æ–‡ã€‚</p><p>æ‰§è¡Œè¿™æ¡å‘½ä»¤æ—¶ï¼ŒDocker ä¼šå¸®æˆ‘ä»¬ä»å®˜æ–¹é•œåƒä»“åº“æ‹‰å– python:3.8-slim-buster é•œåƒï¼Œå¹¶å¯åŠ¨è¯¥é•œåƒã€‚æ¥ä¸‹æ¥ï¼Œè¯¥å®¹å™¨ä¼šä¾æ¬¡æ‰§è¡Œæˆ‘ä»¬åœ¨ Dockerfile ä¸­ä¹¦å†™çš„å‘½ä»¤ï¼Œä¾‹å¦‚ WORKDIRã€COPYã€RUN ç­‰ç­‰ã€‚</p><p>â€</p><p>å¦‚æœé‡åˆ°<code>fail to authorize</code>â€‹çš„å¼‚å¸¸ï¼Œéœ€è¦æŒ‡å®šç”¨æˆ·å’Œå¯†ç ï¼Œå¹¶é‡å¯docker</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250315113825-v1oo3f5.png" alt="image">â€‹</p><p>â€</p><p>æŸ¥çœ‹æœ¬åœ°é•œåƒï¼Œå¹¶è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker images</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d -p 8000:5000 hello-docker-flask:latest</span></span><br></pre></td></tr></table></figure><p>â€</p><p>ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs [å®¹å™¨ID]</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯ä»¥çœ‹åˆ°å®¹å™¨å¯åŠ¨æ­£å¸¸</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250315121305-jpt6qcg.png" alt="image">â€‹</p><p>â€</p><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® localhost:8000ï¼Œå¯ä»¥çœ‹åˆ°æ­£å¸¸è¾“å‡º</p><p>â€</p><h2 id="å…±äº«é•œåƒ"><a href="#å…±äº«é•œåƒ" class="headerlink" title="å…±äº«é•œåƒ"></a>å…±äº«é•œåƒ</h2><p>ä¸ºäº†èƒ½å¤Ÿåœ¨å›¢é˜Ÿä¸­å…±äº«é•œåƒï¼Œéœ€è¦å…ˆæ³¨å†Œä¸€ä¸ª <a href="https://hub.docker.com/" title="Docker HUB">Docker HUB</a> çš„è´¦å·ï¼Œå¹¶ä¸”ä½¿ç”¨ docker login ç™»å½•ï¼Œè¿™å’Œæˆ‘ä»¬ä½¿ç”¨çš„ Git å·¥å…·ç±»ä¼¼ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ docke tag é‡å‘½åæˆ‘ä»¬ä¹‹å‰åœ¨æœ¬åœ°æ„å»ºçš„é•œåƒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker tag hello-world-flask my_dockerhub_name/hello-world-flask</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æŠŠ <code>my_dockerhub_name</code>â€‹ æ›¿æ¢ä¸ºä½ å®é™…çš„ Docker Hub è´¦æˆ·åï¼Œä¹Ÿç§°ä¸ºé•œåƒä»“åº“çš„åå­—</p><p>â€</p><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ docker push æŠŠæœ¬åœ°çš„é•œåƒä¸Šä¼ åˆ° Docker Hub äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker push my_dockerhub_name/hello-world-flask</span></span><br></pre></td></tr></table></figure><p>â€</p><p>æˆåŠŸä¸Šä¼ åï¼Œå…¶ä»–äººå¯ä»¥é€šè¿‡ docker pull å‘½ä»¤æ¥æ‹‰å–æˆ‘ä»¬ä¸Šä¼ çš„é•œåƒã€‚</p><p>â€</p><p>ä¾‹å¦‚</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250315121923-kdut6zn.png" alt="image">â€‹</p><p>â€‹<img src="/2025/03/04/Docker%E5%9F%BA%E7%A1%80/image-20250315121934-5u3db8s.png" alt="image">â€‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€â€&lt;/p&gt;
&lt;h2 id=&quot;åˆè¯†å®¹å™¨&quot;&gt;&lt;a href=&quot;#åˆè¯†å®¹å™¨&quot; class=&quot;headerlink&quot; title=&quot;åˆè¯†å®¹å™¨&quot;&gt;&lt;/a&gt;åˆè¯†å®¹å™¨&lt;/h2&gt;&lt;p&gt;é¦–å…ˆåœ¨æœºå™¨ä¸Šå®‰è£…å¥½dockerï¼Œå¹¶ä¸”é€šè¿‡å‘½ä»¤è¡Œç¡®è®¤çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;â€‹&lt;img src=&quot;/2025</summary>
      
    
    
    
    <category term="Cloud Native" scheme="http://example.com/categories/Cloud-Native/"/>
    
    
    <category term="Docker" scheme="http://example.com/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨GPTæé«˜ç ”å‘æ•ˆç‡</title>
    <link href="http://example.com/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/"/>
    <id>http://example.com/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/</id>
    <published>2025-02-23T02:45:11.000Z</published>
    <updated>2025-02-23T02:45:16.985Z</updated>
    
    <content type="html"><![CDATA[<p>â€â€</p><p>â€</p><p>ç›¸åŒç³»åˆ—çš„æ–‡ç« </p><p><a href="https://kalosora.github.io/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/">æ­å»ºHelloGPT</a></p><p><a href="https://kalosora.github.io/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/">æ”¹è¿›ä¸ºå¤šæ€æ¨¡GPT</a></p><p>â€</p><h2 id="ä½¿ç”¨LLMè¾…åŠ©è®¾è®¡"><a href="#ä½¿ç”¨LLMè¾…åŠ©è®¾è®¡" class="headerlink" title="ä½¿ç”¨LLMè¾…åŠ©è®¾è®¡"></a>ä½¿ç”¨LLMè¾…åŠ©è®¾è®¡</h2><p>å¯ä»¥è®©GPTç”Ÿæˆå¤šæ¬¡ä¸åŒçš„è®¾è®¡ï¼Œæœ€åç»“åˆè‡ªå·±çš„æ€è€ƒã€‚</p><p>å¯ä»¥å¤§å¤§æé«˜ç ”å‘äººå‘˜åœ¨é¢å¯¹é™Œç”Ÿé¢†åŸŸæ—¶çš„ç ”å‘æ•ˆç‡ã€‚</p><p>ä¹Ÿå¯ä»¥è®©GPTå¸®åŠ©ä»£ç ç”Ÿæˆ</p><ul><li>æ ¹æ®æ³¨é‡Šã€è¦æ±‚ç›´æ¥ç”Ÿæˆä»£ç </li><li>æ ¹æ®ä»£ç ç”Ÿæˆæµ‹è¯•ï¼ˆç›®å‰æœ€å‡†ç¡®ï¼Œå› ä¸ºä¸Šä¸‹æ–‡åªæœ‰ä»£ç ï¼Œæ²¡æœ‰ä¸šåŠ¡éœ€æ±‚ï¼‰</li><li>æ ¹æ®ä»£ç ç”Ÿæˆæ³¨é‡Š</li><li>åœ¨ä¸åŒç¼–ç¨‹è¯­è¨€ä¹‹é—´ç¿»è¯‘</li><li>è§£é‡Šä»£ç çš„è¿ä½œæ–¹å¼</li><li>ä¿®æ”¹ä»£ç ä¸­çš„bug</li><li>å…¶ä»–</li></ul><p>â€</p><p>å¯ä»¥ä½¿ç”¨ReActæ¨¡å¼ï¼šGPTä»£ç ç”Ÿæˆ -&gt; GPTè‡ªæµ‹ -&gt; GPTbugè‡ªåŠ¨ä¿®æ”¹ ï¼ˆè¿­ä»£ * Nï¼‰-&gt; æœ€ç»ˆä»£ç </p><p>éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶</p><ul><li>ReActè¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•</li><li>æ–¹æ³•çš„è¾“å…¥ç®€å•ï¼ˆç®€å•å­—ç¬¦&#x2F;JSONï¼‰</li><li>æ–¹æ³•çš„è¾“å‡ºæ˜¯å¤§æ¨¡å‹å¯ç†è§£ï¼ˆä¸èƒ½åªè¿”å›Error codeï¼Œç»™å‡ºä¸€ä¸ªè¯¦ç»†çš„è‡ªç„¶è¯­è¨€æè¿°ï¼‰</li></ul><p>â€</p><blockquote><p>æºç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_llm_assist_design.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_llm_assist_design.ipynb</a></p></blockquote><p>â€</p><h2 id="æé«˜ä»£ç ç”Ÿæˆçš„å¯ç”¨æ€§"><a href="#æé«˜ä»£ç ç”Ÿæˆçš„å¯ç”¨æ€§" class="headerlink" title="æé«˜ä»£ç ç”Ÿæˆçš„å¯ç”¨æ€§"></a>æé«˜ä»£ç ç”Ÿæˆçš„å¯ç”¨æ€§</h2><p>ä½¿ç”¨ReAct pattern</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222165312-868qflu.png" alt="image">â€‹</p><p>â€</p><p>è§£å†³é—ç•™ä»£ç ä¾èµ–</p><p>å¤–éƒ¨æ¨ç†ï¼šç¼–å†™ASTæ ‘éå†æ‰€æœ‰çš„ä¾èµ–ï¼Œæ•´åˆåˆ°Prompté‡Œä¼ ç»™å¤§æ¨¡å‹</p><p>å¤§æ¨¡å‹æ¨ç†ï¼šå¤§æ¨¡å‹åŸºäºReActæ¨¡å¼è‡ªå·±å¯»æ‰¾æµ‹è¯•ä¾èµ–</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222170014-8tbzyj0.png" alt="image">â€‹</p><p>â€</p><p>æ–¹æ¡ˆæ¯”è¾ƒ</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222170655-s3vbpcu.png" alt="image">â€‹</p><p>â€</p><blockquote><p>æºç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_code_generation_example.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_code_generation_example.ipynb</a></p></blockquote><p>â€</p><h2 id="ç¼–å†™å¤§æ¨¡å‹å‹å¥½ä»£ç "><a href="#ç¼–å†™å¤§æ¨¡å‹å‹å¥½ä»£ç " class="headerlink" title="ç¼–å†™å¤§æ¨¡å‹å‹å¥½ä»£ç "></a>ç¼–å†™å¤§æ¨¡å‹å‹å¥½ä»£ç </h2><p>é€‚åˆå¤§æ¨¡å‹ç”Ÿæˆä»£ç çš„åœºæ™¯ï¼š</p><ul><li><p>åŠŸèƒ½æ˜ç¡®ï¼Œå®šä¹‰æ¸…æ¥š</p><ul><li>é€šè¿‡è§„æ¨¡è¾ƒå°çš„æ¥å£&#x2F;æ–¹æ³•ç­¾åæ¥æ¸…æ™°å®šä¹‰</li><li>æ¸…æ™°çš„æ³¨é‡Š&#x2F;Promptçš„å®šä¹‰å®ç°é€»è¾‘</li></ul></li><li><p>é€šç”¨åŠŸèƒ½</p></li><li><p>ä¾èµ–ç®€å•</p><ul><li>å°¤å…¶æ˜¯å¯¹è‡ªèº«é—ç•™ä»£ç çš„ä¾èµ–</li></ul></li></ul><p>â€</p><h2 id="å¤§æ¨¡å‹è¾…åŠ©è¿ç»´å’Œéƒ¨ç½²"><a href="#å¤§æ¨¡å‹è¾…åŠ©è¿ç»´å’Œéƒ¨ç½²" class="headerlink" title="å¤§æ¨¡å‹è¾…åŠ©è¿ç»´å’Œéƒ¨ç½²"></a>å¤§æ¨¡å‹è¾…åŠ©è¿ç»´å’Œéƒ¨ç½²</h2><p>åˆ©ç”¨å¤§æ¨¡å‹å¸®åŠ©Devopsæé«˜æ•ˆç‡ï¼Œèµ‹èƒ½äº‘åŸç”Ÿå®è·µ</p><p>â€</p><p>ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿï¼Ÿ</p><p>è®¡ç®—èµ„æºå¼¹æ€§ä¼¸ç¼©ï¼šéœ€è¦çš„æ—¶å€™å¿«é€Ÿçš„è·å¾—è®¡ç®—èµ„æºï¼ˆå‡ åç§’è‡³å‡ åˆ†é’Ÿï¼‰ï¼Œä¸éœ€è¦çš„æ—¶å€™æŠŠè®¡ç®—èµ„æºé‡Šæ”¾æ‰ã€‚è®¡ç®—èµ„æºå…è®¸æ¨ªå‘æ‹“å±•ï¼ˆå¢åŠ é›†ç¾¤ï¼‰å’Œçºµå‘æ‹“å±•ï¼ˆåŠ å¼ºæœºå™¨é…ç½®ï¼‰</p><p>å•ç‰©ç†æœºï¼ˆå¤§å‹æœºï¼‰ vs äº‘åŸç”Ÿ</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222203049-jioftgx.png" alt="image">â€‹</p><p>â€</p><p>äº‘åŸç”Ÿå®è·µä¸­çš„CICD pipeline</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222203353-ht8yzo4.png" alt="image">â€‹</p><p>â€</p><p>Terraformä½œä¸ºIaCå·¥å…·ï¼Œåœ¨äº‘åŸç”Ÿä¸­å‘æŒ¥è‡³å…³é‡è¦çš„ä½œç”¨</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222203619-xj2r1ye.png" alt="image">â€‹</p><p>â€</p><p>å¯ä»¥åˆ©ç”¨å¤§æ¨¡å‹å¸®åŠ©å¼€å‘è€…ç”Ÿæˆterraform templateï¼Œå¼€å‘äººå‘˜åªéœ€è¦ä¿®æ”¹éƒ¨åˆ†å†…å®¹å³å¯å®Œæˆå¼€å‘ã€‚</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222212927-ug7e6ny.png" alt="image">â€‹</p><p>å¯ç”¨ä¸Šä¸‹æ–‡è®°å¿†åŠŸèƒ½ï¼Œè®©GPTæŠŠAWSäº‘è½¬æ¢æˆé˜¿é‡Œäº‘çš„terraformæ ¼å¼</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222213417-vtmq4wm.png" alt="image">â€‹</p><p>â€</p><p>è¿˜å¯ä»¥åˆ©ç”¨å¤§æ¨¡å‹ç”Ÿç¬¦åˆKubernetesæœ€ä½³å®è·µçš„éƒ¨ç½²é…ç½®æ–‡ä»¶</p><p>æœ€ä½³å®è·µçš„è¦æ±‚</p><ul><li>éƒ¨ç½²çš„namespaceä¸ºâ€serviceâ€</li><li>åŒ…å«readinessåŠliveness probe</li><li>é‡‡ç”¨ä¸€ä¸ªç‹¬ç«‹çš„ service account è¿è¡Œ</li><li>åŒ…å«å®Œç¾ç»ˆæ­¢ï¼ˆgraceful terminationï¼‰é…ç½®</li></ul><p><a href="https://learnk8s.io/production-best-practices">K8s best practice</a></p><p>â€</p><blockquote><p>æºç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_cloud_devops_example.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_cloud_devops_example.ipynb</a></p></blockquote><p>â€</p><h2 id="æ¢ç´¢å¼€æºAIç¤¾åŒº"><a href="#æ¢ç´¢å¼€æºAIç¤¾åŒº" class="headerlink" title="æ¢ç´¢å¼€æºAIç¤¾åŒº"></a>æ¢ç´¢å¼€æºAIç¤¾åŒº</h2><p>åˆ©ç”¨Hugging Faceå¼€æºç¤¾åŒºä¸­å¤§é‡çš„å¼€æºæ¨¡å‹ï¼Œæå‡ç ”å‘æ•ˆç‡</p><p><a href="https://huggingface.co/">huggingface</a></p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222214912-demx9p0.png" alt="image">â€‹</p><p>â€</p><p>Open sourceçš„æ¨¡å‹ç»Ÿç§°ä¸º <code>pre-trained</code>â€‹æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒ</p><p>Transformer Pipeline</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222215626-k9qx1ue.png" alt="image">â€‹</p><p>â€</p><p>Hugging Faceçš„æ¨¡å‹å¯ä»¥ç»Ÿä¸€ä½¿ç”¨Transformer Pipelineè°ƒç”¨ã€‚</p><p>å¦‚æœè¦ä½¿ç”¨è¿œç¨‹è°ƒç”¨æ¨¡å‹çš„æ–¹å¼ï¼Œéœ€è¦æ³¨å†Œè´¦å·å¹¶åˆ›å»ºAPI token</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250222221046-uj658fe.png" alt="image">â€‹</p><p>â€</p><p><strong>æ³¨æ„ï¼šHugging Faceéœ€è¦å®‰è£…tensorflow</strong></p><p>Mac intel arm64ä¼šå‡ºç°æ‰¾ä¸åˆ°å®‰è£…åŒ…çš„æƒ…å†µ</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250223100358-l19mdgb.png" alt="image">â€‹</p><p>â€</p><p>è§£å†³æ–¹æ³•ï¼šå®‰è£…Anacondaï¼Œå¹¶åˆ›å»ºæ–°çš„pythonè¿è¡Œç¯å¢ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">conda --version</span><br><span class="line"></span><br><span class="line">conda create -n TFmacOS python=3.9 pip</span><br><span class="line">conda activate TFmacOS </span><br><span class="line">python -m pip install tensorflow-macos==2.9.0</span><br><span class="line">python -m pip install tensorflow-metal</span><br><span class="line"></span><br><span class="line">conda install jupyter</span><br></pre></td></tr></table></figure><p>ä»<code>TFmacOS</code>â€‹ç¯å¢ƒä¸­å¯åŠ¨jupyter notebook</p><p>â€</p><blockquote><p>æºç </p><p>é€šè¿‡Hugging Face + Deepseek API å®ç°çœ‹å›¾è®²æ•…äº‹</p><p>æˆ–</p><p>LangChain + Hugging Face model</p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_hugging_face_example.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_hugging_face_example.ipynb</a></p></blockquote><p>â€</p><h2 id="AIä¼ä¸šæ¶æ„ä¸­çš„æ€è€ƒ"><a href="#AIä¼ä¸šæ¶æ„ä¸­çš„æ€è€ƒ" class="headerlink" title="AIä¼ä¸šæ¶æ„ä¸­çš„æ€è€ƒ"></a>AIä¼ä¸šæ¶æ„ä¸­çš„æ€è€ƒ</h2><p>ä¼ä¸šå†…éƒ¨æ–‡æ¡£å¤„ç†</p><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250223091728-jlaozxf.png" alt="image">â€‹</p><p>â€</p><p>å…¶ä»–å‚è€ƒæ¶æ„</p><ul><li>ä½¿ç”¨<code>prompt validation</code>â€‹é˜²å¾¡æç¤ºè¯æ³¨å…¥è¿›æ”»</li></ul><p>â€‹<img src="/2025/02/23/%E4%BD%BF%E7%94%A8GPT%E6%8F%90%E9%AB%98%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87/image-20250223092857-9zxbsip.png" alt="image">â€‹</p><p>â€</p><p>æœ€åæ€»ç»“ä¸€ä¸‹ä½¿ç”¨åˆ°çš„æ¨¡å‹ç¤¾åŒº</p><p>Hugging Face</p><p>Ollama</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€â€&lt;/p&gt;
&lt;p&gt;â€&lt;/p&gt;
&lt;p&gt;ç›¸åŒç³»åˆ—çš„æ–‡ç« &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://kalosora.github.io/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/&quot;&gt;æ­å»ºHelloGPT&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a hr</summary>
      
    
    
    
    <category term="AI/ML" scheme="http://example.com/categories/AI-ML/"/>
    
    
    <category term="LLM" scheme="http://example.com/tags/LLM/"/>
    
    <category term="DeepSeek" scheme="http://example.com/tags/DeepSeek/"/>
    
  </entry>
  
  <entry>
    <title>è®©GPTä½¿ç”¨å·¥å…·</title>
    <link href="http://example.com/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/"/>
    <id>http://example.com/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/</id>
    <published>2025-02-22T08:24:11.000Z</published>
    <updated>2025-02-22T08:25:46.388Z</updated>
    
    <content type="html"><![CDATA[<p>â€â€</p><p>*ä½¿ç”¨DeepSeek APIæµ‹è¯•</p><h2 id="Function-Calling"><a href="#Function-Calling" class="headerlink" title="Function Calling"></a>Function Calling</h2><p>è®©AIè°ƒç”¨å·²ç»å®šä¹‰å¥½çš„python æ–¹æ³•</p><p>Function Calling è®©æ¨¡å‹èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Œæ¥å¢å¼ºè‡ªèº«èƒ½åŠ›ã€‚</p><ul><li>å°†å¯ä»¥ä½¿ç”¨æ–¹æ³•ï¼ˆå·¥å…·ï¼‰è¯´æ˜ï¼Œéšç”¨æˆ·è¯·æ±‚ä¸€èµ·æ”¾åœ¨Promptä¸­ä¼ ç»™GPT</li><li>GPTè¿”å›è¦è°ƒç”¨çš„æ–¹æ³•åŠå‚æ•°å€¼ï¼Œç„¶ååœ¨å¤–éƒ¨è¿è¡Œè¯¥æ–¹æ³•è·å¾—ç»“æœ</li><li>å°†è°ƒç”¨ç»“æœåŠå‰é¢çš„å¯¹è¯å†å²ä¸€èµ·æ”¾å…¥Promptï¼Œå†æ¬¡è°ƒç”¨GPT</li></ul><p>â€</p><p>ä¾‹å¦‚ï¼š</p><ul><li>æ„å»ºä¸€ä¸ªdictå¯¹è±¡å­˜å‚¨ï¼š{â€œMethod1â€, â€œMethod2â€, â€¦}</li><li>åœ¨Promptä¸­åŠ å…¥æ–¹æ³•å®šä¹‰</li><li>æ ¹æ®LLMçš„è¿”å›ï¼Œå†³å®šæ˜¯å¦è°ƒç”¨å‡½æ•°ï¼ˆè¿”å›ä¿¡æ¯ä¸­å«æœ‰â€Function_callâ€ï¼‰ï¼Œè¿˜æ˜¯ç›´æ¥è¿”å›ä¿¡æ¯ç»™ç”¨æˆ·</li><li>å¦‚éœ€è°ƒç”¨å‡½æ•°ï¼Œåˆ™è°ƒç”¨LLMæŒ‡å®šå‡½æ•°ï¼Œå¹¶å°†ç»“æœåŠè°ƒç”¨çš„å‡½æ•°ä¸€èµ·æ”¾åœ¨Promptä¸­å†æ¬¡è°ƒç”¨LLM</li></ul><p>â€</p><p>OpenAI GPT4oçš„ä¾‹å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> AzureOpenAI</span><br><span class="line">  </span><br><span class="line">client = AzureOpenAI(</span><br><span class="line">    api_key=os.getenv(<span class="string">&quot;OPENAI_API_KEY&quot;</span>),  </span><br><span class="line">    api_version=os.getenv(<span class="string">&quot;OPENAI_API_VERSION&quot;</span>),</span><br><span class="line">    azure_endpoint = os.getenv(<span class="string">&quot;OPENAI_API_BASE&quot;</span>)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">funcs = &#123;<span class="string">&quot;get_current_cluster_state&quot;</span>: get_current_cluster_state&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_current_cluster_state</span>(<span class="params">cluster_name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;cluster:<span class="subst">&#123;cluster_name&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span>  <span class="string">&quot;&quot;&quot;ERROR: Failed to pull image &quot;/docker/dsp:latest&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">    msg=[&#123;<span class="string">&quot;role&quot;</span>:<span class="string">&quot;user&quot;</span>,<span class="string">&quot;content&quot;</span>:<span class="built_in">input</span>&#125;]</span><br><span class="line">    ret = run_conversation(msg)</span><br><span class="line">    <span class="keyword">return</span> ret.content</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_conversation</span>(<span class="params">msg</span>):</span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=deployment,</span><br><span class="line">        messages=msg,</span><br><span class="line">        functions=[</span><br><span class="line">            &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;get_current_cluster_state&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Get the current state in a given cluster&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">                            <span class="string">&quot;cluster_name&quot;</span>: &#123;</span><br><span class="line">                                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">                                <span class="string">&quot;description&quot;</span>: <span class="string">&quot;the name of the cluster&quot;</span>,</span><br><span class="line">                            &#125;,</span><br><span class="line"></span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;cluster_name&quot;</span>],</span><br><span class="line">                    &#125;</span><br><span class="line">          </span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        function_call=<span class="string">&quot;auto&quot;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    response_message = response.choices[<span class="number">0</span>].message</span><br><span class="line">  </span><br><span class="line">    function_call = response_message.function_call</span><br><span class="line">  </span><br><span class="line">    <span class="comment"># å¦‚æœä¸éœ€è¦è°ƒç”¨functionï¼Œåˆ™ç›´æ¥è¿”å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> function_call:</span><br><span class="line">        <span class="keyword">return</span> response_message</span><br><span class="line">    function_name = function_call.name</span><br><span class="line">    function_to_call = funcs[function_name] </span><br><span class="line">    function_args = json.loads(response_message.function_call.arguments)</span><br><span class="line">    function_response = function_to_call(**function_args)            </span><br><span class="line">    msg.append( <span class="comment"># adding assistant response to messages</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: response_message.role,</span><br><span class="line">            <span class="string">&quot;function_call&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: function_name,</span><br><span class="line">                <span class="string">&quot;arguments&quot;</span>: response_message.function_call.arguments,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="literal">None</span></span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    msg.append( <span class="comment"># adding function response to messages</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;function&quot;</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: function_name,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: function_response,</span><br><span class="line">        &#125;</span><br><span class="line">    ) </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> run_conversation(msg)</span><br><span class="line">   </span><br></pre></td></tr></table></figure><p>â€</p><p>åœ¨Promptä¸­åŠ å…¥æ–¹æ³•æè¿°</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250215180507-3yfoplo.png" alt="image">â€‹</p><blockquote><p>DeepSeekç¤ºä¾‹æºä»£ç </p><p>ç›®å‰ä¼šå‡ºç°ç©ºå›å¤çš„bug</p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_function_calling.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_function_calling.ipynb</a></p></blockquote><p>â€</p><h2 id="ä½¿ç”¨LangChain-Agent"><a href="#ä½¿ç”¨LangChain-Agent" class="headerlink" title="ä½¿ç”¨LangChain Agent"></a>ä½¿ç”¨LangChain Agent</h2><p>è®©GPTä»¥æ›´ç®€å•çš„æ–¹å¼ï¼Œå­¦ä¼šä½¿ç”¨å·¥å…·ã€‚</p><p>Agentçš„æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿ç”¨è¯­è¨€æ¨¡å‹æ¥é€‰æ‹©è¦é‡‡å–çš„ä¸€ç³»åˆ—æ“ä½œã€‚</p><p>â€</p><blockquote><p>LangChain å·¥å…·é›†</p><p><a href="https://python.langchain.com/api_reference/">https://python.langchain.com/api_reference/</a></p></blockquote><p>â€</p><p>æµ‹è¯•ä»¥åå¯ä»¥å‘ç°ï¼ŒLangChainä½¿ç”¨å·¥å…·çš„æ–¹æ³•æ›´åŠ æ™ºèƒ½ã€çµæ´»</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250216110005-bxe9e3f.png" alt="image">â€‹</p><h3 id="Wolfram-Alpha-API-Wrapper"><a href="#Wolfram-Alpha-API-Wrapper" class="headerlink" title="Wolfram Alpha API Wrapper"></a>Wolfram Alpha API Wrapper</h3><p>â€‹<code>Wolfram Alpha</code>â€‹æ˜¯ä¸“æ³¨äºè§£å†³ç§‘å­¦è®¡ç®—çš„å·¥å…·ï¼Œå¸®åŠ©AIæ›´å¥½å¾—æ€è€ƒæ•°å­¦é—®é¢˜</p><blockquote><p>å®˜ç½‘</p><p><a href="https://zh.wolframalpha.com/">https://zh.wolframalpha.com</a></p><p>â€</p><p>API ID Ceation</p><p><a href="https://developer.wolframalpha.com/">https://developer.wolframalpha.com</a></p><p>â€</p><p>WolframAlphaAPIWrapper document</p><p><a href="https://python.langchain.com/api_reference/community/utilities/langchain_community.utilities.wolfram_alpha.WolframAlphaAPIWrapper.html">https://python.langchain.com/api_reference/community/utilities/langchain_community.utilities.wolfram_alpha.WolframAlphaAPIWrapper.html</a></p></blockquote><p>â€</p><p>åˆ›å»ºè´¦å·</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250216111208-2qgm45s.png" alt="image">â€‹</p><p>åˆ›å»ºä½ çš„APP ID</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250216111431-fmyfj9j.png" alt="image">â€‹</p><p>å¤åˆ¶<code>App ID</code>â€‹<br><img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250216111655-uxjwrxm.png" alt="image">â€‹</p><blockquote><p>å‚è€ƒæºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_langchain_agent.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_langchain_agent.ipynb</a></p></blockquote><h2 id="In-context-learning"><a href="#In-context-learning" class="headerlink" title="In-context learning"></a>In-context learning</h2><p><strong>Zero-shot Learning</strong></p><p>ä¸€ç§æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œå®ƒå…è®¸æ¨¡å‹åœ¨æ²¡æœ‰è§è¿‡ä»»ä½•è®­ç»ƒæ ·æœ¬çš„æƒ…å†µä¸‹ï¼Œå¯¹æ–°ç±»åˆ«çš„æ•°æ®è¿›è¡Œåˆ†ç±»æˆ–è¯†åˆ«ã€‚</p><p>è¿™ç§æ–¹æ³•é€šå¸¸ä¾èµ–äºæ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å­¦åˆ°çš„çŸ¥è¯†ï¼Œä»¥åŠå¯¹æ–°ç±»åˆ«çš„ä¸€äº›æè¿°æ€§ä¿¡æ¯ï¼Œå¦‚å±æ€§æˆ–åŸæ•°æ®ã€‚</p><p>ä¾‹å¦‚ï¼Œç»™å‡ºä¸€äº›çŒ«çš„ç‰¹å¾ï¼Œç„¶åç»™å‡ºä¸€å †å›¾ç‰‡ï¼Œè®©æœºå™¨è¯†åˆ«å‡ºå…¶ä¸­å“ªäº›å›¾ç‰‡æ˜¯ä¸çŒ«ç›¸å…³çš„ã€‚</p><p>â€</p><p><strong>Few-shot Learning</strong></p><p>æ•™å¯¼æ¨¡å‹ä½¿ç”¨éå¸¸æœ‰é™çš„è®­ç»ƒæ•°æ®æ¥è¯†åˆ«æ–°çš„å¯¹è±¡ã€ç±»æˆ–ä»»åŠ¡ã€‚åœ¨è¿™é‡Œæ˜¯é€šè¿‡Prompté‡ŒåŠ å…¥å°‘é‡ç¤ºä¾‹ï¼Œæ¥å®ç°æ¨¡å‹å­¦ä¹ ã€‚</p><p>â€</p><p>åº”ç”¨å¤§è¯­è¨€æ¨¡å‹è¦ä»ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ€ç»´åˆ‡æ¢ä¸ºä¸Šä¸‹æ–‡å­¦ä¹ æ€è·¯</p><p>ä¸Šä¸‹æ–‡å­¦ä¹ åŒ…æ‹¬Zero-shot Learning å’Œ Few-shot Learningï¼Œä¸¤è€…å¹¶æ— æ˜æ˜¾ç•Œé™ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€è¦çµæ´»è¿ç”¨ã€‚</p><p>â€</p><blockquote><p>æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_in-ontext_learning.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_in-ontext_learning.ipynb</a></p></blockquote><p>â€</p><h2 id="ReActæ¨¡å¼"><a href="#ReActæ¨¡å¼" class="headerlink" title="ReActæ¨¡å¼"></a>ReActæ¨¡å¼</h2><p>å¤§è¯­è¨€æ¨¡å‹å…·æœ‰æ¨ç†èƒ½åŠ›ï¼Œå› ä¸ºå®ƒä»¬é€šè¿‡å­¦ä¹ å¤§é‡çš„æ–‡æœ¬æ•°æ®ï¼Œæ•æ‰è¯­è¨€ä¸­çš„æ¨¡å¼å’Œç»“æ„ã€‚è¿™äº›æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä¼šå­¦ä¹ åˆ°å„ç§çŸ¥è¯†ã€é€»è¾‘å…³ç³»å’Œæ¨ç†æ–¹æ³•ã€‚å½“å®ƒä»¬é‡åˆ°æ–°çš„é—®é¢˜æ—¶ï¼Œå¯ä»¥æ ¹æ®å·²ç»å­¦åˆ°çš„çŸ¥è¯†å’Œæ¨ç†æ–¹æ³•ï¼Œç”Ÿæˆæœ‰æ„ä¹‰çš„å›ç­”ã€‚</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220092417-an4b6d6.png" alt="image">â€‹</p><p>â€</p><p>é€šè¿‡è·å–å½“å‰ç¯å¢ƒä¿¡æ¯ï¼ˆè§‚å¯Ÿï¼‰ï¼Œè¿›ä¸€æ­¥æ€è€ƒï¼Œé‡‡å–è¡ŒåŠ¨</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220092516-ffjujn5.png" alt="image">â€‹</p><p>â€</p><h3 id="LangChain-ReAct-Agent"><a href="#LangChain-ReAct-Agent" class="headerlink" title="LangChain ReAct Agent"></a>LangChain ReAct Agent</h3><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220092544-lca8ao4.png" alt="image">â€‹</p><p>â€</p><p>æ„å»ºGPTï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹èŒƒå¼</p><p><span data-type="text" style="color: var(--b3-font-color6);">Question</span>: the input question you must answer</p><p><span data-type="text" style="color: var(--b3-font-color6);">Thought</span>: you should always think about what to do</p><p><span data-type="text" style="color: var(--b3-font-color6);">Action</span>: the action to take, should be one of [{tool_names}]</p><p><span data-type="text" style="color: var(--b3-font-color6);">Action Input:</span> the input to the action</p><p><span data-type="text" style="color: var(--b3-font-color6);">Observation</span>: the result of thr actionâ€¦ (Though&#x2F;Action&#x2F;Action Input&#x2F;Observation repeat N times)</p><p><span data-type="text" style="color: var(--b3-font-color6);">Thought</span>: Now I know the answer</p><p><span data-type="text" style="color: var(--b3-font-color6);">Final Answer</span>: the answer to the input question</p><p>â€</p><p>AutoGPT - é’ˆå¯¹æŸä¸ªè§£å†³æ–¹æ¡ˆçš„å¾ªç¯è‡ªæ‰§è¡ŒGPT</p><p>å¦‚æœå¯ä»¥ï¼Œé…åˆçŸ­æœŸå’Œé•¿æœŸè®°å¿†ä¿è¯ä¸Šä¸‹æ–‡æ•ˆæœã€‚</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220093712-epgkrva.png" alt="image">â€‹</p><p>Plan: è®¾è®¡å®ç°é¢„æœŸç»“æœçš„è®¡åˆ’ï¼Œå°†å¤æ‚çš„ä»»åŠ¡åˆ†è§£ä¸ºè¾ƒå°çš„æ­¥éª¤ã€‚</p><p>Criticize: è¯„ä¼°è®¡åˆ’çš„å¯è¡Œæ€§å’Œæ•ˆç‡ï¼Œè¯†åˆ«æ½œåœ¨é—®é¢˜å’Œæ”¹è¿›é¢†åŸŸ</p><p>Act: ä½¿ç”¨å…¶å¤šåŠŸèƒ½çš„èƒ½åŠ›æ‰§è¡Œè®¡åˆ’çš„æ“ä½œï¼Œä¾‹å¦‚ç½‘ç»œæœç´¢å’Œæ•°æ®æ£€ç´¢</p><p>Observeï¼šåˆ†æä»Actä¸­ç”Ÿæˆçš„åé¦ˆï¼Œä»ä»¥å‰çš„æ€§èƒ½ä¸­å­¦ä¹ ä»¥æ”¹å–„æœªæ¥çš„ç»“æœ</p><p>Planï¼ˆä¿®æ”¹ï¼‰ï¼šæ ¹æ®åé¦ˆï¼Œä¿®æ”¹åˆå§‹è®¡åˆ’ï¼Œå…è®¸æŒç»­æ”¹è¿›é—®é¢˜è§£å†³ç­–ç•¥</p><p>â€</p><blockquote><p>æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_autogpt_example.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_autogpt_example.ipynb</a></p></blockquote><p>â€</p><h2 id="æ–‡æœ¬åˆ†ç‰‡ä¸å‘é‡åŒ–"><a href="#æ–‡æœ¬åˆ†ç‰‡ä¸å‘é‡åŒ–" class="headerlink" title="æ–‡æœ¬åˆ†ç‰‡ä¸å‘é‡åŒ–"></a>æ–‡æœ¬åˆ†ç‰‡ä¸å‘é‡åŒ–</h2><p>è®©å¤§æ¨¡å‹åº”ç”¨ä¼ä¸šå†…éƒ¨æ•°æ®</p><p>å¤§é‡æ–‡æ¡£å’Œæ•°æ®çš„æŒ‘æˆ˜ï¼šå¦‚æœä½¿ç”¨promptçš„æ–¹å¼æ¥ä¼ é€’æ•°æ®æˆ–ä¸Šä¸‹æ–‡ï¼Œä¼šé¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š</p><ul><li>Promptçš„å†…å®¹å¤§å°é™åˆ¶</li><li>ä½¿ç”¨å¤§é‡æ•°æ®çš„æˆæœ¬</li><li>å¹¶éæ‰€æœ‰æ•°æ®éƒ½ä¼šç”¨äºè§£å†³å½“å‰é—®é¢˜</li></ul><p>â€</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220210925-xq0i4n2.png" alt="image">â€‹</p><p>ä¸€ç§å¯èƒ½çš„å¤„ç†æ–¹å¼<strong>å…³é”®è¯æ£€ç´¢</strong>ï¼šé€šè¿‡Elaticsearchã€Luceneç­‰ç±»ä¼¼æœç´¢å¼•æ“çš„æ–¹å¼ï¼Œæ ¹æ®æ–‡æœ¬å»ºç«‹ç´¢å¼•ï¼Œé€šè¿‡å…³é”®è¯<u>ä¸¥æ ¼åŒ¹é…</u>åˆ°å¯¹åº”çš„æ–‡æœ¬å†…å®¹ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¼šä¸¢å¤±å¾ˆå¤šä¸Šä¸‹æ–‡çš„ä¿¡æ¯ï¼Œä¼šè®©ç›¸åŒè¯­æ„çš„æ–‡æœ¬ä¸¢å¤±ã€‚</p><p>â€</p><p>æ›´å¥½çš„æ–¹æ³•æ˜¯è®©å…³é”®è¯æ£€ç´¢å˜ä¸º<strong>è¯­ä¹‰æ£€ç´¢</strong></p><p>è¯­ä¹‰æ£€ç´¢æ˜¯ä¸€ç§åŸºäºæ–‡æœ¬å†…å®¹å’Œæ„ä¹‰çš„ä¿¡æ¯æ£€ç´¢æ–¹æ³•ï¼Œå®ƒè¯•å›¾ç†è§£æŸ¥è¯¢å’Œæ–‡æ¡£çš„è¯­ä¹‰ï¼Œä»¥ä¾¿æ›´å‡†ç¡®åœ°æ‰¾åˆ°ä¸æŸ¥è¯¢ç›¸å…³çš„æ–‡æ¡£ã€‚</p><p>å‘é‡åŒ–(embedding)æ˜¯å°†æ–‡æœ¬æ•°æ®è½¬ä¸ºæ•°å€¼å‘é‡çš„è¿‡ç¨‹ã€‚å‘é‡åŒ–åçš„æ–‡æœ¬å¯ä»¥ç”¨äºè®¡ç®—æ–‡æœ¬ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå¦‚ä½™å¼¦ç›¸ä¼¼åº¦ã€æ¬§å‡ é‡Œå¾·è·ç¦»ç­‰åº¦é‡ã€‚<strong>è¿™ä½¿å¾—è¯­ä¹‰æ£€ç´¢èƒ½å¤Ÿæ ¹æ®æŸ¥è¯¢å’Œæ–‡æ¡£ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§æ¥å¯¹æ–‡æ¡£è¿›è¡Œæ’åºå’Œæ£€ç´¢ï¼Œä»è€Œæé«˜æ£€ç´¢çš„å‡†ç¡®æ€§å’Œæ•ˆç‡</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠå­—ç¬¦å—è¿›è¡Œå‘é‡åŒ–ï¼Œé€šè¿‡å‘é‡é—´çš„è·ç¦»æ¥æ±‚è§£è¿™äº›å‘é‡ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯­ä¹‰è¶Šç›¸è¿‘çš„å‘é‡ï¼Œå®ƒçš„è·ç¦»å°±è¶ŠçŸ­ã€‚</p><blockquote><p>å‚è€ƒé˜…è¯»</p><p>Word2Vecç›¸å…³çš„ä¸€äº›æœºå™¨å­¦ä¹ çš„ç†è®º</p></blockquote><p>â€</p><p>å®ç°æµç¨‹</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222100753-1kzxpe0.png" alt="image">â€‹</p><p>ä»£ç ç¤ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘é‡åŒ–ç®€å•ç¤ºä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> langchain.embeddings.openai <span class="keyword">import</span> OpenAIEmbeddings</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># embedding = OpenAIEmbeddings() #å¦‚æœç›´æ¥ä½¿ç”¨OpenAIçš„GPTæœåŠ¡</span></span><br><span class="line">embedding = OpenAIEmbeddings(deployment=embedding_deployment) <span class="comment">#deploymentæ˜¯ä½ åœ¨Azureä¸­çš„ embedding æ¨¡å‹çš„éƒ¨ç½²åå­—</span></span><br><span class="line">sentence1 = <span class="string">&quot;æˆ‘æ˜¯ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆ&quot;</span></span><br><span class="line">sentence2 = <span class="string">&quot;å°å¼ ä»äº‹æ³•å¾‹å·¥ä½œ&quot;</span></span><br><span class="line">sentence3 = <span class="string">&quot;æˆ‘æ˜¯ä¸€åç¨‹åºå‘˜&quot;</span></span><br><span class="line"></span><br><span class="line">embedding1 = embedding.embed_query(sentence1)</span><br><span class="line">embedding2 = embedding.embed_query(sentence2)</span><br><span class="line">embedding3 = embedding.embed_query(sentence3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‚¹é›†è®¡ç®—å‘é‡é—´çš„è·ç¦»</span></span><br><span class="line"><span class="built_in">print</span>(np.dot(embedding1,embedding2))</span><br><span class="line"><span class="built_in">print</span>(np.dot(embedding2,embedding3))</span><br><span class="line"><span class="built_in">print</span>(np.dot(embedding1,embedding3))</span><br></pre></td></tr></table></figure><p>â€</p><p>æ–‡æœ¬å‘é‡åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.embeddings.openai <span class="keyword">import</span> OpenAIEmbeddings</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">embed</span>(<span class="params">chunks</span>): </span><br><span class="line">    <span class="comment"># embedding = OpenAIEmbeddings()#å¦‚æœç›´æ¥ä½¿ç”¨OpenAIçš„GPTæœåŠ¡</span></span><br><span class="line">    embedding = OpenAIEmbeddings(deployment=embedding_deployment)</span><br><span class="line">    <span class="keyword">return</span> [embedding.embed_query(chunk) <span class="keyword">for</span> chunk <span class="keyword">in</span> chunks]</span><br><span class="line"></span><br><span class="line">chunks = split_file_into_chunks(<span class="string">&quot;spotmax_intro.txt&quot;</span>,<span class="number">100</span>)</span><br><span class="line">embeddeds = embed(chunks)</span><br></pre></td></tr></table></figure><p>â€</p><p>å‘é‡æ£€ç´¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_k_largest_indices</span>(<span class="params">input_list, k</span>):</span><br><span class="line">    sorted_indices = <span class="built_in">sorted</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(input_list)), key=<span class="keyword">lambda</span> i: input_list[i], reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(input_list)</span><br><span class="line">    <span class="built_in">print</span>(sorted_indices)</span><br><span class="line">    <span class="keyword">return</span> sorted_indices[:k]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">chunks,embeddeds,top_k, txt</span>):</span><br><span class="line">    embedding = OpenAIEmbeddings(deployment=<span class="string">&quot;embedding&quot;</span>,chunk_size=<span class="number">1</span>)</span><br><span class="line">    embedded_txt = embedding.embed_query(txt)</span><br><span class="line">    distances = [np.dot(embedded_txt,embedded) <span class="keyword">for</span> embedded <span class="keyword">in</span> embeddeds]</span><br><span class="line">    ret_idx = find_k_largest_indices(distances, top_k)</span><br><span class="line">    <span class="keyword">return</span> [chunks[i] <span class="keyword">for</span> i <span class="keyword">in</span> ret_idx]</span><br><span class="line"></span><br><span class="line">search(chunks,embeddeds,<span class="number">2</span>, <span class="string">&quot;æé«˜ç³»ç»Ÿå¯ç”¨æ€§&quot;</span>)</span><br></pre></td></tr></table></figure><p>â€</p><p>å‘é‡æ£€ç´¢ + GPT</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">anwser_question_with_doc</span>(<span class="params">question, chunks, embeddeds</span>):</span><br><span class="line">    relevent_chunks = search(chunks,embeddeds,<span class="number">2</span>, question)</span><br><span class="line">    prompt = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä»…é€šè¿‡æ€»ç»“ä»¥ä¸‹çš„æ–‡å­—ç‰‡æ®µå›ç­”ç”¨æˆ·é—®é¢˜, æ³¨æ„ä¿æŒå›ç­”çš„è¯­è¨€é€šé¡ºï¼ˆå­—æ•°åœ¨30å­—ä»¥å†…ï¼‰</span></span><br><span class="line"><span class="string">    --- </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> rchunks <span class="keyword">in</span> relevent_chunks:</span><br><span class="line">        prompt = prompt + <span class="string">&quot;\n&#x27;&quot;</span> + rchunks + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">  </span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">    engine=deployment, <span class="comment"># engine = &quot;deployment_name&quot;.</span></span><br><span class="line">    messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: prompt&#125;,   </span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: question&#125;</span><br><span class="line">        ],</span><br><span class="line">        temperature = <span class="number">0.9</span>, </span><br><span class="line">        max_tokens = <span class="number">200</span></span><br><span class="line">   )</span><br><span class="line">   <span class="keyword">return</span> response.choices[<span class="number">0</span>].message.content</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(anwser_question_with_doc(<span class="string">&quot;å¦‚ä½•æé«˜å¯ç”¨æ€§&quot;</span>, chunks,embeddeds))</span><br></pre></td></tr></table></figure><p>â€</p><p>*ä¹Ÿå¯ä»¥ä½¿ç”¨embeddingæ¨¡å‹è¾…åŠ©å®ç°ï¼Œembedding modelä½¿ç”¨<code>nomic-embed-text</code>â€‹</p><blockquote><p>Ollama embedding model</p><p><a href="https://ollama.com/blog/embedding-models">https://ollama.com/blog/embedding-models</a></p><p>â€</p><p>nomic-embed-text model</p><p><a href="https://ollama.com/library/nomic-embed-text">https://ollama.com/library/nomic-embed-text</a></p></blockquote><p>â€</p><p>é€šè¿‡ollamaå®‰è£…æ¨¡å‹</p><p>å¤åˆ¶å‘½ä»¤</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220213540-anf19y3.png" alt="image">â€‹</p><p>â€</p><p>åœ¨å‘½ä»¤è¡Œå®‰è£…</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220214052-vh76gw4.png" alt="image">â€‹</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250220214331-7pqihxh.png" alt="image">â€‹</p><h3 id="LangChain-Retrieval"><a href="#LangChain-Retrieval" class="headerlink" title="LangChain Retrieval"></a>LangChain Retrieval</h3><p>é€šè¿‡LangChainè¿æ¥å¤§æ¨¡å‹å’Œå†…éƒ¨æ–‡æœ¬</p><p>ä¸Šé¢ä½¿ç”¨äº†chromaå‘é‡æ•°æ®åº“ï¼Œåœ¨è¿™ä¸€èŠ‚é…åˆLangChainä½¿ç”¨å®ç°åˆ†ç‰‡å‘é‡åŒ–çš„æ•´ä¸ªå·¥ä½œæµ</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222100908-g99sack.png" alt="image">â€‹</p><p>LangChain Document LoaderåŠ è½½æ•°æ®</p><p>æ”¯æŒCSVï¼Œæ–‡ä»¶ç›®å½•ï¼ŒHTMLï¼ŒJSONï¼ŒPDFï¼ŒMarkdownç­‰å¤šç§æ ¼å¼</p><p><a href="https://python.langchain.com/docs/integrations/document_loaders/">https://python.langchain.com/docs/integrations/document_loaders/</a></p><p>â€</p><p>LangChain Retrievers</p><p>æ›´å¥½çš„æ–‡æ¡£åˆ†ç‰‡å·¥å…·</p><p><a href="https://python.langchain.com/docs/integrations/document_transformers/">https://python.langchain.com/docs/integrations/retrievers/</a></p><p>â€</p><p>æœ€åæŠŠåˆ†ç‰‡å¥½çš„æ•°æ®embedåˆ°å‘é‡æ•°æ®åº“</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222101728-6nouej4.png" alt="image">â€‹</p><p>LangChainæä¾›äº†<code>RetrievalQA</code>â€‹çš„æ–¹æ³•ç›´æ¥æŸ¥è¯¢å‘é‡æ•°æ®åº“ï¼ˆVectordbï¼‰</p><p>ç”¨æˆ·æé—® -&gt; å‘é‡æ•°æ®åº“æ£€ç´¢ -&gt; æ„æˆæ–°çš„prompt -&gt; å¤§æ¨¡å‹å›ç­”</p><p>â€</p><p>è¿™é‡Œä½¿ç”¨mdæ–‡æ¡£ä¸ºä¾‹</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222114740-ivn5gg8.png" alt="image">â€‹</p><p>â€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">retriever=vectordb.as_retriever(</span><br><span class="line">    search_type=<span class="string">&quot;mmr&quot;</span>, search_kwargs=&#123;<span class="string">&quot;k&quot;</span>: <span class="number">3</span>&#125;</span><br><span class="line">    <span class="comment">#search_type=&quot;similarity&quot;, search_kwargs=&#123;&quot;k&quot;: 3&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>search_typeï¼šæ ¹æ®åœºæ™¯é€‰æ‹©é€‚åˆçš„å‚æ•°</p><ul><li>similarityï¼šæ ¹æ®ç›¸ä¼¼æ€§æŸ¥æ‰¾ï¼Œæœ€å¤šæŸ¥æ‰¾3ä¸ª</li><li>mmrï¼ˆmax marginalï¼‰ï¼šæ‰¾åˆ°ä¸‰ä¸ªæœ€ç›¸ä¼¼çš„ï¼Œç„¶åæ ¹æ®è¿™ä¸‰ä¸ªæ•°æ®åº“ä¹‹é—´å·®åˆ«æœ€å¤§çš„ï¼Œä½†æ˜¯è·Ÿç”¨æˆ·é—®é¢˜åˆæœ‰å…³è”æ€§çš„é—®é¢˜</li></ul><p>â€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">qa = RetrievalQA.from_chain_type(llm=llm, chain_type=<span class="string">&quot;refine&quot;</span>, retriever=retriever,</span><br><span class="line">                                 return_source_documents=<span class="literal">False</span>, verbose=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>chain_type: å¯é€‰å€¼ stuff &#x2F; refine &#x2F; map reduce &#x2F; map re-rank</p><ul><li>è¦æ ¹æ®ä¼ä¸šå†…éƒ¨çš„å®é™…æƒ…å†µå’Œæ•°æ®ç‰¹æ€§ï¼Œå°½å¯èƒ½å¤šåœ°æµ‹è¯•</li><li>é€‚å½“åšä¸€äº›å®šåˆ¶åŒ–çš„æ”¹åŠ¨ä»¥æ»¡è¶³éœ€æ±‚</li></ul><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222103300-hr9bz2x.png" alt="image">â€‹</p><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222103405-zo9pqum.png" alt="image">â€‹</p><p>â€</p><blockquote><p>æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_langchain_retrieval.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_langchain_retrieval.ipynb</a></p><p>å‚è€ƒé˜…è¯»</p><p><a href="https://medium.com/@rahul.dusad/run-rag-pipeline-locally-with-ollama-embedding-model-nomic-embed-text-generate-model-llama3-e7a554a541b3">https://medium.com/@rahul.dusad/run-rag-pipeline-locally-with-ollama-embedding-model-nomic-embed-text-generate-model-llama3-e7a554a541b3</a></p></blockquote><p>â€</p><h2 id="æ„å»ºå¤šæ¨¡æ€Chatbot"><a href="#æ„å»ºå¤šæ¨¡æ€Chatbot" class="headerlink" title="æ„å»ºå¤šæ¨¡æ€Chatbot"></a>æ„å»ºå¤šæ¨¡æ€Chatbot</h2><p>â€‹<img src="/2025/02/22/%E8%AE%A9GPT%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7/image-20250222150709-zlbhx60.png" alt="image">â€‹</p><p>å›¾å½¢ç”Ÿæˆèƒ½åŠ›ï¼šopenaiå¯ä»¥ä½¿ç”¨DALL E2ï¼Œæˆ–è€…æ˜¯Stable Diffusion</p><p>Openai apiç¤ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> http.client</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_image</span>(<span class="params">prompt</span>):</span><br><span class="line">  api_base = os.getenv(<span class="string">&quot;OPENAI_API_BASE&quot;</span>)</span><br><span class="line">  api_key = os.getenv(<span class="string">&quot;OPENAI_API_KEY&quot;</span>)</span><br><span class="line">  api_version = api_version = <span class="string">&#x27;2022-08-03-preview&#x27;</span></span><br><span class="line"></span><br><span class="line">  url = <span class="string">&quot;&#123;&#125;dalle/text-to-image?api-version=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(api_base, api_version)</span><br><span class="line">  headers= &#123; <span class="string">&quot;api-key&quot;</span>: api_key, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span> &#125;</span><br><span class="line">  body = &#123;</span><br><span class="line">      <span class="string">&quot;caption&quot;</span>: prompt,</span><br><span class="line">      <span class="string">&quot;resolution&quot;</span>: <span class="string">&quot;512x512&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  submission = requests.post(url, headers=headers, json=body)</span><br><span class="line">  operation_location = submission.headers[<span class="string">&#x27;Operation-Location&#x27;</span>]</span><br><span class="line">  retry_after = submission.headers[<span class="string">&#x27;Retry-after&#x27;</span>]</span><br><span class="line">  status = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">while</span> (status != <span class="string">&quot;Succeeded&quot;</span>):</span><br><span class="line">      time.sleep(<span class="built_in">int</span>(retry_after))</span><br><span class="line">      response = requests.get(operation_location, headers=headers)</span><br><span class="line">      status = response.json()[<span class="string">&#x27;status&#x27;</span>]</span><br><span class="line">  image_url = response.json()[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;contentUrl&#x27;</span>]</span><br><span class="line">  <span class="comment">#display(Image(url=image_url))</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;\n![image](&quot;</span>+image_url+<span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (create_image(<span class="string">&quot;A dog on the street.&quot;</span>))</span><br></pre></td></tr></table></figure><p>â€</p><blockquote><p>Openai ä»£ç ç¤ºä¾‹</p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_all_in_one_example.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_all_in_one_example.ipynb</a></p></blockquote><p>â€</p><p>â€</p><p>â€</p><p>â€</p><p>â€</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€â€&lt;/p&gt;
&lt;p&gt;*ä½¿ç”¨DeepSeek APIæµ‹è¯•&lt;/p&gt;
&lt;h2 id=&quot;Function-Calling&quot;&gt;&lt;a href=&quot;#Function-Calling&quot; class=&quot;headerlink&quot; title=&quot;Function Calling&quot;&gt;&lt;/a&gt;Fun</summary>
      
    
    
    
    <category term="AI/ML" scheme="http://example.com/categories/AI-ML/"/>
    
    
    <category term="LLM" scheme="http://example.com/tags/LLM/"/>
    
    <category term="DeepSeek" scheme="http://example.com/tags/DeepSeek/"/>
    
  </entry>
  
  <entry>
    <title>æ­å»ºHelloGPT</title>
    <link href="http://example.com/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/"/>
    <id>http://example.com/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/</id>
    <published>2025-02-15T07:49:11.000Z</published>
    <updated>2025-02-15T07:49:26.297Z</updated>
    
    <content type="html"><![CDATA[<p>â€</p><h2 id="é€šè¿‡Azureè®¿é—®GPT"><a href="#é€šè¿‡Azureè®¿é—®GPT" class="headerlink" title="é€šè¿‡Azureè®¿é—®GPT"></a>é€šè¿‡Azureè®¿é—®GPT</h2><p>ä¸­å›½å¤§é™†åœ°åŒºä¸å…è®¸è®¿é—®GPTæœåŠ¡ï¼Œå¯ä»¥é€šè¿‡å¾®è½¯äº‘æ­å»ºGPTæœåŠ¡ã€‚</p><p>*å¾®è½¯äº‘é¦–æ¬¡æ³¨å†Œæœ‰30å¤©å…è´¹ä½“éªŒ</p><p><a href="https://azure.microsoft.com/zh-cn/pricing/purchase-options/azure-account/">https://azure.microsoft.com/zh-cn/pricing/purchase-options/azure-account/</a></p><p>â€</p><p>åˆ›å»ºOpenAIæœåŠ¡</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125200329-jo21jm7.png" alt="image">â€‹</p><p>â€</p><p>é€‰æ‹©éƒ¨ç½²æ¨¡å‹</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125200414-0bcfzdx.png" alt="image">â€‹</p><p>â€</p><p>è·å–ç¯å¢ƒå˜é‡</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125200526-o69r4x2.png" alt="image">â€‹</p><p>è®¾ç½®åˆ°ç³»ç»Ÿé…ç½®æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­import</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125200541-inoh9dd.png" alt="image">â€‹</p><p>â€</p><p>ä»£ç è¯¦è§£</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125200913-vsz9usw.png" alt="image">â€‹</p><ul><li>temperatureï¼šé’ˆå¯¹å›ç­”çš„ç¨³å®šæ€§è®¾ç½®ï¼Œ0ä¸ºæœ€ç¨³å®š</li><li>max_tokenï¼šè®¾ç½®å›ç­”çš„é•¿åº¦</li></ul><p>â€</p><p>Tokenè®¡è´¹è§„åˆ™</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125105549-o7q171o.png" alt="image">â€‹</p><p>â€</p><p>æ¨¡å‹è¯·æ±‚é…é¢</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250125105618-6jmorto.png" alt="image">â€‹</p><h2 id="ä½¿ç”¨DeepSeekAPI"><a href="#ä½¿ç”¨DeepSeekAPI" class="headerlink" title="ä½¿ç”¨DeepSeekAPI"></a><strong>ä½¿ç”¨DeepSeekAPI</strong></h2><p>å¯ä»¥ä½¿ç”¨DeepSeekçš„APIä½œä¸ºä»£æ›¿</p><p><a href="https://platform.deepseek.com/sign_in">deepseek open platform</a></p><p><a href="https://chat.deepseek.com/">deepseek free chat</a></p><p>é¦–æ¬¡æ³¨å†Œå¯ä»¥è·å¾—å…è´¹é¢åº¦</p><p>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250128103053-btd7xa1.png" alt="image">â€‹</p><p>â€</p><p><a href="https://api-docs.deepseek.com/zh-cn/">API document</a></p><blockquote><p>ç¤ºä¾‹æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_api_example.ipynb">https://github.com/KaloSora/HelloGPT/blob/main/code/gpt_api_example.ipynb</a></p></blockquote><p>â€</p><h2 id="æç¤ºè¯å·¥ç¨‹"><a href="#æç¤ºè¯å·¥ç¨‹" class="headerlink" title="æç¤ºè¯å·¥ç¨‹"></a>æç¤ºè¯å·¥ç¨‹</h2><p>å¤§æ¨¡å‹è¿”å›çš„è‡ªç„¶è¯­è¨€æ— æ³•è¢«ç¨‹åºä½¿ç”¨ã€‚</p><p>è®©å¤§æ¨¡å‹ç»“åˆåˆ°ç¨‹åºä¸­ï¼Œè®©ç¨‹åºèƒ½ç†è§£å¤§æ¨¡å‹è¿”å›çš„ç»“æœã€‚</p><h3 id="æç¤ºè¯æŠ€å·§"><a href="#æç¤ºè¯æŠ€å·§" class="headerlink" title="æç¤ºè¯æŠ€å·§"></a>æç¤ºè¯æŠ€å·§</h3><ul><li>åˆ©ç”¨åå‘æç¤ºè¯ï¼ˆå¦‚ï¼šä¸ä½¿ç”¨â€¦â€¦ï¼‰</li><li>è§„èŒƒè¾“å‡ºçš„æ ¼å¼ï¼ˆå¦‚æŒ‡å®šJsonæ ¼å¼ï¼Œä¾¿äºç¨‹åºå¤„ç†ï¼‰</li><li>æ–‡æœ¬è§„èŒƒå¼‚å¸¸è¾“å‡ºçš„æ ¼å¼ï¼ˆå¦‚é‡åˆ°å¼‚å¸¸æ—¶ï¼Œè¿”å›ç®€å•çš„ERRORï¼Œä¾¿äºç¨‹åºå¤„ç†ï¼‰</li><li>ä¸æ–­è¿­ä»£æç¤ºè¯</li><li>æç¤ºè¯å°½é‡ä½¿ç”¨è‹±è¯­</li></ul><p>â€</p><p>DeepSeekå®˜æ–¹æç¤ºåº“</p><p><a href="https://api-docs.deepseek.com/zh-cn/prompt-library/">DeepSeekæç¤ºåº“</a></p><p>â€</p><blockquote><p>ç¤ºä¾‹æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_prompt_demo.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_prompt_demo.ipynb</a></p></blockquote><p>â€</p><h2 id="LangChain"><a href="#LangChain" class="headerlink" title="LangChain"></a>LangChain</h2><p>å¤§è¯­è¨€æ¨¡å‹ä¸­çš„æ‹“å±•å·¥å…·ç±»åº“ï¼Œä½œä¸ºå¤§è¯­è¨€æ¨¡å‹å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„æ¡¥æ¢ã€‚</p><blockquote><p>LangChain is a flexible abstractions and extensive toolkit enables developers to harness the power of LLMs.</p></blockquote><p>â€</p><p>å®‰è£…æ–¹å¼</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain</span><br><span class="line"></span><br><span class="line">pip install langchain-community</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><ul><li><p>æç¤ºè¯æ¨¡æ¿</p></li><li><p>ä¸åŒç¨‹åº¦çš„ä¸Šä¸‹æ–‡è®°å¿†</p></li><li><p>å¤§æ¨¡å‹è°ƒç”¨API</p><ul><li>è¿™ç§æŸ¥è¯¢æ–¹å¼ç±»ä¼¼äºçˆ¬è™«ï¼Œå¯èƒ½ä¼šè¢«å¤–éƒ¨ç½‘ç«™é˜»æ­¢ï¼Œå»ºè®®ä½¿ç”¨ç½‘ç«™æä¾›çš„API</li></ul></li><li><p>é“¾å¼è¯·æ±‚</p><ul><li>å°†å¤æ‚çš„ä»»åŠ¡åˆ†è§£ä¸ºæ›´ç®€å•çš„å­ä»»åŠ¡</li><li>â€‹<img src="/2025/02/15/%E6%90%AD%E5%BB%BAHelloGPT/image-20250128163023-kgl4499.png" alt="image">â€‹</li></ul></li></ul><p>â€</p><blockquote><p>ç¤ºä¾‹æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/langchain_demo.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/langchain_demo.ipynb</a></p></blockquote><p>â€</p><h2 id="ä¿æŒä¼šè¯çŠ¶æ€"><a href="#ä¿æŒä¼šè¯çŠ¶æ€" class="headerlink" title="ä¿æŒä¼šè¯çŠ¶æ€"></a>ä¿æŒä¼šè¯çŠ¶æ€</h2><p>LLMæ¨¡å‹æœ¬èº«çš„å¯¹è¯æ˜¯æ— çŠ¶æ€çš„ã€‚</p><p>ä½¿ç”¨<code>Gradio</code>â€‹ç±»åº“è®©Chatbotè·å¾—è®°å¿†ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚</p><ul><li>èƒ½å¤Ÿå¿«é€Ÿæ„å»ºåŸå‹</li><li>èƒ½å¤Ÿä¿å­˜ä¸Šä¸‹æ–‡å¯¹è¯ä¿¡æ¯</li></ul><p>â€</p><p>å®‰è£…</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install gradio</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯ä»¥ä½¿ç”¨LangChainçš„è®°å¿†åŠŸèƒ½ï¼Œè®©å¼€å‘æ›´åŠ ç®€å•</p><p>å¯ä»¥å°è¯•ä¸åŒç¨‹åº¦çš„è®°å¿†åŠŸèƒ½</p><p>ä¾‹å¦‚ï¼šConversationSummaryBufferMemory</p><p>å½“ç¼“å­˜å†…å®¹Tokenè¶…è¿‡å‚æ•° â€œmax_token_limitâ€ çš„å€¼åï¼Œå°±ä¼šå°†è¶…å‡ºçš„ä¼šè¯å†…å®¹è¿›è¡Œæ€»ç»“ï¼Œè¿™ä¸ªæ€»ç»“è¿‡ç¨‹ä¹Ÿæ˜¯é€šè¿‡å¤§æ¨¡å‹å®Œæˆçš„ã€‚</p><p>â€</p><p>ä½¿ç”¨è®°å¿†åŠŸèƒ½çš„æ¨¡å‹ï¼š</p><p><strong>ä¼˜ç‚¹</strong></p><ul><li>æ§åˆ¶äº†ç¼“å­˜å†…å®¹çš„å¤§å°</li><li>å°½é‡è®°å¿†å¯¹è¯çš„ä¸Šä¸‹æ–‡</li></ul><p>ç¼ºç‚¹</p><ul><li>åœ¨ç¼“å­˜å†…å®¹è¶…å‡ºé™åˆ¶åï¼Œä¸ºäº†æ§åˆ¶ç¼“å­˜çš„å¤§å°ï¼Œä¼šæŒç»­é€šè¿‡å¤§æ¨¡å‹æ¥æ€»ç»“è¾ƒæ—©çš„å†…å®¹ï¼Œä½¿ç¨‹åºç›¸åº”çš„å»¶è¿Ÿå¢åŠ </li><li>æˆæœ¬å¢åŠ </li></ul><p>â€</p><blockquote><p> ç¤ºä¾‹æºä»£ç </p><p><a href="https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_langchain_history.ipynb">https://github.com/KaloSora/HelloGPT/blob/dev/code/gpt_langchain_history.ipynb</a></p></blockquote><p>â€</p><h2 id="å¤§æ¨¡å‹åœ¨ä¼ä¸šä¸­çš„åº”ç”¨ç•…æƒ³"><a href="#å¤§æ¨¡å‹åœ¨ä¼ä¸šä¸­çš„åº”ç”¨ç•…æƒ³" class="headerlink" title="å¤§æ¨¡å‹åœ¨ä¼ä¸šä¸­çš„åº”ç”¨ç•…æƒ³"></a>å¤§æ¨¡å‹åœ¨ä¼ä¸šä¸­çš„åº”ç”¨ç•…æƒ³</h2><p>å¯å‘å¼äº¤äº’åº”ç”¨ï¼šå¦‚ä½ä»£ç å¹³å°ï¼Œæˆ–è‡ªç„¶è¯­è¨€ç”Ÿæˆä»£ç </p><p>Copilotï¼šAIåŠ©æ‰‹ï¼Œå¦‚å¾®è½¯ã€Appleçš„AIåŠ©æ‰‹ï¼Œæˆ–è€…æ˜¯ä¼ä¸šä¸­çš„ITç³»ç»Ÿè¯Šæ–­åŠ©æ‰‹</p><p>å¤§è¯­è¨€æ¨¡å‹çš„æ¨ç†&#x2F;ç”Ÿæˆï¼šç”Ÿæˆå¼AIåº”ç”¨</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€&lt;/p&gt;
&lt;h2 id=&quot;é€šè¿‡Azureè®¿é—®GPT&quot;&gt;&lt;a href=&quot;#é€šè¿‡Azureè®¿é—®GPT&quot; class=&quot;headerlink&quot; title=&quot;é€šè¿‡Azureè®¿é—®GPT&quot;&gt;&lt;/a&gt;é€šè¿‡Azureè®¿é—®GPT&lt;/h2&gt;&lt;p&gt;ä¸­å›½å¤§é™†åœ°åŒºä¸å…è®¸è®¿é—®GPTæœåŠ¡ï¼Œå¯ä»¥é€šè¿‡</summary>
      
    
    
    
    <category term="AI/ML" scheme="http://example.com/categories/AI-ML/"/>
    
    
    <category term="LLM" scheme="http://example.com/tags/LLM/"/>
    
    <category term="DeepSeek" scheme="http://example.com/tags/DeepSeek/"/>
    
  </entry>
  
  <entry>
    <title>Mac DeepSeekæœ¬åœ°éƒ¨ç½²</title>
    <link href="http://example.com/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/"/>
    <id>http://example.com/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/</id>
    <published>2025-02-09T03:11:11.000Z</published>
    <updated>2025-02-09T03:11:25.396Z</updated>
    
    <content type="html"><![CDATA[<p>â€</p><blockquote><p>DeepSeek Githubå¼€æºä»“åº“</p><p><a href="https://github.com/deepseek-ai">https://github.com/deepseek-ai</a></p><p>â€</p><p>R1ä»“åº“</p><p><a href="https://github.com/deepseek-ai/DeepSeek-R1">https://github.com/deepseek-ai/DeepSeek-R1</a></p></blockquote><p>â€</p><h2 id="å®‰è£…Ollama"><a href="#å®‰è£…Ollama" class="headerlink" title="å®‰è£…Ollama"></a>å®‰è£…Ollama</h2><p>Ollamaæ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œä¸“ä¸ºåœ¨æœ¬åœ°æœºå™¨ï¼ˆæ”¯æŒè·¨å¹³å°ï¼Œå¦‚Mac&#x2F;Windowsï¼‰ä¸Šä¾¿æ·éƒ¨ç½²å’Œè¿è¡Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è€Œè®¾è®¡ã€‚</p><p>*ä½¿ç”¨çš„æœºå™¨ä¸ºMac 2018 Pro, Intel CPUï¼ŒLM Studioä¸æ”¯æŒã€‚</p><blockquote><p>Ollamaä¸‹è½½é“¾æ¥</p><p><a href="https://ollama.com/download/mac">https://ollama.com/download/mac</a></p></blockquote><p>â€</p><p>éªŒè¯å®‰è£…ç»“æœ</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208155744-ss6d35f.png" alt="image">â€‹</p><p>â€</p><h2 id="Ollamaè½½å…¥Deepseek-r1"><a href="#Ollamaè½½å…¥Deepseek-r1" class="headerlink" title="Ollamaè½½å…¥Deepseek-r1"></a>Ollamaè½½å…¥Deepseek-r1</h2><p>åœ¨Ollamaå®˜ç½‘æ‰¾åˆ°R1æ¨¡å‹</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208160225-5ukfsvg.png" alt="image">â€‹</p><p>â€</p><p>é€‰æ‹©éœ€è¦çš„æ¨¡å‹ï¼Œå¤åˆ¶å‘½ä»¤</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208160323-kngn783.png" alt="image">â€‹</p><p>åœ¨å‘½ä»¤è¡Œé‡Œè¿è¡Œå¯¹åº”çš„å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½æ¨¡å‹</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208160414-bywa9rp.png" alt="image">â€‹</p><p>â€</p><p>è¿è¡Œç»“æœ</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208193550-jd15aq2.png" alt="image">â€‹</p><p>â€</p><h2 id="Chatboxä¸ºAIæ·»åŠ UI"><a href="#Chatboxä¸ºAIæ·»åŠ UI" class="headerlink" title="Chatboxä¸ºAIæ·»åŠ UI"></a>Chatboxä¸ºAIæ·»åŠ UI</h2><blockquote><p>Chatboxå®˜ç½‘</p><p><a href="https://chatboxai.app/zh">https://chatboxai.app/zh</a></p></blockquote><p>*UIä¹Ÿå¯ä»¥é€‰æ‹©Cherry Studio</p><p>é€‰æ‹©Ollama API</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208193833-c6ffl5u.png" alt="image">â€‹</p><p>â€</p><p>é€‰æ‹©å·²ä¸‹è½½çš„æ¨¡å‹</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208193914-rpsuerz.png" alt="image">â€‹</p><p>â€</p><p>é€‰æ‹©ä½ é…ç½®å¥½çš„æ¨¡å‹ï¼Œç„¶åæå‡ºä½ çš„é—®é¢˜</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250208194057-96fy3y7.png" alt="image">â€‹</p><p>â€</p><h2 id="å¼€å¯æœ¬åœ°è”ç½‘æœåŠ¡"><a href="#å¼€å¯æœ¬åœ°è”ç½‘æœåŠ¡" class="headerlink" title="å¼€å¯æœ¬åœ°è”ç½‘æœåŠ¡"></a>å¼€å¯æœ¬åœ°è”ç½‘æœåŠ¡</h2><p>å®‰è£…AnythingLLM</p><p><a href="https://docs.anythingllm.com/installation-desktop/macos">https://docs.anythingllm.com/installation-desktop/macos</a></p><p>â€</p><p>APIæä¾›å•†é€‰æ‹©Ollama</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250209094623-o1t509s.png" alt="image">â€‹</p><p>â€</p><p>åœ¨è®¾ç½®ä¸­æ‰¾åˆ°â€œä»£ç†æŠ€èƒ½â€ï¼Œå¼€å¯è¿ç½‘æœç´¢</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250209094943-2vud5jw.png" alt="image">â€‹</p><p>â€</p><p>å°è¯•æå‡ºä¸€ä¸ª2025å¹´2æœˆçš„äº‹ä»¶ï¼Œå¹¶è¦æ±‚deepseekåˆ†æå…¶å½±å“</p><p>*è¿™é‡Œè”ç½‘é€Ÿåº¦å’Œæ€è€ƒé€Ÿåº¦éƒ½æ¯”è¾ƒæ…¢</p><p>â€‹<img src="/2025/02/09/Mac-DeepSeek%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2/image-20250209100454-72pvg99.png" alt="image">â€‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;DeepSeek Githubå¼€æºä»“åº“&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/deepseek-ai&quot;&gt;https://github.com/deepseek-ai&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;â€&lt;/p&gt;</summary>
      
    
    
    
    <category term="AI/ML" scheme="http://example.com/categories/AI-ML/"/>
    
    
    <category term="LLM" scheme="http://example.com/tags/LLM/"/>
    
    <category term="DeepSeek" scheme="http://example.com/tags/DeepSeek/"/>
    
  </entry>
  
  <entry>
    <title>Windows DeepSeekæœ¬åœ°éƒ¨ç½²</title>
    <link href="http://example.com/2025/02/02/Windows-DeepSeek%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA/"/>
    <id>http://example.com/2025/02/02/Windows-DeepSeek%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA/</id>
    <published>2025-02-02T07:11:11.000Z</published>
    <updated>2025-02-09T03:16:02.904Z</updated>
    
    <content type="html"><![CDATA[<p>â€</p><p>DeepSeek R1 Distill æœ¬åœ°éƒ¨ç½²ç›¸å…³èµ„æ–™</p><blockquote><p>èµ„æ–™æ¥æº <a href="https://henjihenji.feishu.cn/wiki/MN3Vwl2STigk2qk1r6lcGoY5nYg">https://henjihenji.feishu.cn/wiki/MN3Vwl2STigk2qk1r6lcGoY5nYg</a></p></blockquote><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><p>å»ºè®®ä½¿ç”¨ NVIDIA å¡ï¼Œä½“éªŒä¼šå¥½ä¸å°‘ï¼ŒAMD æ˜¾å¡æœªåšæµ‹è¯•ï¼Œä½†åº”è¯¥ä¹Ÿæ˜¯èƒ½è·‘çš„</p><p>æ¬¢è¿å„ä½åœ¨æœ¬æ–‡æ¡£è¯„è®ºåŒºåé¦ˆå„è‡ªè¿è¡Œæƒ…å†µï¼Œè¿™æ ·å¯ä»¥å¸®åˆ°æ›´å¤šäºº</p><h1 id="LM-Studio"><a href="#LM-Studio" class="headerlink" title="LM Studio"></a>LM Studio</h1><p>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://lmstudio.ai/">https://lmstudio.ai/</a></p><p>å¤¸å…‹ç½‘ç›˜ï¼š<a href="https://pan.quark.cn/s/f7f610d2ac7a">https://pan.quark.cn/s/f7f610d2ac7a</a></p><h1 id="æ¨¡å‹åˆ—è¡¨"><a href="#æ¨¡å‹åˆ—è¡¨" class="headerlink" title="æ¨¡å‹åˆ—è¡¨"></a>æ¨¡å‹åˆ—è¡¨</h1><p>è¯·é€‰æ‹©æ–‡ä»¶ä½“ç§¯å°äºè‡ªå·±æ˜¾å­˜å¤§å°çš„æ¨¡å‹ï¼Œç•¥å¤§ä¸€äº›çš„è™½ç„¶ä¹Ÿèƒ½è·‘ï¼Œä½†æ˜¯é€Ÿåº¦ä¼šæ…¢å¾ˆå¤šã€‚å› ä¸ªäººèƒ½åŠ›æœ‰é™ï¼Œä»¥ä¸‹æ¨¡å‹æ¨èä¸ä¸€å®šæ˜¯æœ€å¥½çš„</p><p>æ›´å¤šæ¨¡å‹ä¸‹è½½</p><p>  é“¾æ¥1ï¼š<a href="https://www.modelscope.cn/organization/lmstudio-community">https://www.modelscope.cn/organization/lmstudio-community</a></p><p>  è®°å¾—ç”¨æœç´¢åŠŸèƒ½æœç´¢ DeepSeek ç›¸å…³æ¨¡å‹</p><p>  é“¾æ¥2ï¼š<a href="https://www.modelscope.cn/collections/DeepSeek-R1-Distill-GGUF-eec5fee2f2ee42">https://www.modelscope.cn/collections/DeepSeek-R1-Distill-GGUF-eec5fee2f2ee42</a></p><p>  ç›¸æ¯”é“¾æ¥1ä¼šå¤šä¸€ç‚¹ä¸åŒé‡åŒ–ç²¾åº¦çš„æ¨¡å‹</p><p><strong>ç‚¹å‡»æ¨¡å‹åç§°å¯ä»¥ç›´æ¥ä¸‹è½½</strong></p><table><thead><tr><th>æ˜¾å­˜å¤§å°</th><th>æ¨èæ¨¡å‹</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>32GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-32B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-32B-Q6_K.gguf">DeepSeek-R1-Distill-Qwen-32B-Q6_K.gguf</a></td><td></td></tr><tr><td>24GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-32B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-32B-Q4_K_M.gguf">DeepSeek-R1-Distill-Qwen-32B-Q4_K_M.gguf</a><br><a href="https://www.modelscope.cn/models/unsloth/DeepSeek-R1-Distill-Qwen-32B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-32B-Q5_K_M.gguf">DeepSeek-R1-Distill-Qwen-32B-Q5_K_M.gguf</a></td><td>äºŒé€‰ä¸€å³å¯ï¼Œæ¯”è¾ƒæ¨èç¬¬ä¸€ä¸ª<br><a href="https://www.modelscope.cn/models/unsloth/DeepSeek-R1-Distill-Qwen-32B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-32B-Q5_K_M.gguf">Q5</a> è´¨é‡ä¸Šå¯èƒ½ä¼šå¥½ä¸€ç‚¹ï¼Œä½†æ˜¯å› ä¸ºå¤ªæ¥è¿‘ 24G æ˜¾å­˜ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡å¤šäº†ä¹‹åï¼Œé€Ÿåº¦å¯èƒ½ä¼šæ…¢ã€‚<br>ä¸Šé¢çš„ <a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-32B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-32B-Q6_K.gguf">Q6</a> å‹‰å¼ºä¹Ÿèƒ½è·‘ï¼Œä½†é€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ã€‚</td></tr><tr><td>16GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-14B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-14B-Q6_K.gguf">DeepSeek-R1-Distill-Qwen-14B-Q6_K.gguf</a></td><td></td></tr><tr><td>12GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-14B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-14B-Q4_K_M.gguf">DeepSeek-R1-Distill-Qwen-14B-Q4_K_M.gguf</a></td><td></td></tr><tr><td>11GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-14B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-14B-Q4_K_M.gguf">DeepSeek-R1-Distill-Qwen-14B-Q4_K_M.gguf</a></td><td></td></tr><tr><td>8GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-7B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-7B-Q6_K.gguf">DeepSeek-R1-Distill-Qwen-7B-Q6_K.gguf</a><br><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Llama-8B-GGUF/resolve/master/DeepSeek-R1-Distill-Llama-8B-Q6_K.gguf">DeepSeek-R1-Distill-Llama-8B-Q6_K.gguf</a></td><td>äºŒé€‰ä¸€å³å¯</td></tr><tr><td>6GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-7B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-7B-Q4_K_M.gguf">DeepSeek-R1-Distill-Qwen-7B-Q4_K_M.gguf</a><br><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Llama-8B-GGUF/resolve/master/DeepSeek-R1-Distill-Llama-8B-Q4_K_M.gguf">DeepSeek-R1-Distill-Llama-8B-Q4_K_M.gguf</a></td><td>äºŒé€‰ä¸€å³å¯</td></tr><tr><td>4GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-7B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-7B-Q3_K_L.gguf">DeepSeek-R1-Distill-Qwen-7B-Q3_K_L.gguf</a><br><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-1.5B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-1.5B-Q8_0.gguf">DeepSeek-R1-Distill-Qwen-1.5B-Q8_0.gguf</a></td><td>äºŒé€‰ä¸€å³å¯ï¼Œæ¯”è¾ƒæ¨èç¬¬ä¸€ä¸ª<br>ç¬¬äºŒä¸ª 4G æ˜¾å­˜èƒ½è·‘ï¼Œä½†å¯èƒ½ä¼šæ¯”è¾ƒæ…¢</td></tr><tr><td>3GBã€2GB</td><td><a href="https://www.modelscope.cn/models/lmstudio-community/DeepSeek-R1-Distill-Qwen-1.5B-GGUF/resolve/master/DeepSeek-R1-Distill-Qwen-1.5B-Q8_0.gguf">DeepSeek-R1-Distill-Qwen-1.5B-Q8_0.gguf</a></td><td></td></tr></tbody></table><h1 id="å¦‚ä½•æŸ¥çœ‹è‡ªå·±çš„æ˜¾å­˜"><a href="#å¦‚ä½•æŸ¥çœ‹è‡ªå·±çš„æ˜¾å­˜" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹è‡ªå·±çš„æ˜¾å­˜"></a>å¦‚ä½•æŸ¥çœ‹è‡ªå·±çš„æ˜¾å­˜</h1><p>â€‹<img src="/2025/02/02/Windows-DeepSeek%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA/image-20250209100647-xmyvf48.png" alt="image">â€‹</p><table><thead><tr><th>æ˜¾å­˜å¤§å°</th><th>å¯¹åº”Nå¡å‹å·</th></tr></thead><tbody><tr><td>2GB</td><td>GTX 1050ã€GT 1030</td></tr><tr><td>3GB</td><td>GTX 1060 3GB</td></tr><tr><td>4GB</td><td>GTX 1050 Ti</td></tr><tr><td>6GB</td><td>GTX 1060 6GBã€RTX 2060 6GBã€RTX 3050 (6GB)</td></tr><tr><td>8GB</td><td>GTX 1080ã€GTX 1070 Tiã€GTX 1070ã€RTX 2080 SUPERã€RTX 2080ã€RTX 2070 SUPERã€RTX 2070ã€RTX 2060 SUPERã€RTX 3070 Tiã€RTX 3070ã€RTX 3060 Tiã€RTX 3060 (8GB)ã€RTX 3050 (8GB)ã€RTX 4080ã€RTX 4060 Ti 8GBã€RTX 4060ã€RTX 5070</td></tr><tr><td>11GB</td><td>GTX 1080 Tiã€RTX 2080 Ti</td></tr><tr><td>12GB</td><td>RTX 2060 12GBã€RTX 3060 (12GB)ã€RTX 4070 Ti SUPERã€RTX 4070ã€RTX 5070 Ti</td></tr><tr><td>16GB</td><td>RTX 4060 Ti 16GBã€RTX 5080</td></tr><tr><td>24GB</td><td>RTX 3090 Tiã€RTX 3090ã€RTX 4090</td></tr><tr><td>32GB</td><td>RTX 5090</td></tr></tbody></table><p>â€</p><h1 id="æœ¬åœ°éƒ¨ç½²æµ‹è¯•"><a href="#æœ¬åœ°éƒ¨ç½²æµ‹è¯•" class="headerlink" title="æœ¬åœ°éƒ¨ç½²æµ‹è¯•"></a>æœ¬åœ°éƒ¨ç½²æµ‹è¯•</h1><p>GPUï¼šAMD Radeon RX580 8G</p><p>CPUï¼šAMD Ryzen 5600X</p><p>å†…å­˜ï¼š16G</p><p>â€</p><p>è¿è¡ŒLM Studio</p><p>â€‹<img src="/2025/02/02/Windows-DeepSeek%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA/image-20250209110548-fxxeq1n.png" alt="image">â€‹</p><p>â€</p><p>åŠ è½½æœ¬åœ°æ¨¡å‹</p><p>æ³¨æ„æ¨¡å‹è¿™é‡Œç›´æ¥é€‰æ ¹ç›®å½•ï¼ŒLM Studioä¼šè‡ªåŠ¨æœç´¢</p><p>â€‹<img src="/2025/02/02/Windows-DeepSeek%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA/image-20250209110613-zipexwj.png" alt="image">â€‹</p><p>â€</p><p>ç‚¹å‡»é¡¶éƒ¨åŠ è½½æ¨¡å‹ï¼Œå¼€å§‹æ–°çš„å¯¹è¯</p><p>â€‹<img src="/2025/02/02/Windows-DeepSeek%E6%9C%AC%E5%9C%B0%E6%90%AD%E5%BB%BA/image-20250209110630-hf4qhqg.png" alt="image">â€‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€&lt;/p&gt;
&lt;p&gt;DeepSeek R1 Distill æœ¬åœ°éƒ¨ç½²ç›¸å…³èµ„æ–™&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;èµ„æ–™æ¥æº &lt;a href=&quot;https://henjihenji.feishu.cn/wiki/MN3Vwl2STigk2qk1r6lcGoY5nYg&quot;&gt;ht</summary>
      
    
    
    
    <category term="AI/ML" scheme="http://example.com/categories/AI-ML/"/>
    
    
    <category term="LLM" scheme="http://example.com/tags/LLM/"/>
    
    <category term="DeepSeek" scheme="http://example.com/tags/DeepSeek/"/>
    
  </entry>
  
  <entry>
    <title>Jupyter Notebook</title>
    <link href="http://example.com/2025/01/29/Jupyter-Notebook/"/>
    <id>http://example.com/2025/01/29/Jupyter-Notebook/</id>
    <published>2025-01-29T06:07:11.000Z</published>
    <updated>2025-01-29T06:16:35.669Z</updated>
    
    <content type="html"><![CDATA[<p>â€</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><a href="https://jupyter.org/">Jupyterå®˜ç½‘</a></p><blockquote><p>JupyterLabæ˜¯æœ€æ–°çš„åŸºäºwebçš„ç¬”è®°æœ¬ã€ä»£ç å’Œæ•°æ®äº¤äº’å¼å¼€å‘ç¯å¢ƒã€‚å…¶çµæ´»çš„ç•Œé¢å…è®¸ç”¨æˆ·é…ç½®å’Œå®‰æ’æ•°æ®ç§‘å­¦ã€ç§‘å­¦è®¡ç®—ã€è®¡ç®—æ–°é—»å’Œæœºå™¨å­¦ä¹ ä¸­çš„å·¥ä½œæµç¨‹ã€‚æ¨¡å—åŒ–è®¾è®¡é‚€è¯·æ‰©å±•æ¥æ‰©å±•å’Œä¸°å¯ŒåŠŸèƒ½ã€‚</p></blockquote><p>è¯¥å·¥å…·å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p><ul><li>å…è®¸ä½¿ç”¨markdownè¯­æ³•</li><li>æ”¯æŒå¿«é€Ÿå¯¼å‡ºå¤šç§æ–‡ä»¶æ ¼å¼</li><li>æ”¯æŒéƒ¨ç½²åœ¨è¿œç¨‹ç¯å¢ƒ</li><li>ä¸ä»…ä»…æ”¯æŒPythonï¼Œä¹Ÿæ”¯æŒJavascriptï¼ŒRubyç­‰è¯­è¨€</li></ul><p>å› æ­¤ï¼Œè®¸å¤šå…¬å¼€è¯¾ç½‘ç«™å’Œå¤§å­¦è¯¾ç¨‹æ™®éä½¿ç”¨Jupyteråˆ†å‘ä½œä¸šã€‚å®ƒä¹Ÿé€‚åˆæœºå™¨å­¦ä¹ å’Œæ•°æ®åˆ†æï¼Œæ˜¯é›†ç¼–ç¨‹å’Œå†™ä½œä¸ä¸€èº«çš„å·¥å…·ã€‚</p><p>è¿™ç§ç¼–ç¨‹æ–¹å¼ä¹Ÿå¯ä»¥ç§°ä¸ºæ–‡å­¦ç¼–ç¨‹ã€‚</p><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><p>å®‰è£…å‘½ä»¤</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install jupyter</span><br></pre></td></tr></table></figure><p>â€</p><p>è¿è¡Œç»“æœ</p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194112-m528stx.png" alt="image">â€‹</p><p>â€</p><p>è¿è¡Œå‘½ä»¤</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="punctuation">[</span>target_folder<span class="punctuation">]</span></span><br><span class="line">jupyter notebook</span><br></pre></td></tr></table></figure><p>â€</p><p>è¿è¡Œç»“æœ</p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194224-8owk4qo.png" alt="image">â€‹</p><p>æµè§ˆå™¨è¾“å…¥<code>http://localhost:8888/</code>â€‹è®¿é—®Jupyter</p><p>â€</p><p>åˆ›å»ºæ–°Pythonæ–‡ä»¶ï¼Œå¹¶è¿è¡Œç¬¬ä¸€è¡Œæµ‹è¯•ä»£ç </p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194421-wre78l2.png" alt="image">â€‹</p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194624-s0xokbq.png" alt="image">â€‹</p><p>â€</p><p>åœ¨æœ¬åœ°ç›®å½•æ£€æŸ¥æ–°æ–‡ä»¶</p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194833-rsd6qx2.png" alt="image">â€‹</p><p>â€</p><p>Jupyteræ–‡ä»¶æ”¯æŒå¯¼å‡ºå¤šç§æ ¼å¼</p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194946-9pknd69.png" alt="image">â€‹</p><p>â€</p><p>è¾“å…¥<code>h</code>â€‹æŸ¥çœ‹æ‰€æœ‰å¿«æ·é”®</p><p>â€‹<img src="/2025/01/29/Jupyter-Notebook/image-20250125194351-1zd7ao9.png" alt="image">â€‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€&lt;/p&gt;
&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://jupyter.org/&quot;&gt;Jupyterå®˜ç½‘&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;</summary>
      
    
    
    
    <category term="AI/ML" scheme="http://example.com/categories/AI-ML/"/>
    
    
    <category term="Python" scheme="http://example.com/tags/Python/"/>
    
    <category term="LLM" scheme="http://example.com/tags/LLM/"/>
    
  </entry>
  
  <entry>
    <title>AWS Terraform Section4 - Project</title>
    <link href="http://example.com/2024/06/30/AWS-Terraform-Section4-Project/"/>
    <id>http://example.com/2024/06/30/AWS-Terraform-Section4-Project/</id>
    <published>2024-06-30T02:27:54.000Z</published>
    <updated>2024-06-30T02:36:59.204Z</updated>
    
    <content type="html"><![CDATA[<p>â€</p><p>åˆ›å»ºGitä»“åº“ç”¨äºå­˜æ”¾Terraformä»£ç </p><p>åˆ›å»º.gitignore</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># ignore local .terraform dir</span><br><span class="line">.terraform/*</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><p>ç›®æ ‡ï¼šåˆ›å»ºä¸€ä¸ªEC2å®ä¾‹ï¼Œå¹¶ä¸”åœ¨EC2é‡Œè¿è¡Œä¸€ä¸ªnginx dockerå®¹å™¨</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240627220019-nclsrwk.png" alt="image">â€‹</p><p>â€</p><p>éœ€è¦åˆ›å»ºçš„AWSèµ„æº</p><p>*æœ€å¥½ä¸è¦ä½¿ç”¨é»˜è®¤çš„AWSèµ„æº</p><ol><li>åˆ›å»ºVPC</li><li>åˆ›å»ºSubnet</li><li>åˆ›å»ºRoute Table &amp; Internet Gateway</li><li>åˆ›å»ºEC2</li><li>éƒ¨ç½²nginx dockerå®¹å™¨</li><li>åˆ›å»ºSecurity Group(Firewall)ï¼Œå¹¶å…è®¸ssh</li></ol><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240627220353-vawsy7w.png" alt="image">â€‹</p><p>â€</p><h2 id="åˆ›å»ºVPC-Subnet"><a href="#åˆ›å»ºVPC-Subnet" class="headerlink" title="åˆ›å»ºVPC &amp; Subnet"></a>åˆ›å»ºVPC &amp; Subnet</h2><p>terraform.tfvars</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vpc_cidr_block = &quot;10.0.0.0/16&quot;</span><br><span class="line">subnet_cidr_block = &quot;10.0.0.0/24&quot;</span><br><span class="line">avail_zone = &quot;eu-west-3b&quot;</span><br><span class="line">env_prefix = &quot;dev&quot;</span><br></pre></td></tr></table></figure><p>â€</p><p>main.tf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">provider &quot;aws&quot; &#123;</span><br><span class="line">    region = &quot;eu-west-3&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">variable vpc_cidr_block &#123;&#125;</span><br><span class="line">variable subnet_cidr_block &#123;&#125;</span><br><span class="line">variable avail_zone &#123;&#125;</span><br><span class="line">variable env_prefix &#123;&#125;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºVPC</span><br><span class="line">resource &quot;aws_vpc&quot; &quot;myapp-vpc&quot; &#123;</span><br><span class="line">  cidr_block = var.vpc_cidr_block</span><br><span class="line"></span><br><span class="line">  # vpcåç§°å¸¦æœ‰&quot;vpc&quot;å‰ç¼€</span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name: &quot;$&#123;var.env_prefix&#125;-vpc&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºSubnet</span><br><span class="line">resource &quot;aws_subnet&quot; &quot;myapp-subnet-1&quot; &#123;</span><br><span class="line">  vpc_id = aws_vpc.myapp-vpc.id</span><br><span class="line">  cidr_block = var.vpc_cidr_block</span><br><span class="line">  availability_zone = var.avail_zone</span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name: &quot;$&#123;var.env_prefix&#125;-subnet-1&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>åœ¨AWSä¸ŠæŸ¥çœ‹ç»“æœ</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240627221856-zq53z7g.png" alt="image">â€‹</p><p>â€</p><h2 id="Route-Table"><a href="#Route-Table" class="headerlink" title="Route Table"></a>Route Table</h2><p>Route tableå†³å®šäº†VPCè½¬å‘çš„ç›®çš„åœ°</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629093707-g015c9a.png" alt="image">â€‹</p><p>â€</p><p>åœ¨Terraform codeä¸å¿…æ ¹æ®æ‰§è¡Œçš„å…ˆåæ¥ç¼–å†™ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºRoute table</span><br><span class="line">resource &quot;aws_route_table&quot; &quot;myapp-route-table&quot; &#123;</span><br><span class="line">  vpc_id = aws_vpc.myapp-vpc.id</span><br><span class="line"></span><br><span class="line">  route = &#123;</span><br><span class="line">    cidr_block = &quot;0.0.0.0/0&quot;</span><br><span class="line">    gateway_id = aws_internet_gateway.myapp-igw.id</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name: &quot;$&#123;var.env_prefix&#125;-rtb&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Route table gateway</span><br><span class="line">resource &quot;aws_internet_gateway&quot; &quot;myapp-igw&quot; &#123;</span><br><span class="line">  vpc_id = aws_vpc.myapp-vpc.id</span><br><span class="line"></span><br><span class="line">    tags = &#123;</span><br><span class="line">    Name: &quot;$&#123;var.env_prefix&#125;-igw&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œç»“æœ</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629095048-bxhndn1.png" alt="image">â€‹</p><p>â€</p><p>åŒæ—¶è¿˜è¦ä¸ºRoute tableå’ŒSubnetåˆ›å»ºå…³è”</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629095414-dwpb65b.png" alt="image">â€‹</p><p>Terraform code</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Route table &amp; Subnect</span><br><span class="line">resource &quot;aws_route_table_association&quot; &quot;a-rtb-subnet&quot; &#123;</span><br><span class="line">  subnet_id = aws_subnet.myapp-subnet-1.id</span><br><span class="line">  route_table_id = aws_route_table.myapp-route-table.id</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><h2 id="Security-Group-Firewall"><a href="#Security-Group-Firewall" class="headerlink" title="Security Group &amp; Firewall"></a>Security Group &amp; Firewall</h2><p>åˆ›å»ºå®‰å…¨ç»„</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629100936-owifg74.png" alt="image">â€‹</p><p>Terraform code</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># Security Group</span><br><span class="line">resource &quot;aws_security_group&quot; &quot;myapp-sg&quot; &#123;</span><br><span class="line">  name = &quot;myapp-sg&quot;</span><br><span class="line">  vpc_id = aws_vpc.myapp-vpc.id</span><br><span class="line">  </span><br><span class="line">  # Incoming traffic</span><br><span class="line">  ingress = &#123;</span><br><span class="line">    from_port = 22</span><br><span class="line">    to_port = 22</span><br><span class="line">    protocal = &quot;tcp&quot;</span><br><span class="line"></span><br><span class="line">    # IPs allow list</span><br><span class="line">    cidr_block = [&quot;your_allow_ip/32&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  # Outgoing traffic</span><br><span class="line">  egress = &#123;</span><br><span class="line">    # Allowing all port and ip</span><br><span class="line">    from_port = 0</span><br><span class="line">    to_port = 0</span><br><span class="line">    protocal = &quot;-1&quot;</span><br><span class="line">    cidr_block = [&quot;0.0.0.0/0&quot;]</span><br><span class="line">    prefix_list_ids = []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name: &quot;$&#123;var.env_prefix&#125;-sg&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œç»“æœ</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629101551-0c9lczq.png" alt="image">â€‹</p><p>â€</p><h2 id="EC2-AMI"><a href="#EC2-AMI" class="headerlink" title="EC2 &amp; AMI"></a>EC2 &amp; AMI</h2><p>Amazon Machine Image(AMI)æ˜¯awsæä¾›çš„æ“ä½œç³»ç»Ÿé•œåƒï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®AMIåˆ›å»ºè‡ªå·±çš„æ“ä½œç³»ç»Ÿå®ä¾‹ã€‚</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629102443-vk9vmei.png" alt="image">â€‹</p><p>â€</p><p>Terraform code</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"># AWS AMI data definition</span><br><span class="line">data &quot;aws_ami&quot; &quot;latest_aws-linux-image&quot; &#123;</span><br><span class="line">  # Always get latest image</span><br><span class="line">  most_recent = true</span><br><span class="line"></span><br><span class="line">  owners = [&quot;amazon&quot;]</span><br><span class="line">  </span><br><span class="line">  # filter image name with regrex</span><br><span class="line">  filter &#123;</span><br><span class="line">    name = &quot;name&quot;</span><br><span class="line">    values = [&quot;amzn2-ami-hvm-*-x86_64_gp2&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">  filter &#123;</span><br><span class="line">    name = &quot;virtualization-type&quot;</span><br><span class="line">    values = [&quot;hvm&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Only test for ami id output</span><br><span class="line"># When execute &quot;terraform plan&quot;, can see value from console</span><br><span class="line"># output &quot;name&quot; &#123;</span><br><span class="line">#   value = data.aws_ami.latest_aws-linux-image</span><br><span class="line"># &#125;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºaws key pair</span><br><span class="line">resource &quot;aws_key_pair&quot; &quot;ssh-key&quot; &#123;</span><br><span class="line">  key_name = &quot;server-key&quot;</span><br><span class="line"></span><br><span class="line">  # å¼•ç”¨æ–‡ä»¶</span><br><span class="line">  public_key = &quot;$&#123;file(&quot;/User/xxx/.ssh/key_file.pub&quot;)&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºæ“ä½œç³»ç»Ÿå®ä¾‹ - EC2</span><br><span class="line">resource &quot;aws_instance&quot; &quot;myapp-server&quot; &#123;</span><br><span class="line">  # Id of ami</span><br><span class="line">  ami = data.aws_ami.latest_aws-linux-image.id</span><br><span class="line">  instance_type = &quot;t2.micro&quot;</span><br><span class="line"></span><br><span class="line">  # å¼•ç”¨å·²ç»åˆ›å»ºå¥½çš„VPC &amp; Subnect</span><br><span class="line">  subnet_id = aws_subnet.myapp-subnet-1.id</span><br><span class="line">  vpc_security_group_ids = [aws_default_security_group.default-sg.id]</span><br><span class="line">  availability_zone = var.avail_zone</span><br><span class="line">  associate_public_ip_address = true</span><br><span class="line"></span><br><span class="line">  # Server key pair, permission should be 400</span><br><span class="line">  # AWS will reject ssh request if permission not set correctly</span><br><span class="line">  # It&#x27;s generate from AWS console, provide the key file name</span><br><span class="line">  key_name = aws_key_pair.ssh-key.key_name </span><br><span class="line">  </span><br><span class="line">  tags = &#123;</span><br><span class="line">    Name = &quot;$&#123;var.env_prefix&#125;-server&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç­‰å¾…EC2åˆ›å»º</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629145356-5h7sdlf.png" alt="image">â€‹</p><p>â€</p><h3 id="EC2-initialize-script"><a href="#EC2-initialize-script" class="headerlink" title="EC2 initialize script"></a>EC2 initialize script</h3><p>æ·»åŠ  <code>user_data=</code>â€‹ï¼Œè®¾ç½®EC2åˆå§‹åŒ–æ—¶è‡ªåŠ¨è¿è¡Œè„šæœ¬</p><p>ä¸‹å›¾ä¸­çš„ä»£ç å—åªä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™è¢«æ‰§è¡Œä¸€æ¬¡</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629152214-ngas3tc.png" alt="image">â€‹</p><p>â€</p><p>å¦‚æœéœ€è¦æ‰§è¡Œå®šä¹‰å¥½çš„è„šæœ¬è€Œä¸æ˜¯ä»£ç å—ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629152738-j165ka4.png" alt="image">â€‹</p><p>â€</p><p><strong>å¦ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨Provisioneræ‰§è¡Œè„šæœ¬</strong></p><p>ä½¿ç”¨<code>remote-exec</code>â€‹åœ¨EC2ä¸Šæ‰§è¡Œè„šæœ¬</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629154524-8ou2ulm.png" alt="image">â€‹</p><p>â€</p><p>å¯ä»¥ä½¿ç”¨<code>local-exec</code>â€‹åœ¨æœ¬åœ°æœºå™¨ä¸Šæ‰§è¡Œå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">provisioner &quot;local-exec&quot; &#123;</span><br><span class="line">  command = &quot;echo $&#123;self.public_ip&#125; &gt; output.txt&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>Terraformæ–‡æ¡£ä¸Šè¯´æ˜<code>Provisioners</code>â€‹æ˜¯æ²¡æœ‰å…¶ä»–é€‰æ‹©æ—¶çš„æœ€åæ‰‹æ®µ</p><ul><li>å°½é‡é‡‡ç”¨<code>user_data</code>â€‹è€Œä¸æ˜¯<code>Provisioners</code>â€‹</li><li>å°½é‡ä½¿ç”¨â€local providerâ€å–ä»£<code>local-exec</code>â€‹</li><li>å°½é‡é‡‡ç”¨é…ç½®ç®¡ç†å·¥å…·å–ä»£<code>Provisioners</code>â€‹ï¼Œå¦‚Ansible, Jenkins</li></ul><p>å®é™…ä¸Š<code>Provisioners</code>â€‹æ‰“ç ´äº†Terraformçš„æ¦‚å¿µã€‚Terraformèƒ½é€šè¿‡ç›¸åŒçš„ç»„ä»¶çŠ¶æ€æ€»æ˜¯æä¾›ä¸€è‡´çš„è¿”å›ç»“æœï¼Œä½†æ˜¯<code>Provisioners</code>â€‹æ‰§è¡Œçš„è„šæœ¬å´æ˜¯æœªçŸ¥çš„ï¼ŒTerraformæ— æ³•è·å–åˆ°å…¶ä¸­çš„çŠ¶æ€ã€‚</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629155206-cpb6z6n.png" alt="image">â€‹</p><p>â€</p><p>ä¸€ç§å¯èƒ½çš„æƒ…å†µæ˜¯ï¼ŒProvisionerä¸­çš„è„šæœ¬æ‰§è¡Œé”™è¯¯ï¼Œæ­¤æ—¶terraformä¸ä¼šè¿”å›å…·ä½“çš„çŠ¶æ€ä¿¡æ¯ã€‚</p><p>è¿™ç§çŠ¶æ€ä¸‹æ— æ³•å¾—çŸ¥EC2å…·ä½“æ˜¯å¦è¢«åˆ›å»º</p><p>â€‹<img src="/2024/06/30/AWS-Terraform-Section4-Project/image-20240629160318-0x1irb3.png" alt="image">â€‹</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€&lt;/p&gt;
&lt;p&gt;åˆ›å»ºGitä»“åº“ç”¨äºå­˜æ”¾Terraformä»£ç &lt;/p&gt;
&lt;p&gt;åˆ›å»º.gitignore&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span clas</summary>
      
    
    
    
    <category term="AWS Terraform" scheme="http://example.com/categories/AWS-Terraform/"/>
    
    
    <category term="AWS" scheme="http://example.com/tags/AWS/"/>
    
  </entry>
  
  <entry>
    <title>AWS Terraform Section3 - Input and Output</title>
    <link href="http://example.com/2024/06/29/AWS-Terraform-Section3-Input-and-Output/"/>
    <id>http://example.com/2024/06/29/AWS-Terraform-Section3-Input-and-Output/</id>
    <published>2024-06-29T07:20:11.000Z</published>
    <updated>2024-06-30T02:24:49.755Z</updated>
    
    <content type="html"><![CDATA[<p>â€</p><h2 id="Terraform-output"><a href="#Terraform-output" class="headerlink" title="Terraform output"></a>Terraform output</h2><p>ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;aws_subnet&quot; &quot;dev-subnet-1&quot; &#123;</span><br><span class="line">    # æŒ‡å®šsubnetæ‰€å±çš„VPC</span><br><span class="line">    # ç›®å‰VPCè¿˜æ²¡åˆ›å»ºï¼Œæ‰€ä»¥éœ€è¦åŠ¨æ€å¼•ç”¨å®šä¹‰çš„èµ„æº</span><br><span class="line">    vpc_id = aws_pvc.development-vpc.id</span><br><span class="line"></span><br><span class="line">    # å®šä¹‰VPCåœ°å€èŒƒå›´çš„å­é›†</span><br><span class="line">    cidr_block = &quot;10.0.10.0/24&quot;</span><br><span class="line"></span><br><span class="line">    availability_zone = &quot;eu-west-3a&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">output &quot;dev-subnet-id&quot; &#123;</span><br><span class="line">    value = aws_subnet.dev-subnet-1.id</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform plan</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºäº†<code>output</code>â€‹ä¸­å®šä¹‰çš„å€¼</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627085444-muswq4x.png" alt="image">â€‹</p><p>â€</p><p>*å¯ä»¥ä½¿ç”¨vscodeç¼–å†™Terraform codeï¼Œè¯¥å·¥å…·æ”¯æŒæ‰“å¼€ç»ˆç«¯</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240629162626-a5xvcbc.png" alt="image">â€‹</p><p>â€</p><h2 id="Terraform-input"><a href="#Terraform-input" class="headerlink" title="Terraform input"></a>Terraform input</h2><p>åœ¨Terraformä¸­å¼•ç”¨å˜é‡</p><ul><li>é€šè¿‡<code>default</code>â€‹ç»™å®šé»˜è®¤å€¼</li><li>é€šè¿‡<code>type</code>â€‹è®¾ç½®å˜é‡ç±»å‹ï¼Œå¦‚list(string), string, objectç­‰</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">variable &quot;subnet_cidr_block&quot; &#123;</span><br><span class="line">    description = &quot;subnet cidr block&quot;</span><br><span class="line">default=&quot;10.0.10.0/24&quot;</span><br><span class="line">type = string</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">resource &quot;aws_subnet&quot; &quot;dev-subnet-1&quot; &#123;</span><br><span class="line">    vpc_id = aws_pvc.development-vpc.id</span><br><span class="line">    cidr_block = var.subnet_cidr_block</span><br><span class="line"></span><br><span class="line">    availability_zone = &quot;eu-west-3a&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>Objectç¤ºä¾‹</p><p>terraform.tfvars</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cidr_blocks = [</span><br><span class="line">&#123;cidr_block-=&quot;10.0.0.0/16&quot;, name=&quot;dev-vpc&quot;&#125;, </span><br><span class="line">&#123;cidr_block-=&quot;10.0.0.0/16&quot;, name=&quot;dev-vpc&quot;&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>â€</p><p>å˜é‡å®šä¹‰æ–¹å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">variable &quot;cidr_blocks&quot; &#123;</span><br><span class="line">  type = list(object(&#123;</span><br><span class="line">    cidr_block = string</span><br><span class="line">    name = string</span><br><span class="line">  &#125;))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>å¼•ç”¨æ–¹å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;aws_pvc&quot; &quot;development-vpc&quot; &#123;</span><br><span class="line"></span><br><span class="line">    cider_block = var.cider_block[0].cider_block</span><br><span class="line">    tags = &#123;</span><br><span class="line">        Name: var.cider_block[0].name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="å˜é‡çš„èµ‹å€¼æ–¹å¼"><a href="#å˜é‡çš„èµ‹å€¼æ–¹å¼" class="headerlink" title="å˜é‡çš„èµ‹å€¼æ–¹å¼"></a>å˜é‡çš„èµ‹å€¼æ–¹å¼</h3><h4 id="é€šè¿‡æ§åˆ¶å°è¾“å…¥"><a href="#é€šè¿‡æ§åˆ¶å°è¾“å…¥" class="headerlink" title="é€šè¿‡æ§åˆ¶å°è¾“å…¥"></a>é€šè¿‡æ§åˆ¶å°è¾“å…¥</h4><p>ç›´æ¥æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform apply</span><br></pre></td></tr></table></figure><p>â€</p><p>ç„¶ååœ¨æ§åˆ¶å°è¾“å…¥å†…å®¹</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627090358-a0f77fr.png" alt="image">â€‹</p><p>â€</p><h4 id="å‘½ä»¤è¡Œä¼ å‚æ•°"><a href="#å‘½ä»¤è¡Œä¼ å‚æ•°" class="headerlink" title="å‘½ä»¤è¡Œä¼ å‚æ•°"></a>å‘½ä»¤è¡Œä¼ å‚æ•°</h4><p>åœ¨æ§åˆ¶å°æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform -var &quot;subnet_cidr_block=10.0.30.0/24&quot;</span><br></pre></td></tr></table></figure><p>â€</p><h4 id="ï¼ˆå¸¸ç”¨ï¼‰å®šä¹‰å˜é‡æ–‡ä»¶"><a href="#ï¼ˆå¸¸ç”¨ï¼‰å®šä¹‰å˜é‡æ–‡ä»¶" class="headerlink" title="ï¼ˆå¸¸ç”¨ï¼‰å®šä¹‰å˜é‡æ–‡ä»¶"></a>ï¼ˆå¸¸ç”¨ï¼‰å®šä¹‰å˜é‡æ–‡ä»¶</h4><p>å½“æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ—¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform apply -var-file terraform-dev.tfvars --target=module.xxx</span><br></pre></td></tr></table></figure><p>å˜é‡ä¼ é€’é“¾è·¯å¦‚ä¸‹</p><p>â€‹<code>*.tfvars</code>â€‹ -&gt; variable.tf -&gt; main.tf -&gt; output.tf</p><p>â€</p><p>ä¾‹å¦‚ï¼š</p><p>åˆ›å»ºä¸€ä¸ª<code>*.tfvars</code>â€‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚terraform.tfvars</p><p>Terraformèƒ½è‡ªåŠ¨æ‰¾åˆ°<code>tfvars</code>â€‹å¹¶è¯†åˆ«ä¸ºå˜é‡æ–‡ä»¶</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627091135-d3dfmv2.png" alt="image">â€‹</p><p>â€</p><p>æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform apply</span><br></pre></td></tr></table></figure><p>â€</p><p>æ­¤æ—¶ä¸éœ€è¦é¢å¤–è¾“å…¥å˜é‡çš„å€¼ï¼ŒTerraformä¼šè‡ªåŠ¨æ‰¾åˆ°å˜é‡å¹¶ä¸”èµ‹å€¼</p><p>â€</p><p>æ¨èæŠŠå˜é‡æ–‡ä»¶æ ¹æ®ç¯å¢ƒæ¥å‘½å</p><p>ä¾‹å¦‚ terraform-dev.tfvars</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627091655-ofb3joh.png" alt="image">â€‹</p><p>æŒ‡å®šå˜é‡æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform apply -var-file terraform-dev.tfvars</span><br></pre></td></tr></table></figure><p>â€</p><h2 id="AWS-Credential"><a href="#AWS-Credential" class="headerlink" title="AWS Credential"></a>AWS Credential</h2><p>ä¸æ¨èä»¥ä¸‹æ–¹å¼æ˜æ–‡å†™å…¥access key</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">provider &quot;aws&quot; &#123;</span><br><span class="line">    region = &quot;eu-west-3&quot; # å–å†³äºè´­ä¹°çš„EC2å®ä¾‹æ‰€å±çš„åŒºåŸŸ</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">    ä¸æ¨èhardcodeæ˜æ–‡çš„key</span><br><span class="line">    **/</span><br><span class="line">    access_key = &quot;&quot;</span><br><span class="line">    secret_key = &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>1.å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡çš„æ–¹å¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export AWS_SECRET_ACCESS = &quot;XXXX&quot;</span><br><span class="line">export AWS_ACCESS_KEY_ID = &quot;XXXX&quot;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç„¶åç›´æ¥æ‰§è¡Œterraformå‘½ä»¤ï¼Œä¼šè‡ªåŠ¨è¿æ¥åˆ°AWS</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627212211-b63szv1.png" alt="image">â€‹</p><p>â€</p><p>2.åœ¨æ–‡ä»¶ä¸­å­˜å‚¨ä»¥ä¾¿å…¨å±€è°ƒç”¨</p><p>å­˜å‚¨ä½ç½®ï¼š <code>~/.aws/credentials</code>â€‹</p><p>å¯ä»¥ç›´æ¥è¾“å…¥ aws configureè¿›è¡Œé…ç½®ï¼Œè‡ªåŠ¨å­˜å‚¨åˆ° <code>~/.aws/credentials</code>â€‹</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627212506-aehf3ue.png" alt="image">â€‹</p><p>â€</p><p>ä¹Ÿå¯ä»¥è®¾ç½®AWS_DEFAULT_REGIONæŒ‡å®šé»˜è®¤çš„åŒºåŸŸ</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627212919-krbqr1f.png" alt="image">â€‹</p><p>â€</p><p>3.å¯ä»¥é€šè¿‡å®‰è£…adfsç™»å½•AWS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python install adf-assume</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œä»¥ä¸‹è„šæœ¬ä¸€é”®è¿æ¥åˆ°AWS</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">source [python_env]</span><br><span class="line">echo -n &quot;Input AWS password: &quot;</span><br><span class="line">read -s AWS_PASSWORD</span><br><span class="line">export AWS_PROFILE=saml</span><br><span class="line">adfs-assume -u $ACCOUNT --domain=$DOMAIN</span><br></pre></td></tr></table></figure><h2 id="Global-Variable"><a href="#Global-Variable" class="headerlink" title="Global Variable"></a>Global Variable</h2><p>å‘½åè§„åˆ™å¿…é¡»ä¸ºï¼š<code>TF_VAR_xxx</code>â€‹</p><p>â€</p><p>ä¾‹å¦‚ï¼Œéœ€è¦å¼•ç”¨æ“ä½œç³»ç»Ÿå½“å‰ç¯å¢ƒä¸‹çš„æŸä¸ªå˜é‡</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627213207-7vyobna.png" alt="image">â€‹</p><p>åœ¨Terraformä¸­å¼•ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">variable avail_zone &#123;&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">resource &quot;aws_subnet&quot; &quot;dev-subnet-1&quot; &#123;</span><br><span class="line">  availability_zone = var.avail_zone</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œç»“æœ</p><p>å¯ä»¥çœ‹åˆ°è‡ªåŠ¨è¯†åˆ«åˆ°äº†å˜é‡ avail_zone è‡ªåŠ¨åŒ¹é…åˆ°äº† TF_VAR_avail_zone</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240627213338-wu1puwy.png" alt="image">â€‹</p><p>â€</p><h2 id="Terraform-Module"><a href="#Terraform-Module" class="headerlink" title="Terraform Module"></a>Terraform Module</h2><p>é€šè¿‡æ¨¡å—çš„æ–¹å¼ç¼–å†™ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰çš„ä»£ç éƒ½æ”¾åœ¨åŒä¸€ä¸ª<code>tf</code>â€‹æ–‡ä»¶ä¸­</p><p>ä¸€ä¸ªmoduleåº”è¯¥å°†å¤šä¸ªresourceæ•´åˆèµ·æ¥ï¼Œæ–¹ä¾¿ç›¸åŒçš„ç»„ä»¶é‡ç”¨</p><p>ä¾‹å¦‚VPCã€Subnetã€Route tableã€Internate gatewayéƒ½åº”è¯¥æ”¾åˆ°åŒä¸€ä¸ªmoduleä¸­ï¼Œæ–¹ä¾¿åˆ›å»ºEC2æ—¶ç›´æ¥è°ƒç”¨</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240629160704-lusjo4f.png" alt="image">â€‹</p><p>â€</p><p>åŒæ—¶Terraformä¹Ÿæœ‰ä¸€äº›ç°æˆçš„moduleæ–¹ä¾¿å‚è€ƒï¼Œä¸éœ€è¦é‡å¤åˆ›é€ åŠŸèƒ½ç›¸åŒçš„æ¨¡å—</p><p><a href="https://registry.terraform.io/browse/modules">https://registry.terraform.io/browse/modules</a></p><p>â€</p><h2 id="Terraform-state"><a href="#Terraform-state" class="headerlink" title="Terraform state"></a>Terraform state</h2><p>Terraform planä¼šæ ¹æ®stateæ–‡ä»¶ç”Ÿæˆæ‰§è¡Œè®¡åˆ’</p><p>æœ€å¥½æŠŠ<code>tfstate</code>â€‹å­˜æ”¾èµ·æ¥è¿œç¨‹è®¿é—®ï¼Œç¡®ä¿Jenkinså’Œå›¢é˜Ÿæˆå‘˜æœ¬åœ°æ‰§è¡Œéƒ½èƒ½è¯»å–åˆ°æœ€æ–°çš„çŠ¶æ€</p><p>AWSå¯ä»¥ä½¿ç”¨S3å­˜å‚¨</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240629165547-mwpen00.png" alt="image">â€‹</p><p>â€</p><p>ä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºS3</span><br><span class="line">terraform &#123;</span><br><span class="line">  required_version = &quot;&gt;=0.12&quot;</span><br><span class="line">  backend &quot;s3&quot; &#123;</span><br><span class="line">    bucket = &quot;myapp-bucket&quot;</span><br><span class="line">    key = &quot;myapp/state.tfstate&quot;</span><br><span class="line">    region = &quot;eu-west-3&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>åœ¨åˆ›å»ºçš„æ—¶å€™ä¼šè¯¢é—®æ˜¯å¦æŠŠçŠ¶æ€å­˜å‚¨åˆ°S3<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240629170359-36haj4u.png" alt="image">â€‹</p><p>â€</p><p>æ­¤æ—¶stateæ–‡ä»¶å°†äº¤ç»™AWSæ§åˆ¶ï¼ŒJenkinså’Œå¼€å‘äººå‘˜æœ¬åœ°ä¼šè‡ªåŠ¨ä½¿ç”¨S3çš„stateæ–‡ä»¶</p><p>â€‹<img src="/2024/06/29/AWS-Terraform-Section3-Input-and-Output/image-20240629170604-2elttg6.png" alt="image">â€‹</p><p>â€</p><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤éªŒè¯ï¼Œä¸åŒçš„ç¯å¢ƒæ‰§è¡Œåº”è¯¥å¾—åˆ°ç›¸åŒçš„ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform state list</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€&lt;/p&gt;
&lt;h2 id=&quot;Terraform-output&quot;&gt;&lt;a href=&quot;#Terraform-output&quot; class=&quot;headerlink&quot; title=&quot;Terraform output&quot;&gt;&lt;/a&gt;Terraform output&lt;/h2&gt;&lt;p&gt;ç¤ºä¾‹&lt;/p</summary>
      
    
    
    
    <category term="AWS Terraform" scheme="http://example.com/categories/AWS-Terraform/"/>
    
    
    <category term="AWS" scheme="http://example.com/tags/AWS/"/>
    
  </entry>
  
  <entry>
    <title>AWS Terraform Section2 - VPC</title>
    <link href="http://example.com/2024/06/23/AWS-Terraform-Section2-VPC/"/>
    <id>http://example.com/2024/06/23/AWS-Terraform-Section2-VPC/</id>
    <published>2024-06-23T03:20:03.000Z</published>
    <updated>2024-06-30T02:29:24.441Z</updated>
    
    <content type="html"><![CDATA[<h2 id="VPC-Subnet"><a href="#VPC-Subnet" class="headerlink" title="VPC &amp; Subnet"></a>VPC &amp; Subnet</h2><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621090538-0t4qsb0.png" alt="image">â€‹</p><p>â€</p><p>æ¯å½“ä¸€ä¸ªè´¦æˆ·åœ¨åŒºåŸŸåˆ›å»ºæ—¶ï¼Œéƒ½ä¼šæ‹¥æœ‰ä¸€ä¸ªAWS VPCï¼ˆVirtual Private Cloudï¼‰</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621090636-8pfda8m.png" alt="image">â€‹</p><p>â€</p><p>è·ŸéšåŒºåŸŸï¼Œè·ŸéšAWSè´¦æˆ·é»˜è®¤åˆ›å»ºï¼Œç”¨äºä¿æŠ¤æ¯ä¸ªè´¦æˆ·çš„ç§æœ‰èµ„æºè®¿é—®æƒé™</p><p>ä¾‹å¦‚ä¸åŒçš„è´¦æˆ·å¯èƒ½åˆ›å»ºåœ¨åŒä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯ä¸åŒçš„è´¦å·é—´çš„èµ„æºè®¿é—®æ˜¯äº’ç›¸éš”ç¦»çš„</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621091018-bj1wwsq.png" alt="image">â€‹</p><p>â€</p><p>æ§åˆ¶å°å¯ä»¥çœ‹åˆ°é»˜è®¤åˆ›å»ºçš„VPC</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621090729-glyury5.png" alt="image">â€‹</p><p>â€</p><p>VPCä»£è¡¨äº†å…¬å¸çš„ç½‘ç»œæ¶æ„ï¼ŒåŒ…æ‹¬ç½‘ç»œé…ç½®ã€è·¯ç”±ã€é˜²ç«å¢™ç­‰</p><p>VPCç”±ä¸åŒçš„<code>Availability Zone</code>â€‹ç»„æˆï¼Œå…·ä½“æŒ‡ä»£å®é™…çš„ç‰©ç†æœåŠ¡å™¨æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒ</p><p>ä¾‹å¦‚ æˆ‘åœ¨ä¸­å›½åŒºï¼Œå¯èƒ½ä¼šæœ‰åå—ã€åä¸­ã€ååŒ—3ä¸ªæ•°æ®ä¸­å¿ƒéƒ½æœ‰è™šæ‹ŸæœåŠ¡å™¨è¿è¡Œï¼Œé‚£ä¹ˆå°±ä¼šæœ‰3ä¸ª<code>Availability Zone</code>â€‹ï¼Œä¹Ÿå°±ä¼šæœ‰3ä¸ªsubnet</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621091717-r6rsa9e.png" alt="image">â€‹</p><p>â€</p><p>å½“æˆ‘ä»¬éœ€è¦ä»å¤–éƒ¨è®¿é—®èµ„æºæ—¶ï¼Œéœ€è¦é…ç½®ä¸€ä¸ªå…¬å…±IPåœ°å€ï¼Œå¯ä»¥ä½¿ç”¨<code>Internet Gateway</code>â€‹</p><p>å½“æˆ‘ä»¬éœ€è¦æ§åˆ¶å¤–éƒ¨å¯¹VPCè®¿é—®æƒé™ï¼Œå¯ä»¥é…ç½®é˜²ç«å¢™</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621092301-v45hvvl.png" alt="image">â€‹</p><p>â€</p><h3 id="é…ç½®å¤–éƒ¨è®¿é—®"><a href="#é…ç½®å¤–éƒ¨è®¿é—®" class="headerlink" title="é…ç½®å¤–éƒ¨è®¿é—®"></a>é…ç½®å¤–éƒ¨è®¿é—®</h3><p>è®¾ç½®é˜²ç«å¢™è§„åˆ™å’Œå®‰å…¨ç»„</p><p>VPC -&gt; SECURITY</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240621092558-4chx80a.png" alt="image">â€‹</p><p>â€</p><h2 id="æ·»åŠ VPCèµ„æº"><a href="#æ·»åŠ VPCèµ„æº" class="headerlink" title="æ·»åŠ VPCèµ„æº"></a>æ·»åŠ VPCèµ„æº</h2><p>èµ„æºå‘½åè§„åˆ™:  aws_[resource_name]</p><p>â€</p><p>æ‰€æœ‰çš„è¯­æ³•ç¤ºä¾‹éƒ½èƒ½åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°</p><p><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc</a></p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623100755-9y6u10a.png" alt="image">â€‹</p><p>â€</p><p>ä»£ç ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">provider &quot;aws&quot; &#123;</span><br><span class="line">    region = &quot;eu-west-3&quot; # å–å†³äºè´­ä¹°çš„EC2å®ä¾‹æ‰€å±çš„åŒºåŸŸ</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">    ä¸æ¨èhardcodeæ˜æ–‡çš„key</span><br><span class="line">    **/</span><br><span class="line">    access_key = &quot;&quot;</span><br><span class="line">    secret_key = &quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># èµ„æºå‘½åè§„åˆ™ - aws_resource</span><br><span class="line"># åˆ›å»ºåä¸º development-vpcçš„VPC</span><br><span class="line">resource &quot;aws_pvc&quot; &quot;development-vpc&quot; &#123;</span><br><span class="line"></span><br><span class="line">    # VPCåœ°å€èŒƒå›´</span><br><span class="line">    cider_block = &quot;10.0.0.0/16&quot;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºåä¸º dev-subnet-1 çš„subnet</span><br><span class="line">resource &quot;aws_subnet&quot; &quot;dev-subnet-1&quot; &#123;</span><br><span class="line">    # æŒ‡å®šsubnetæ‰€å±çš„VPC</span><br><span class="line">    # ç›®å‰VPCè¿˜æ²¡åˆ›å»ºï¼Œæ‰€ä»¥éœ€è¦åŠ¨æ€å¼•ç”¨å®šä¹‰çš„èµ„æº</span><br><span class="line">    vpc_id = aws_pvc.development-vpc.id</span><br><span class="line"></span><br><span class="line">    # å®šä¹‰VPCåœ°å€èŒƒå›´çš„å­é›†</span><br><span class="line">    cidr_block = &quot;10.0.10.0/24&quot;</span><br><span class="line"></span><br><span class="line">    availability_zone = &quot;eu-west-3a&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>é€šè¿‡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åº”ç”¨åˆ°AWS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform apply</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œå‘½ä»¤ä»¥åå¯ä»¥é¢„è§ˆterraformçš„æ‰§è¡Œè®¡åˆ’ï¼Œç„¶åè¾“å…¥<code>yes</code>â€‹ç¡®è®¤è¯¥è®¡åˆ’</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623101644-fx9ybbf.png" alt="image">â€‹</p><p>â€</p><h3 id="DataSource"><a href="#DataSource" class="headerlink" title="DataSource"></a>DataSource</h3><p>å‡å¦‚æˆ‘ä»¬éœ€è¦ä»å·²æœ‰çš„VPCä¸­åˆ›å»ºsubnetï¼Œåˆ™éœ€è¦å…ˆæ‹‰å–AWSå·²æœ‰çš„VPCä¿¡æ¯ï¼Œç„¶åå¼•ç”¨å…¶id</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623102401-7sfq2ts.png" alt="image">â€‹</p><p>â€</p><p>ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># æ‹‰å–awsæ•°æ®</span><br><span class="line"># å®šä¹‰å˜é‡åä¸º existing_vpc çš„vpcæ•°æ®æº</span><br><span class="line">data &quot;aws_vpc&quot; &quot;existing_vpc&quot; &#123;</span><br><span class="line"></span><br><span class="line">    # æ‹‰å–é»˜è®¤çš„vpc</span><br><span class="line">    default = true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºåä¸º dev-subnet-1 çš„subnet</span><br><span class="line">resource &quot;aws_subnet&quot; &quot;dev-subnet-2&quot; &#123;</span><br><span class="line">    # ä»å·²æœ‰çš„vpcä¸­è·å–id</span><br><span class="line">    vpc_id = data.aws_vpc.existing_vpc.id</span><br><span class="line"></span><br><span class="line">    # å®šä¹‰VPCåœ°å€èŒƒå›´çš„å­é›†</span><br><span class="line">    # ä¸åº”ä¸vpcä¸­çš„å·²æœ‰subnet ipèŒƒå›´é‡å¤</span><br><span class="line">    cidr_block = &quot;172.31.48.0/20&quot;</span><br><span class="line"></span><br><span class="line">    availability_zone = &quot;eu-west-3a&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œ terraform apply</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623103153-6tu25vy.png" alt="image">â€‹</p><p>â€</p><h2 id="ä¿®æ”¹-åˆ é™¤èµ„æº"><a href="#ä¿®æ”¹-åˆ é™¤èµ„æº" class="headerlink" title="ä¿®æ”¹ &amp; åˆ é™¤èµ„æº"></a>ä¿®æ”¹ &amp; åˆ é™¤èµ„æº</h2><p>ç»§ç»­ä»¥AWS VPCä¸ºä¾‹</p><h3 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h3><p>ä½¿ç”¨å…³é”®å­—<code>tags</code>â€‹ï¼Œå®ƒå­˜åœ¨äºæ‰€æœ‰çš„èµ„æºä¸­</p><p>ä¾‹å¦‚ï¼ŒæŒ‡å®šVPCåç§°</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623104620-e98o9gy.png" alt="image">â€‹</p><p>åœ¨åº”ç”¨tfæ–‡ä»¶çš„æ—¶å€™ï¼Œ<code>~</code>â€‹ä»£è¡¨èµ„æºä¿®æ”¹ï¼Œ<code>+</code>â€‹ä»£è¡¨æ–°å¢</p><p>å¹¶ä¸”åœ¨æ‰§è¡Œè®¡åˆ’ä¸­æœ‰8ä¸ªå±æ€§ä¿æŒä¸å˜</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623105005-f2r9sza.png" alt="image">â€‹</p><p>â€</p><p>å°†ä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºåç§°</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623104640-82dkf08.png" alt="image">â€‹</p><p>â€</p><p>å¦‚æœåˆ é™¤æ‰<code>tags</code>â€‹ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œè®¡åˆ’ä¸­ä¼šä»¥<code>-</code>â€‹æ˜¾ç¤º</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623105243-u2uvsfs.png" alt="image">â€‹</p><p>â€</p><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><h4 id="ä¿®æ”¹tf"><a href="#ä¿®æ”¹tf" class="headerlink" title="ä¿®æ”¹tf"></a>ä¿®æ”¹tf</h4><p> *<strong>æ¨èä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œé…ç½®æ–‡ä»¶æ–¹ä¾¿ä»£ç ç®¡ç†</strong></p><p>å¦‚æœæŠŠ<code>*.tf</code>â€‹ä¸­çš„subnetåˆ é™¤ï¼Œæ‰§è¡Œ terraform applyï¼Œåˆ™æ„å‘³ç€åˆ é™¤è¯¥subnet</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623105535-ysouex2.png" alt="image">â€‹</p><p>â€</p><p>æ‰§è¡Œè®¡åˆ’å¦‚ä¸‹</p><p>å¯ä»¥çœ‹åˆ°æ•´ä¸ªèµ„æºéƒ½æ ‡æœ‰<code>-</code>â€‹ï¼Œå› ä¸ºè¿™ä¸ªèµ„æºå³å°†è¢«åˆ é™¤</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623105738-ldw0dxg.png" alt="image">â€‹</p><p>â€</p><h4 id="terraform-destroy"><a href="#terraform-destroy" class="headerlink" title="terraform destroy"></a>terraform destroy</h4><p>æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform destroy -target [resource_type] [resource_name]</span><br></pre></td></tr></table></figure><p>â€</p><p>ä¾‹å¦‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform destroy -target aws_subnet dev-subnet-2</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œè®¡åˆ’ä¹Ÿæ˜¯ç±»ä¼¼çš„</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623110048-4j3479w.png" alt="image">â€‹</p><p>â€</p><h2 id="å¯¹æ¯”å·®å¼‚"><a href="#å¯¹æ¯”å·®å¼‚" class="headerlink" title="å¯¹æ¯”å·®å¼‚"></a>å¯¹æ¯”å·®å¼‚</h2><p>æ£€æŸ¥awså’Œtfæ–‡ä»¶çš„å·®å¼‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform plan</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623110453-hpt2fxs.png" alt="image">â€‹</p><p>â€</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>provider: ç”¨äºå¯¼å…¥ä¸€ç»„æˆ–ä¸€æ®µä»£ç ï¼Œç±»ä¼¼import library</li><li>resource: ç±»ä¼¼äºä»åº“ä¸­è°ƒç”¨ä¸€æ®µå‡½æ•°</li><li>data: ç±»ä¼¼äºè¿”å›å·²ç»å­˜åœ¨çš„èµ„æºçš„å‡½æ•°</li></ul><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623103603-vixezkm.png" alt="image">â€‹</p><p>â€</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ç”¨æˆ·å¿…é¡»å…·æœ‰åˆ›å»ºèµ„æºæ‰€å¿…é¡»çš„æƒé™<img src="/2024/06/23/AWS-Terraform-Section2-VPC/image-20240623103705-nm2hmts.png" alt="image">â€‹</p><p>â€</p><p>å¦å¤–ï¼Œterraformåœ¨applyç›¸åŒçš„tfæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ£€æŸ¥æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€</p><p>å¦‚æœç»„ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™terraformä¸ä¼šå†æ‰§è¡Œæ“ä½œ</p><p>ä¹Ÿå°±æ˜¯è¯´æ¯å½“åº”ç”¨ç›¸åŒçš„é…ç½®æ—¶ï¼Œæ€»ä¼šå¾—åˆ°ä¸€æ ·çš„ç»“æœã€‚ç”¨æˆ·ä¸éœ€è¦è®°ä½å½“å‰ç»„ä»¶çš„çŠ¶æ€ï¼Œä¹Ÿä¸ä¼šæ„å¤–åœ°ç ´åæŸäº›åŸæœ‰çš„ç»„ä»¶ã€‚</p><p>â€</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;VPC-Subnet&quot;&gt;&lt;a href=&quot;#VPC-Subnet&quot; class=&quot;headerlink&quot; title=&quot;VPC &amp;amp; Subnet&quot;&gt;&lt;/a&gt;VPC &amp;amp; Subnet&lt;/h2&gt;&lt;p&gt;â€‹&lt;img src=&quot;/2024/06/23/AWS</summary>
      
    
    
    
    <category term="AWS Terraform" scheme="http://example.com/categories/AWS-Terraform/"/>
    
    
    <category term="AWS" scheme="http://example.com/tags/AWS/"/>
    
  </entry>
  
  <entry>
    <title>AWS Terraform Section1 - ç®€ä»‹</title>
    <link href="http://example.com/2024/06/23/AWS-Terraform-Section1/"/>
    <id>http://example.com/2024/06/23/AWS-Terraform-Section1/</id>
    <published>2024-06-23T03:13:21.000Z</published>
    <updated>2024-06-30T02:31:47.218Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å®˜ç½‘ <a href="https://developer.hashicorp.com/terraform/intro">https://developer.hashicorp.com/terraform/intro</a></p><p>Infrastructure as Code tool.</p><p>Terraformæœ¬è´¨ä¸Šæ˜¯é€šè¿‡è°ƒç”¨APIå®ç°å¯¹å„ç§æœåŠ¡å™¨èµ„æºçš„CRUDæ“ä½œã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621083744-cph8xt3.png" alt="image">â€‹</p><p>Terraformä¸»è¦æ˜¯ç”¨äºæ¶æ„çš„ç¼–æ’ï¼Œè­¬å¦‚åˆ›å»ºEC2ï¼Œè®¾ç½®VPCï¼Œå®‰è£…dockerç­‰ï¼Œè€Œä¸”å…¶ä¸­çš„é¡ºåºå¿…é¡»è¦éµå¾ªä¸€å®šçš„é¡ºåºã€‚</p><p>å¦ä¸€ä¸ªIaCå·¥å…·æ˜¯Ansibleã€‚Ansibleå¯ä»¥ç”¨æ¥é…ç½®åŸºç¡€è®¾ç½®ã€éƒ¨ç½²åº”ç”¨ã€å®‰è£…å’Œæ›´æ–°åº”ç”¨ç­‰</p><p>Terraformåˆ›å»ºå¹¶æµ‹è¯•å®Œåï¼Œå¯ä»¥ç²¾ç¡®è‡ªåŠ¨åŒ–åœ°å¤åˆ¶æ›´å¤šçš„ç¯å¢ƒã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617213010-g7rnt9g.png" alt="image">â€‹</p><p>â€<img src="/2024/06/23/AWS-Terraform-Section1/image-20240629153340-5rpwr4n.png" alt="image">â€‹</p><p>â€</p><h2 id="å®‰è£…Terraform"><a href="#å®‰è£…Terraform" class="headerlink" title="å®‰è£…Terraform"></a>å®‰è£…Terraform</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install terraform</span><br></pre></td></tr></table></figure><p>â€</p><p>æŸ¥çœ‹Terraformç‰ˆæœ¬å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform -v</span><br></pre></td></tr></table></figure><p>â€</p><p>å®‰è£…ç»“æœå¦‚ä¸‹</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617213642-gi9trte.png" alt="image">â€‹</p><p>â€</p><h2 id="åˆå§‹åŒ–AWSç¯å¢ƒ"><a href="#åˆå§‹åŒ–AWSç¯å¢ƒ" class="headerlink" title="åˆå§‹åŒ–AWSç¯å¢ƒ"></a>åˆå§‹åŒ–AWSç¯å¢ƒ</h2><ul><li>è¿æ¥åˆ°AWSè´¦æˆ·</li><li>åˆ›å»ºVPC</li><li>åˆ›å»ºSubnet</li></ul><h3 id="æœ¬åœ°ç¯å¢ƒè®¾ç½®"><a href="#æœ¬åœ°ç¯å¢ƒè®¾ç½®" class="headerlink" title="æœ¬åœ°ç¯å¢ƒè®¾ç½®"></a>æœ¬åœ°ç¯å¢ƒè®¾ç½®</h3><p>åˆ›å»ºåä¸º<code>Terraformed</code>â€‹çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºæ–‡ä»¶<code>main.tf</code>â€‹</p><p>â€‹<code>*.tf</code>â€‹æ˜¯Terraformæ–‡ä»¶çš„æ ‡å‡†å‘½åæ–¹å¼</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617214824-h3zyfo9.png" alt="image">â€‹</p><p>â€</p><p>ä½¿ç”¨Visual Studio Codeæ‰“å¼€<code>main.tf</code>â€‹ï¼Œå¹¶ä¸”å®‰è£…Terraformå®˜æ–¹æ’ä»¶ã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617215049-jdiqpkh.png" alt="image">â€‹</p><p>â€</p><p>å®‰è£…å®Œæ’ä»¶ä»¥åå¯ä»¥åœ¨VS Codeä¸­æ›´æ–¹ä¾¿åœ°ç¼–è¾‘Terraformæ–‡ä»¶</p><p>â€</p><h3 id="æ³¨å†ŒAWSäº‘è´¦å·"><a href="#æ³¨å†ŒAWSäº‘è´¦å·" class="headerlink" title="æ³¨å†ŒAWSäº‘è´¦å·"></a>æ³¨å†ŒAWSäº‘è´¦å·</h3><p>æ³¨å†Œå®Œæ¯•åå¯ä»¥å…è´¹ä½¿ç”¨AWSäº‘è®¡ç®—èµ„æº</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617215341-n63hg26.png" alt="image">â€‹</p><p>â€</p><p>æ³¨å†Œå®Œæ¯•åä¼šè‡ªåŠ¨åˆ›å»ºrootç”¨æˆ·ï¼Œæ­¤æ—¶åº”è¯¥é€šè¿‡IAMåˆ›å»ºä¸€ä¸ªæƒé™è¾ƒä½çš„ç®¡ç†å‘˜è´¦æˆ·ï¼Œå¹¶é€šè¿‡ç®¡ç†å‘˜è´¦æˆ·ç®¡ç†æ™®é€šè´¦æˆ·ã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621082633-pze0qoe.png" alt="image">â€‹</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621082734-ltw8n4d.png" alt="image">â€‹</p><p>æ·»åŠ groupæˆ–è€…é€‰æ‹©â€Attach existing policies directlyâ€å‹¾é€‰éœ€è¦èµ‹äºˆçš„æƒé™</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621082909-kl5bllb.png" alt="image">â€‹</p><p>â€</p><h3 id="Terraformè¿æ¥åˆ°AWS"><a href="#Terraformè¿æ¥åˆ°AWS" class="headerlink" title="Terraformè¿æ¥åˆ°AWS"></a>Terraformè¿æ¥åˆ°AWS</h3><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621083520-o2agtmi.png" alt="image">â€‹</p><p>â€</p><p>Providersä½œä¸ºTerraformä¸­æœ€é‡è¦çš„å…³é”®å­—ï¼Œç”¨äºæ ‡è¯†éœ€è¦è°ƒç”¨çš„è¿œç¨‹äº‘æœåŠ¡ä¾›åº”å•†API</p><p>Providersåˆ—è¡¨å¦‚ä¸‹ï¼Œæ”¯æŒè®¸å¤šçš„äº‘æœåŠ¡ä¾›åº”å•†</p><p>æ”¯æŒçš„èµ„æºä¾›åº”å•†åˆ—è¡¨ <a href="https://registry.terraform.io/browse/providers">https://registry.terraform.io/browse/providers</a></p><p>åŒ…æ‹¬äº‘æœåŠ¡ã€Devopså·¥å…·(Ansibleã€Githubã€Grafanaã€Jenkinsã€Kubernetes â€¦)ç­‰</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621084141-ejuxa61.png" alt="image">â€‹</p><p>â€</p><p>é€šè¿‡ä»¥ä¸‹*.tfæ–‡ä»¶ï¼Œå°†ä»¥ç¼–ç¨‹çš„æ–¹å¼è¿æ¥åˆ°AWSæœåŠ¡</p><p>AWSè¯­æ³•å’Œæºç ç¤ºä¾‹</p><p><a href="https://registry.terraform.io/providers/hashicorp/aws/latest">https://registry.terraform.io/providers/hashicorp/aws/latest</a></p><p><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs">https://registry.terraform.io/providers/hashicorp/aws/latest/docs</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">provider &quot;aws&quot; &#123;</span><br><span class="line">    region = &quot;eu-west-3&quot; # å–å†³äºè´­ä¹°çš„EC2å®ä¾‹æ‰€å±çš„åŒºåŸŸ</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">    ä¸æ¨èhardcodeæ˜æ–‡çš„key</span><br><span class="line">    **/</span><br><span class="line">    access_key = &quot;&quot;</span><br><span class="line">    secret_key = &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>*.tfæ–‡ä»¶æ˜¯ä¸€ä¸ªå®šä¹‰æ–‡ä»¶ï¼Œç¼–å†™å®Œæ¯•åéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ç›¸åº”çš„ä¾èµ–(ç±»ä¼¼npm&#x2F;maven instal)</p><p>è¿›å…¥<code>*.tf</code>â€‹æ‰€åœ¨çš„æ–‡ä»¶å¤¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform init</span><br></pre></td></tr></table></figure><p>â€</p><p>è¿è¡Œç»“æœ</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621090125-g8a8waj.png" alt="image">â€‹</p><p>â€</p><p>å¯ä»¥çœ‹åˆ°æ–°æ–‡ä»¶ç”Ÿæˆ</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621090308-ajssusd.png" alt="image">â€‹</p><p>â€</p><h3 id="æŸ¥çœ‹terraformçŠ¶æ€"><a href="#æŸ¥çœ‹terraformçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹terraformçŠ¶æ€"></a>æŸ¥çœ‹terraformçŠ¶æ€</h3><p>æ‰§è¡Œ terraaform stateï¼Œä»¥ç”Ÿæˆ<code>tfstate</code>â€‹æ–‡ä»¶</p><p>è¯¥æ–‡ä»¶å¯ä»¥è®°å½•å½“å‰terraformèµ„æºçš„çŠ¶æ€åˆ—è¡¨</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240627084650-6jzruh4.png" alt="image">â€‹</p><p>â€</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240627084208-hc9n0md.png" alt="image">â€‹</p><p>â€</p><p>terraform stateçš„å­å‘½ä»¤</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240627084312-2xv492o.png" alt="image">â€‹</p><p>â€</p><h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å®˜ç½‘ <a href="https://developer.hashicorp.com/terraform/intro">https://developer.hashicorp.com/terraform/intro</a></p><p>Infrastructure as Code tool.</p><p>Terraformæœ¬è´¨ä¸Šæ˜¯é€šè¿‡è°ƒç”¨APIå®ç°å¯¹å„ç§æœåŠ¡å™¨èµ„æºçš„CRUDæ“ä½œã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621083744-cph8xt3.png" alt="image">â€‹</p><p>Terraformä¸»è¦æ˜¯ç”¨äºæ¶æ„çš„ç¼–æ’ï¼Œè­¬å¦‚åˆ›å»ºEC2ï¼Œè®¾ç½®VPCï¼Œå®‰è£…dockerç­‰ï¼Œè€Œä¸”å…¶ä¸­çš„é¡ºåºå¿…é¡»è¦éµå¾ªä¸€å®šçš„é¡ºåºã€‚</p><p>å¦ä¸€ä¸ªIaCå·¥å…·æ˜¯Ansibleã€‚Ansibleå¯ä»¥ç”¨æ¥é…ç½®åŸºç¡€è®¾ç½®ã€éƒ¨ç½²åº”ç”¨ã€å®‰è£…å’Œæ›´æ–°åº”ç”¨ç­‰</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617213010-g7rnt9g.png" alt="image">â€‹</p><p>â€</p><p>Terraformåˆ›å»ºå¹¶æµ‹è¯•å®Œåï¼Œå¯ä»¥ç²¾ç¡®è‡ªåŠ¨åŒ–åœ°å¤åˆ¶æ›´å¤šçš„ç¯å¢ƒã€‚</p><p>â€</p><h2 id="å®‰è£…Terraform-1"><a href="#å®‰è£…Terraform-1" class="headerlink" title="å®‰è£…Terraform"></a>å®‰è£…Terraform</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install terraform</span><br></pre></td></tr></table></figure><p>â€</p><p>æŸ¥çœ‹Terraformç‰ˆæœ¬å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform -v</span><br></pre></td></tr></table></figure><p>â€</p><p>å®‰è£…ç»“æœå¦‚ä¸‹</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617213642-gi9trte.png" alt="image">â€‹</p><p>â€</p><h2 id="åˆå§‹åŒ–AWSç¯å¢ƒ-1"><a href="#åˆå§‹åŒ–AWSç¯å¢ƒ-1" class="headerlink" title="åˆå§‹åŒ–AWSç¯å¢ƒ"></a>åˆå§‹åŒ–AWSç¯å¢ƒ</h2><ul><li>è¿æ¥åˆ°AWSè´¦æˆ·</li><li>åˆ›å»ºVPC</li><li>åˆ›å»ºSubnet</li></ul><h3 id="æœ¬åœ°ç¯å¢ƒè®¾ç½®-1"><a href="#æœ¬åœ°ç¯å¢ƒè®¾ç½®-1" class="headerlink" title="æœ¬åœ°ç¯å¢ƒè®¾ç½®"></a>æœ¬åœ°ç¯å¢ƒè®¾ç½®</h3><p>åˆ›å»ºåä¸º<code>Terraformed</code>â€‹çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºæ–‡ä»¶<code>main.tf</code>â€‹</p><p>â€‹<code>*.tf</code>â€‹æ˜¯Terraformæ–‡ä»¶çš„æ ‡å‡†å‘½åæ–¹å¼</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617214824-h3zyfo9.png" alt="image">â€‹</p><p>â€</p><p>ä½¿ç”¨Visual Studio Codeæ‰“å¼€<code>main.tf</code>â€‹ï¼Œå¹¶ä¸”å®‰è£…Terraformå®˜æ–¹æ’ä»¶ã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617215049-jdiqpkh.png" alt="image">â€‹</p><p>â€</p><p>å®‰è£…å®Œæ’ä»¶ä»¥åå¯ä»¥åœ¨VS Codeä¸­æ›´æ–¹ä¾¿åœ°ç¼–è¾‘Terraformæ–‡ä»¶</p><p>â€</p><h3 id="æ³¨å†ŒAWSäº‘è´¦å·-1"><a href="#æ³¨å†ŒAWSäº‘è´¦å·-1" class="headerlink" title="æ³¨å†ŒAWSäº‘è´¦å·"></a>æ³¨å†ŒAWSäº‘è´¦å·</h3><p>æ³¨å†Œå®Œæ¯•åå¯ä»¥å…è´¹ä½¿ç”¨AWSäº‘è®¡ç®—èµ„æº</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240617215341-n63hg26.png" alt="image">â€‹</p><p>â€</p><p>æ³¨å†Œå®Œæ¯•åä¼šè‡ªåŠ¨åˆ›å»ºrootç”¨æˆ·ï¼Œæ­¤æ—¶åº”è¯¥é€šè¿‡IAMåˆ›å»ºä¸€ä¸ªæƒé™è¾ƒä½çš„ç®¡ç†å‘˜è´¦æˆ·ï¼Œå¹¶é€šè¿‡ç®¡ç†å‘˜è´¦æˆ·ç®¡ç†æ™®é€šè´¦æˆ·ã€‚</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621082633-pze0qoe.png" alt="image">â€‹</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621082734-ltw8n4d.png" alt="image">â€‹</p><p>æ·»åŠ groupæˆ–è€…é€‰æ‹©â€Attach existing policies directlyâ€å‹¾é€‰éœ€è¦èµ‹äºˆçš„æƒé™</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621082909-kl5bllb.png" alt="image">â€‹</p><p>â€</p><h3 id="Terraformè¿æ¥åˆ°AWS-1"><a href="#Terraformè¿æ¥åˆ°AWS-1" class="headerlink" title="Terraformè¿æ¥åˆ°AWS"></a>Terraformè¿æ¥åˆ°AWS</h3><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621083520-o2agtmi.png" alt="image">â€‹</p><p>â€</p><p>Providersä½œä¸ºTerraformä¸­æœ€é‡è¦çš„å…³é”®å­—ï¼Œç”¨äºæ ‡è¯†éœ€è¦è°ƒç”¨çš„è¿œç¨‹äº‘æœåŠ¡ä¾›åº”å•†API</p><p>Providersåˆ—è¡¨å¦‚ä¸‹ï¼Œæ”¯æŒè®¸å¤šçš„äº‘æœåŠ¡ä¾›åº”å•†</p><p>æ”¯æŒçš„èµ„æºä¾›åº”å•†åˆ—è¡¨ <a href="https://registry.terraform.io/browse/providers">https://registry.terraform.io/browse/providers</a></p><p>åŒ…æ‹¬äº‘æœåŠ¡ã€Devopså·¥å…·(Ansibleã€Githubã€Grafanaã€Jenkinsã€Kubernetes â€¦)ç­‰</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621084141-ejuxa61.png" alt="image">â€‹</p><p>â€</p><p>é€šè¿‡ä»¥ä¸‹*.tfæ–‡ä»¶ï¼Œå°†ä»¥ç¼–ç¨‹çš„æ–¹å¼è¿æ¥åˆ°AWSæœåŠ¡</p><p>AWSè¯­æ³•å’Œæºç ç¤ºä¾‹</p><p><a href="https://registry.terraform.io/providers/hashicorp/aws/latest">https://registry.terraform.io/providers/hashicorp/aws/latest</a></p><p><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs">https://registry.terraform.io/providers/hashicorp/aws/latest/docs</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">provider &quot;aws&quot; &#123;</span><br><span class="line">    region = &quot;eu-west-3&quot; # å–å†³äºè´­ä¹°çš„EC2å®ä¾‹æ‰€å±çš„åŒºåŸŸ</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">    ä¸æ¨èhardcodeæ˜æ–‡çš„key</span><br><span class="line">    **/</span><br><span class="line">    access_key = &quot;&quot;</span><br><span class="line">    secret_key = &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>*.tfæ–‡ä»¶æ˜¯ä¸€ä¸ªå®šä¹‰æ–‡ä»¶ï¼Œç¼–å†™å®Œæ¯•åéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ç›¸åº”çš„ä¾èµ–(ç±»ä¼¼npm&#x2F;maven instal)</p><p>è¿›å…¥<code>*.tf</code>â€‹æ‰€åœ¨çš„æ–‡ä»¶å¤¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">terraform init</span><br></pre></td></tr></table></figure><p>â€</p><p>è¿è¡Œç»“æœ</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621090125-g8a8waj.png" alt="image">â€‹</p><p>â€</p><p>å¯ä»¥çœ‹åˆ°æ–°æ–‡ä»¶ç”Ÿæˆ</p><p>â€‹<img src="/2024/06/23/AWS-Terraform-Section1/image-20240621090308-ajssusd.png" alt="image">â€‹</p><p>â€</p><h2 id="Terraformå¸¸ç”¨å‘½ä»¤"><a href="#Terraformå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Terraformå¸¸ç”¨å‘½ä»¤"></a>Terraformå¸¸ç”¨å‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">terraform init       # åˆå§‹åŒ–terraformæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">terraform plan       # æ¯”å¯¹å½“å‰ç¯å¢ƒä¸tfæ–‡ä»¶çš„å·®å¼‚</span><br><span class="line"></span><br><span class="line">terraform apply      # å°†tfæ–‡ä»¶çš„è®¾ç½®åº”ç”¨åˆ°aws</span><br><span class="line"></span><br><span class="line">terraform destroy -target [resource_type] [resource_name]  # åˆ é™¤èµ„æº </span><br><span class="line"></span><br><span class="line">terraform apply -auto-approve  # æ— éœ€äºŒæ¬¡ç¡®è®¤ï¼Œç«‹å³åº”ç”¨tfé…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">terraform destroy    # åˆ é™¤å…¨éƒ¨åŸºç¡€è®¾æ–½</span><br><span class="line"></span><br><span class="line">terraform state      # ç”ŸæˆterraformçŠ¶æ€æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">terraform state list # tfstate æ˜¾ç¤ºæ–‡ä»¶ä¸­æ‰€æœ‰ç»„ä»¶</span><br><span class="line"></span><br><span class="line">terraform state show [ç»„ä»¶å]  # æ˜¾ç¤ºtfstateæ–‡ä»¶ä¸­æŸä¸ªç»„ä»¶çš„terraformå®Œæ•´è¯­æ³•</span><br><span class="line"></span><br><span class="line">terraform version    # æ˜¾ç¤ºterraformç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">terraform fmt        # æ ¼å¼åŒ–tfæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">terraform validate   # éªŒè¯terraformæ–‡ä»¶æ˜¯å¦æ­£ç¡®</span><br><span class="line"></span><br><span class="line">terraform show       # æŸ¥çœ‹terraformçŠ¶æ€</span><br><span class="line"></span><br><span class="line">terraform workspace  # ç®¡ç†terraformå·¥ä½œç©ºé—´</span><br><span class="line"></span><br><span class="line">terraform get        # ä¸‹è½½ &amp; å®‰è£…(æˆ–å‡çº§)æ¨¡å—</span><br><span class="line"></span><br><span class="line">terraform import     # å¯¼å…¥æ¨¡å—</span><br></pre></td></tr></table></figure><p>â€</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;å®˜ç½‘ &lt;a href=&quot;https://developer.hashicorp.com/terraform/intro&quot;&gt;https://d</summary>
      
    
    
    
    <category term="AWS Terraform" scheme="http://example.com/categories/AWS-Terraform/"/>
    
    
    <category term="AWS" scheme="http://example.com/tags/AWS/"/>
    
  </entry>
  
  <entry>
    <title>DRF Django å­¦ä¹ ç¬”è®°</title>
    <link href="http://example.com/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2024-06-16T13:34:18.000Z</published>
    <updated>2024-06-16T13:43:02.751Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®"><a href="#åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®" class="headerlink" title="åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®"></a>åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®</h2><p>å®‰è£…djanago</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Django==<span class="number">4.2</span><span class="number">.1</span></span><br></pre></td></tr></table></figure><p>â€</p><p>åˆ›å»ºé¡¹ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject [project_name]</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°é¡¹ç›®å·²ç»åˆ›å»º</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520212137-og7cyxd.png" alt="image">â€‹</p><p>â€</p><p>ç„¶ååœ¨pycharmæ‰“å¼€é¡¹ç›®</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520212307-dqj5svv.png" alt="image">â€‹</p><p>â€</p><p>é¡¹ç›®åŸºæœ¬ç»“æ„</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520212403-15sh3or.png" alt="image">â€‹</p><ul><li>wsgi.py - é…ç½®WSGIå…¼å®¹çš„WebæœåŠ¡ç«™ç‚¹</li><li>asgi.py - é…ç½®ASGIå…¼å®¹çš„WebæœåŠ¡ç«™ç‚¹</li><li>urls.py - é…ç½®ç«™ç‚¹è½¬å‘çš„è·¯å¾„</li><li>settings.py - Djangoé¡¹ç›®çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼ˆé‡è¦ï¼‰</li></ul><p>â€</p><p>æ·»åŠ é¡¹ç›®æ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp [module_app]</span><br></pre></td></tr></table></figure><p>â€</p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºç¬¬ä¸€ä¸ªæ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp first_module</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªæ¨¡å—å·²ç»åˆ›å»ºæˆåŠŸ</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520212725-g8y3rur.png" alt="image">â€‹</p><p>â€</p><p>æ·»åŠ åˆ°settings.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240524211817-438xeg9.png" alt="image">â€‹</p><p>â€</p><p>æ¨¡å—æ–‡ä»¶ç»“æ„</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520213459-e7qzjk5.png" alt="image">â€‹</p><ul><li>views.py - è§†å›¾å±‚ï¼Œç›¸å½“äºWebå¼€å‘ä¸­çš„Controllerã€‚ç”¨äºæ‹¦æˆªè¯·æ±‚ï¼Œè¿›è¡Œé€»è¾‘å¤„ç†å¹¶è¿”å›æ•°æ®</li><li>tests.py - ç”¨äºç¼–å†™æµ‹è¯•ç”¨ä¾‹</li><li>models.py - æ¨¡å‹å±‚ï¼Œç”¨äºå­˜æ”¾ä¸æ•°æ®åº“å®ä½“ç›¸å¯¹åº”çš„model</li><li>apps.py -</li><li>admin.py - ä¸€èˆ¬ä¸ç”¨</li></ul><p>â€</p><p>è¿è¡Œé¡¹ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver [port]</span><br></pre></td></tr></table></figure><p>â€</p><p>ä½¿ç”¨7000ç«¯å£å¯åŠ¨é¡¹ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver <span class="number">7000</span></span><br></pre></td></tr></table></figure><p>â€</p><p>æ§åˆ¶å°</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520214939-lfnc7qk.png" alt="image">â€‹</p><p>â€</p><p>è¾“å…¥URLè®¿é—® <a href="http://127.0.0.1:7000/">http://127.0.0.1:7000/</a></p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240520215022-tmwz4k0.png" alt="image">â€‹</p><p>â€</p><p>â€</p><h2 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h2><p>è¿æ¥MySQL</p><p>å…ˆå®‰è£…mysqlå®¢æˆ·ç«¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install mysqlclient</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯åŠ¨dockeræ•°æ®åº“</p><p>é€šè¿‡UIå¯åŠ¨</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240524210048-lomz4iw.png" alt="image">â€‹</p><p>æˆ–é€šè¿‡å‘½ä»¤å¯åŠ¨</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240524210149-3nlah8m.png" alt="image">â€‹</p><p>â€</p><p>settings.pyæ·»åŠ æ•°æ®åº“ä¿¡æ¯</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240525103915-lf2t7a9.png" alt="image">â€‹</p><p>å¦‚æœèƒ½æ­£å¸¸å¯åŠ¨åˆ™è¯´æ˜é…ç½®æˆåŠŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 manage.py runserver <span class="number">8000</span></span><br></pre></td></tr></table></figure><p>â€</p><h2 id="DRFå®ç°ç™»å½•åŠŸèƒ½"><a href="#DRFå®ç°ç™»å½•åŠŸèƒ½" class="headerlink" title="DRFå®ç°ç™»å½•åŠŸèƒ½"></a>DRFå®ç°ç™»å½•åŠŸèƒ½</h2><h3 id="DRFæ¦‚è¿°"><a href="#DRFæ¦‚è¿°" class="headerlink" title="DRFæ¦‚è¿°"></a>DRFæ¦‚è¿°</h3><p>DRF(Django rest framework) åŸºäºDjangoçš„å°è£…ï¼Œæ˜¯Restfulé£æ ¼çš„å¼€å‘æ¡†æ¶</p><p>å®˜æ–¹ç½‘ç«™ <a href="https://www.django-rest-framework.org/">https://www.django-rest-framework.org</a></p><p>â€</p><p>å®‰è£…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install djangorestframework</span><br></pre></td></tr></table></figure><p>â€</p><p>æ·»åŠ åˆ°settings.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240524211854-v56ns98.png" alt="image">â€‹</p><p>â€</p><h3 id="åˆ›å»ºuserå’Œitemæ¨¡å—"><a href="#åˆ›å»ºuserå’Œitemæ¨¡å—" class="headerlink" title="åˆ›å»ºuserå’Œitemæ¨¡å—"></a>åˆ›å»ºuserå’Œitemæ¨¡å—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp user</span><br><span class="line">python manage.py startapp item</span><br></pre></td></tr></table></figure><p>â€</p><p>æ·»åŠ åˆ°settings.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240525110511-tt1031h.png" alt="image">â€‹</p><p>â€</p><h3 id="æ•°æ®è¡¨è®¾è®¡"><a href="#æ•°æ®è¡¨è®¾è®¡" class="headerlink" title="æ•°æ®è¡¨è®¾è®¡"></a>æ•°æ®è¡¨è®¾è®¡</h3><p>Userè¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(models.Model):</span><br><span class="line">    <span class="built_in">id</span> = models.AutoField(primary_key=<span class="literal">True</span>, null=<span class="literal">False</span>, unique=<span class="literal">True</span>)</span><br><span class="line">    user_name = models.CharField(null=<span class="literal">False</span>, max_length=<span class="number">255</span>, unique=<span class="literal">True</span>)</span><br><span class="line">    is_delete = models.IntegerField()</span><br><span class="line">    password = models.CharField(null=<span class="literal">False</span>, max_length=<span class="number">255</span>, unique=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        db_table = <span class="string">&quot;user_tbl&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><p>Itemè¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table `item_tbl`(</span><br><span class="line">  `<span class="built_in">id</span>` <span class="built_in">int</span> NOT NULL AUTO_INCREMENT,</span><br><span class="line">`name` varchar(<span class="number">255</span>) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,</span><br><span class="line">`price` <span class="built_in">int</span> NULL DEFAULT NULL,</span><br><span class="line">`vendor_id` <span class="built_in">int</span> NULL DEFAULT NULL,</span><br><span class="line">PRIMARY KEY (`<span class="built_in">id</span>`) USING BTREE</span><br><span class="line">)ENGINE = InnoDB AUTO_INCREMENT = <span class="number">4894</span> CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci ROW_FORMAT = Dynamic;</span><br></pre></td></tr></table></figure><p>â€</p><p><strong>Userè¡¨ - æ ¹æ®classè‡ªåŠ¨åœ¨mysql dbåˆ›å»º</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure><p>â€</p><p>æ•°æ®è¡¨å·²ç»åˆ›å»º</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240525110258-ot38hp7.png" alt="image">â€‹</p><p>â€</p><p><strong>Itemè¡¨ - åœ¨æ•°æ®åº“åˆ›å»ºè¡¨ï¼Œå¹¶è‡ªåŠ¨åœ¨é¡¹ç›®é‡Œç”Ÿæˆå¯¹åº”çš„model class</strong></p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240525111124-9q3y8t1.png" alt="image">â€‹</p><p>â€</p><p>è¿è¡Œå‘½ä»¤ç”Ÿæˆclass</p><ul><li>å¦‚æœéœ€è¦è¿½åŠ åˆ™æŠŠ<code>&gt;</code>â€‹æ›¿æ¢ä¸º<code>&gt;&gt;</code>â€‹</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py inspectdb --database default item_tbl &gt; item/models.py</span><br></pre></td></tr></table></figure><p>â€</p><p>å¯¹åº”çš„classè‡ªåŠ¨ç”Ÿæˆ</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240525111655-kg6g4qh.png" alt="image">â€‹</p><p>â€</p><p>åœ¨user_tblæ’å…¥ä¸€æ¡è®°å½•ä½œä¸ºç¬¬ä¸€ä¸ªç”¨æˆ·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> user_tbl(user_name, is_delete, password) <span class="keyword">VALUES</span>(<span class="string">&#x27;test1&#x27;</span>, <span class="number">0</span>, <span class="string">&#x27;123456&#x27;</span>);</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="å‰ç«¯UIå‡†å¤‡"><a href="#å‰ç«¯UIå‡†å¤‡" class="headerlink" title="å‰ç«¯UIå‡†å¤‡"></a>å‰ç«¯UIå‡†å¤‡</h3><p>å‰åç«¯åˆ†ç¦»ï¼Œä½¿ç”¨Vue + axios + Bootstrapå¿«é€Ÿå¼€å‘</p><p>UI source code <a href="https://github.com/nauvalazhar/bootstrap-4-login-page">https://github.com/nauvalazhar/bootstrap-4-login-page</a></p><p>index.htmlå¼•å…¥vueå’Œaxios</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue@3.4.21&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â€</p><p>ä¿®æ”¹djangoä¸»é¡µ</p><p>settings.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165314-j1pafek.png" alt="image">â€‹</p><p>â€</p><p>æ·»åŠ è·¯ç”±å’Œcontroller</p><p>urls.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165237-mww0vfw.png" alt="image">â€‹</p><p>views.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165219-ej1ga44.png" alt="image">â€‹</p><p>â€</p><p>å¯åŠ¨æ•ˆæœ</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531151106-gh93lfl.png" alt="image">â€‹</p><p>â€</p><h3 id="æ·»åŠ åç«¯æ•°æ®æŸ¥è¯¢æ¥å£"><a href="#æ·»åŠ åç«¯æ•°æ®æŸ¥è¯¢æ¥å£" class="headerlink" title="æ·»åŠ åç«¯æ•°æ®æŸ¥è¯¢æ¥å£"></a>æ·»åŠ åç«¯æ•°æ®æŸ¥è¯¢æ¥å£</h3><p>ç›®çš„ï¼šè¿æ¥åˆ°æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·è¡¨ï¼Œå¹¶ä¸”æ ¡éªŒç”¨æˆ·å¯†ç </p><p>é¡¹ç›®å…¥å£æ–‡ä»¶urls.pyæ·»åŠ userè·¯ç”±</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531152238-c1ml76q.png" alt="image">â€‹</p><p>â€</p><p>Useræ¨¡å—ä¸‹æ·»åŠ åºåˆ—åŒ–å™¨</p><p>*æ–‡ä»¶åå¿…é¡»ä¸º<code>serializers.py</code>â€‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from user.models import User</span><br><span class="line">from rest_framework import serializers</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserSerializer(serializers.ModelSerializer):</span><br><span class="line">    class Meta:</span><br><span class="line">        model = User</span><br><span class="line">        fields = &quot;__all__&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><p>Useræ¨¡å—ä¸‹views.pyæ·»åŠ æ§åˆ¶å™¨é€»è¾‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from django.shortcuts import render</span><br><span class="line">from rest_framework.generics import GenericAPIView</span><br><span class="line">from rest_framework.mixins import CreateModelMixin, RetrieveModelMixin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">from user.models import User</span><br><span class="line">from user.serializers import UserSerializer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Create your views here.</span><br><span class="line">def home_page(request):</span><br><span class="line">    return render(request, &quot;index.html&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># User controller</span><br><span class="line"># post   - å¯¹åº”dbæ“ä½œinsert</span><br><span class="line"># get    - query by id</span><br><span class="line"># put    - update by id</span><br><span class="line"># delete - delete by id</span><br><span class="line">class UserMixinAPIView(GenericAPIView,</span><br><span class="line">                        CreateModelMixin,</span><br><span class="line">                        RetrieveModelMixin):</span><br><span class="line"></span><br><span class="line">    queryset = User.objects</span><br><span class="line">    serializer_class = UserSerializer</span><br><span class="line"></span><br><span class="line">    # æ·»åŠ ç”¨æˆ·</span><br><span class="line">    # æ·»åŠ useræ–¹æ³•æµ‹è¯•</span><br><span class="line">    def post(self, request):</span><br><span class="line">        return self.create(request)</span><br><span class="line"></span><br><span class="line">    # æŸ¥è¯¢ç”¨æˆ·</span><br><span class="line">    def get(self, request, pk):</span><br><span class="line">        return self.retrieve(request, pk)</span><br></pre></td></tr></table></figure><p>â€</p><p>Useræ¨¡å—ä¸‹urls.pyæ·»åŠ è·¯ç”±æ‹¦æˆªè§„åˆ™</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165409-zoibwhs.png" alt="image">â€‹</p><p>â€</p><p>é€šè¿‡postmanæµ‹è¯•getæ¥å£, user idä¸º1</p><p>å¯ä»¥çœ‹åˆ°æ­£å¸¸è¿”å›äº†dbé‡Œçš„ç”¨æˆ·ä¿¡æ¯</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531160648-oo4nkj6.png" alt="image">â€‹</p><p>â€</p><p>ç›®å‰å¯ä»¥çœ‹åˆ°è®¿é—®apiè¿”å›çš„æ˜¯Jsonæ•°æ®ï¼Œè€Œä¸æ˜¯çŠ¶æ€ç </p><p>éœ€è¦æ·»åŠ ä¸€ä¸ªå·¥å…·ç±»ï¼Œå¹¶ä¸”å°†è¿”å›ç»“æœè¿›è¡Œå°è£…</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165446-ta1euqw.png" alt="image">â€‹</p><p>ä¿®æ”¹user&#x2F;views.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165622-705tdqv.png" alt="image">â€‹</p><p>â€</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531165536-de2orro.png" alt="image">â€‹</p><h3 id="ç™»å½•æ”¹é€ "><a href="#ç™»å½•æ”¹é€ " class="headerlink" title="ç™»å½•æ”¹é€ "></a>ç™»å½•æ”¹é€ </h3><p>ä¸€èˆ¬ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œä¸ä¼šç”¨user_idè¿›è¡Œç™»å½•ï¼Œè€Œæ˜¯ä½¿ç”¨è´¦å·å’Œå¯†ç </p><p>views.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531172411-rt9ehxp.png" alt="image">â€‹</p><ul><li><p>è¿™é‡Œå¼•å…¥äº†<code>ViewSetMixin</code>â€‹ï¼Œç”¨äºåŒºåˆ†ä¸¤ä¸ªgetè¯·æ±‚</p><ul><li><a href="http://127.0.0.1:8000/user/">http://127.0.0.1:8000/user/</a> -&gt; è½¬å‘åˆ°<code>login</code>â€‹æ–¹æ³•, åŒæ—¶ä¼šå‘é€ä¸€ä¸ªrequest body</li><li><a href="http://127.0.0.1:8000/user/1-%3E">http://127.0.0.1:8000/user/1-&gt;</a> è½¬å‘åˆ°<code>get</code>â€‹æ–¹æ³•ï¼Œå‚æ•°åªæœ‰ä¸€ä¸ªidï¼Œæ²¡æœ‰request body</li></ul></li></ul><p>â€</p><p>urls.pyä¹Ÿè¦åšç›¸åº”çš„æ”¹åŠ¨</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616105216-aghtber.png" alt="image">â€‹</p><p>å¯ä»¥çœ‹åˆ°åŒä¸€ä¸ªget urlå¯ä»¥å…¼å®¹ä¸åŒçš„è¾“å…¥å‚æ•°</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240531172635-ki0kfir.png" alt="image">â€‹</p><p>â€</p><p>æ·»åŠ å‰ç«¯è¿”å›ç»“æœ</p><p>é€šè¿‡@clickç»‘å®šç‚¹å‡»äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue@3.4.21&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> app = <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// Method will be executed when the page initialize</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// For testing</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// this.loginTest();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// Mount your method to DOM element</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// Static method</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">loginTest</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">alert</span>(<span class="string">&quot;Test vue.&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">userLogin</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> accountName = $(<span class="string">&#x27;#account-name&#x27;</span>).<span class="title function_">val</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> accountPwd = $(<span class="string">&#x27;#account-password&#x27;</span>).<span class="title function_">val</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> userLoginInfo = &#123;&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">userLoginInfo.<span class="property">accountName</span> = accountName;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">userLoginInfo.<span class="property">accountPwd</span> = accountPwd;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">axios.<span class="title function_">post</span>(<span class="string">&#x27;/user/&#x27;</span>, userLoginInfo)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// debugger;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// TODO ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°é¦–é¡µ</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">alert</span>(<span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125; <span class="keyword">else</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">alert</span>(res.<span class="property">data</span>.<span class="property">msg</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">app.<span class="title function_">mount</span>(<span class="string">&#x27;#loginApp&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>â€</p><h2 id="JWTè®¤è¯"><a href="#JWTè®¤è¯" class="headerlink" title="JWTè®¤è¯"></a>JWTè®¤è¯</h2><p>Web appçš„ä¼šè¯æ§åˆ¶</p><ul><li>Cookie  -&gt; å­˜å‚¨åœ¨æµè§ˆå™¨ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸Šçš„å°æ–‡ä»¶ï¼Œç”¨äºä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„key-valueæ–‡ä»¶</li><li>Session -&gt; å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œç”¨äºä¿å­˜ç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚å¦‚æœç”¨æˆ·è¿‡å¤šä¼šå¯¼è‡´å ç”¨çš„å†…å­˜è¿‡å¤§</li><li>Token    -&gt; ç”¨æˆ·è®¿é—®APIèµ„æºæ‰€éœ€çš„å‡­è¯ï¼Œä¸€èˆ¬ç”±èº«ä»½æ ‡è¯†ã€æ—¶é—´æˆ³ã€ç”¨æˆ·å¿…è¦ä¿¡æ¯ç­‰å†…å®¹ç»„æˆï¼Œæ˜¯ä¸€ä¸²åŠ å¯†çš„å­—ç¬¦ä¸²</li></ul><p>â€</p><p>å“åº”æµç¨‹</p><p>â€</p><p>JWTï¼šJson web token</p><p>å®˜ç½‘ï¼š<a href="https://jwt.io/">https://jwt.io</a></p><p>JWTæ ¼å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>.</code>â€‹è¿æ¥æˆçš„ä¸‰æ®µå­—ç¬¦ä¸²</p><p>JWTç»„æˆ</p><ul><li>ç¬¬ä¸€æ®µï¼šheaderï¼ŒæŒ‡å¤´ä¿¡æ¯åŒ…å«ç®—æ³•ï¼Œå­—ç¬¦ä¸²æ˜¯ç”±å¤´ä¿¡æ¯è¿›è¡Œbase64åŠ å¯†</li><li>ç¬¬äºŒæ®µï¼špayloadï¼ŒæŒ‡ç³»ç»Ÿè‡ªå®šä¹‰å­˜å‚¨çš„ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åã€è¿‡æœŸæ—¶é—´ç­‰ï¼Œå¹¶è¿›è¡Œbase64åŠ å¯†</li><li>ç¬¬ä¸‰æ®µï¼šverify signatureï¼ŒæŒ‡éœ€è¦ç³»ç»Ÿå®šä¹‰ â€œsaltâ€ï¼Œæˆ–è€…ç§°ä¸ºå¯†é’¥</li></ul><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20231123211650-59w49ap.png" alt="image">â€‹</p><p>â€</p><p>JWTæœåŠ¡ç«¯è§£å¯†</p><p>è·å–tokenï¼Œä¾‹å¦‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.GET.get(<span class="string">&quot;token&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡<code>.</code>â€‹æŠŠå­—ç¬¦ä¸²åˆ†å‰²æˆä¸‰ä¸ªéƒ¨åˆ†</p><ul><li>ç¬¬ä¸€æ­¥ï¼šç”¨base64è§£å¯†å¾—åˆ°<code>header</code>â€‹å¤´éƒ¨ä¿¡æ¯</li><li>ç¬¬äºŒæ­¥ï¼šç”¨base64è§£å¯†å¾—åˆ°ç³»ç»Ÿä¸­çš„<code>info</code>â€‹ç”¨æˆ·æ•°æ®</li><li>ç¬¬ä¸‰æ­¥ï¼šåˆ¤æ–­ base64 (header + info + ç³»ç»Ÿå¯†é’¥) æ˜¯å¦ç­‰äºåˆ†å‰²åçš„ç¬¬ä¸‰éƒ¨åˆ†</li></ul><p>*è¦æ³¨æ„ä¿æŠ¤å¥½ç³»ç»Ÿçš„å¯†é’¥</p><p>â€</p><h3 id="å®‰è£…pyjwt"><a href="#å®‰è£…pyjwt" class="headerlink" title="å®‰è£…pyjwt"></a>å®‰è£…pyjwt</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyjwt</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="JWTå·¥å…·ç±»æµ‹è¯•"><a href="#JWTå·¥å…·ç±»æµ‹è¯•" class="headerlink" title="JWTå·¥å…·ç±»æµ‹è¯•"></a>JWTå·¥å…·ç±»æµ‹è¯•</h3><p>Djangoåœ¨åˆå§‹åŒ–é¡¹ç›®çš„æ—¶å€™ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªkeyï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªä½œä¸ºå¯†é’¥</p><p>ä¹Ÿæ ¹æ®è‡ªå®šä¹‰ç®—æ³•ç”Ÿæˆéšæœºå­—ç¬¦ä¸²</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616112951-1zjp40y.png" alt="image">â€‹</p><p>â€</p><p>ç¼–å†™å·¥å…·ç±»ç”Ÿæˆtoken</p><p>è®¾ç½®tokenè¿‡æœŸæ—¶é—´ä¸º5åˆ†é’Ÿ</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616185722-ugvjkj5.png" alt="image">â€‹</p><p>jwt_demo.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> djangoDRFDemo.settings <span class="keyword">import</span> SECRET_KEY</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_token</span>():</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;alg&#x27;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;typ&#x27;</span>: <span class="string">&quot;jwt&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&#x27;user_id&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;test_user&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;exp&#x27;</span>: datetime.datetime.utcnow() + datetime.timedelta(minutes=<span class="number">1</span>)  <span class="comment"># å®šä¹‰è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result = jwt.encode(headers=headers, payload=payload, key=SECRET_KEY, algorithm=<span class="string">&quot;HS256&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_payload</span>(<span class="params">token</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> jwt.decode(token, SECRET_KEY,algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">    <span class="keyword">except</span> jwt.exceptions.DecodeError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;tokenè®¤è¯å¤±è´¥&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> jwt.exceptions.ExpiredSignatureError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;tokenå·²ç»å¤±æ•ˆäº†&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> jwt.exceptions.InvalidTokenError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ— æ•ˆçš„token&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åŠ å¯†è¿‡ç¨‹ - ç”Ÿæˆtoken</span></span><br><span class="line">    token = create_token()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç”Ÿæˆtokenï¼š&quot;</span> + token)</span><br><span class="line"></span><br><span class="line">    payload = get_payload(token)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è·å–payloadï¼š&quot;</span> + <span class="built_in">str</span>(payload))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨æ—§çš„tokenæµ‹è¯•éªŒè¯è¿‡ç¨‹</span></span><br><span class="line">    <span class="comment"># ä¼šæŠ›å‡ºSignature has expiredå¼‚å¸¸</span></span><br><span class="line">    expired_token = <span class="string">&quot;&quot;&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6Imp3dCJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6InRlc3RfdXNlciIsImV4cCI6MTcxODUzNTcyNH0.8miAzL3pG7yMRonfR68kBJdGnUM1JksyriomfdB-zFY&quot;&quot;&quot;</span></span><br><span class="line">    payload = get_payload(expired_token)</span><br></pre></td></tr></table></figure><p>â€</p><p>è¿è¡Œç»“æœ</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616190642-p6db7se.png" alt="image">â€‹</p><p>â€</p><h3 id="JWTç™»å½•åŠŸèƒ½æ•´åˆ"><a href="#JWTç™»å½•åŠŸèƒ½æ•´åˆ" class="headerlink" title="JWTç™»å½•åŠŸèƒ½æ•´åˆ"></a>JWTç™»å½•åŠŸèƒ½æ•´åˆ</h3><h4 id="é¦–æ¬¡ç™»å½•æ—¶è¿”å›token"><a href="#é¦–æ¬¡ç™»å½•æ—¶è¿”å›token" class="headerlink" title="é¦–æ¬¡ç™»å½•æ—¶è¿”å›token"></a>é¦–æ¬¡ç™»å½•æ—¶è¿”å›token</h4><p>1.æ·»åŠ JWTå·¥å…·ç±»</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616193837-in20fg9.png" alt="image">â€‹</p><p>â€</p><p>2.æ·»åŠ Viewæ–¹æ³•</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616193907-luppdc2.png" alt="image">â€‹</p><p>â€</p><p>3.æ·»åŠ è·¯ç”±</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616193933-5vh48a9.png" alt="image">â€‹</p><p>â€</p><p>4.æµ‹è¯•æ¥å£</p><p>æˆåŠŸè¿”å›token</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616194000-v88wi5c.png" alt="image">â€‹</p><p>â€</p><h4 id="é’ˆå¯¹éç™»å½•æ¥å£æ·»åŠ JWTéªŒè¯"><a href="#é’ˆå¯¹éç™»å½•æ¥å£æ·»åŠ JWTéªŒè¯" class="headerlink" title="é’ˆå¯¹éç™»å½•æ¥å£æ·»åŠ JWTéªŒè¯"></a>é’ˆå¯¹éç™»å½•æ¥å£æ·»åŠ JWTéªŒè¯</h4><p>1.é’ˆå¯¹urlä¸­æºå¸¦tokenè¿›è¡ŒéªŒè¯</p><p>jwtå·¥å…·ç±»æ·»åŠ æ–¹æ³•</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616201642-aawmuiu.png" alt="image">â€‹</p><p>â€</p><p>Viewä¸­çš„æ–¹æ³•ä¹Ÿåšç›¸åº”çš„ä¿®æ”¹</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616203620-gtorlbn.png" alt="image">â€‹</p><p>â€</p><p>æµ‹è¯•</p><p>1.å…ˆç™»å½•ä¸€æ¬¡æ‹¿åˆ°token</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616202924-6gi24r3.png" alt="image">â€‹</p><p>â€</p><p>2.åœ¨å‚æ•°ä¸­ä½¿ç”¨tokenï¼Œç„¶åå‘é€GETè¯·æ±‚</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616202946-8wylpft.png" alt="image">â€‹</p><p>â€</p><p>æ§åˆ¶å°ä¹Ÿä¼šæ‰“å°å‡ºtokençš„ä¿¡æ¯</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616203047-lokq4um.png" alt="image">â€‹</p><p>â€</p><p>3.ç­‰å¾…tokenè¿‡æœŸåå†æ¬¡å‘èµ·è¯·æ±‚</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616203640-pq1rd2p.png" alt="image">â€‹</p><p>æ§åˆ¶å°æ˜¾ç¤ºtokenå¤±æ•ˆ</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616203707-qw67jl3.png" alt="image">â€‹</p><p>â€</p><h4 id="é’ˆå¯¹è¯·æ±‚headerä¸­æºå¸¦tokençš„éªŒè¯æ–¹å¼"><a href="#é’ˆå¯¹è¯·æ±‚headerä¸­æºå¸¦tokençš„éªŒè¯æ–¹å¼" class="headerlink" title="é’ˆå¯¹è¯·æ±‚headerä¸­æºå¸¦tokençš„éªŒè¯æ–¹å¼"></a>é’ˆå¯¹è¯·æ±‚headerä¸­æºå¸¦tokençš„éªŒè¯æ–¹å¼</h4><p>æ·»åŠ å·¥å…·ç±»</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616204928-23tnv8s.png" alt="image">â€‹</p><p>â€</p><p>Viewé‡Œåšç›¸åº”çš„ä¿®æ”¹</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616205007-v9zy1hx.png" alt="image">â€‹</p><p>â€</p><p>æµ‹è¯•æ¥å£ï¼Œä¹Ÿæ˜¯å…ˆæ‹¿åˆ°token</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616205048-svf0zn0.png" alt="image">â€‹</p><p>â€</p><p>â€</p><h4 id="JWTå…¨å±€é…ç½®"><a href="#JWTå…¨å±€é…ç½®" class="headerlink" title="JWTå…¨å±€é…ç½®"></a>JWTå…¨å±€é…ç½®</h4><p>å¦‚æœæ¯ä¸€ä¸ªç±»éƒ½æ·»åŠ JWTéªŒè¯ç±»ï¼Œä¸æ–¹ä¾¿ç»´æŠ¤</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616205142-aeipl2x.png" alt="image">â€‹</p><p>â€</p><p>åœ¨settings.pyä¸­æ·»åŠ å…¨å±€é…ç½®</p><p>æ‰€æœ‰çš„urléƒ½ä¼šè¢«æ‹¦æˆª</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616205423-o15i58r.png" alt="image">â€‹</p><p>â€</p><p>Viewé‡Œåšç›¸åº”çš„ä¿®æ”¹</p><p>æ³¨é‡Šæ‰ç±»é‡Œçš„authentication</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616205511-oxd492e.png" alt="image">â€‹</p><p>â€</p><p>éœ€è¦éªŒè¯çš„æ–¹æ³•é‡Œé¢åªéœ€è¦æ·»åŠ å¦‚ä¸‹ä»£ç å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ¤æ–­tokençŠ¶æ€</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> request.user.get(<span class="string">&quot;status&quot;</span>):</span><br><span class="line"><span class="keyword">return</span> ResponseMessage.UserResponse.failed(<span class="string">&quot;User token is invalid.&quot;</span>)</span><br></pre></td></tr></table></figure><p>â€</p><p>æµ‹è¯•</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616205732-ufbdmfi.png" alt="image">â€‹</p><p>â€</p><h2 id="è®¾ç½®å®šæ—¶ä»»åŠ¡"><a href="#è®¾ç½®å®šæ—¶ä»»åŠ¡" class="headerlink" title="è®¾ç½®å®šæ—¶ä»»åŠ¡"></a>è®¾ç½®å®šæ—¶ä»»åŠ¡</h2><p>å®‰è£…APSchedule</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django_apscheduler</span><br></pre></td></tr></table></figure><p>â€</p><p>settings.pyæ·»åŠ </p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616210113-vl0ot45.png" alt="image">â€‹</p><p>â€</p><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®ŒæˆDBçš„æ›´æ”¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 manage.py makemigrations</span><br><span class="line">python3 manage.py migrate</span><br></pre></td></tr></table></figure><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616210647-anm7hc6.png" alt="image">â€‹</p><p>â€</p><p>ä¼šåœ¨DBä¸­åˆ›å»ºAPScheduleræ‰€éœ€çš„è¡¨</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616210633-bolnwxx.png" alt="image">â€‹</p><p>â€</p><p>ä¿®æ”¹app folderä¸­çš„urls.py</p><p>â€‹<img src="/2024/06/16/DRF-Django-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20240616212555-kl9jbpb.png" alt="image">â€‹</p><p>â€</p><p>å¯åŠ¨APPå³å¯çœ‹åˆ°æ•ˆæœ</p><p>ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> apscheduler.schedulers.background <span class="keyword">import</span> BackgroundScheduler</span><br><span class="line"><span class="keyword">from</span> django_apscheduler.jobstores <span class="keyword">import</span> DjangoJobStore,register_job</span><br><span class="line"></span><br><span class="line">scheduler = BackgroundScheduler()</span><br><span class="line">scheduler.add_jobstore(DjangoJobStore(), <span class="string">&quot;default&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@register_job(<span class="params">scheduler, <span class="string">&#x27;interval&#x27;</span>, seconds=<span class="number">5</span>, name=<span class="string">&#x27;auto_hello&#x27;</span>, replace_existing=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_schedule</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello schedule&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®&quot;&gt;&lt;a href=&quot;#åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®&quot; class=&quot;headerlink&quot; title=&quot;åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®&quot;&gt;&lt;/a&gt;åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•é¡¹ç›®&lt;/h2&gt;&lt;p&gt;å®‰è£…djanago&lt;/p&gt;
&lt;figure class=&quot;highlight pyt</summary>
      
    
    
    
    <category term="Django" scheme="http://example.com/categories/Django/"/>
    
    
    <category term="Python Web" scheme="http://example.com/tags/Python-Web/"/>
    
  </entry>
  
  <entry>
    <title>Java Luceneä¸­æ–‡åˆ†è¯</title>
    <link href="http://example.com/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/"/>
    <id>http://example.com/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/</id>
    <published>2024-04-15T14:07:18.000Z</published>
    <updated>2024-04-16T13:23:34.203Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Luceneä¸­æ–‡åˆ†è¯"><a href="#Luceneä¸­æ–‡åˆ†è¯" class="headerlink" title="Luceneä¸­æ–‡åˆ†è¯"></a>Luceneä¸­æ–‡åˆ†è¯</h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><h3 id="éç»“æ„åŒ–æ•°æ®æŸ¥è¯¢æ–¹æ³•"><a href="#éç»“æ„åŒ–æ•°æ®æŸ¥è¯¢æ–¹æ³•" class="headerlink" title="éç»“æ„åŒ–æ•°æ®æŸ¥è¯¢æ–¹æ³•"></a>éç»“æ„åŒ–æ•°æ®æŸ¥è¯¢æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰é¡ºåºæ‰«ææ³•(Serial Scanning)</p><p>æ‰€è°“é¡ºåºæ‰«æï¼Œæ¯”å¦‚è¦æ‰¾å†…å®¹åŒ…å«æŸä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªæ–‡æ¡£ä¸€ä¸ªæ–‡æ¡£çš„çœ‹ï¼Œå¯¹äºæ¯ä¸€ä¸ªæ–‡æ¡£ï¼Œ</p><p>ä»å¤´çœ‹åˆ°å°¾ï¼Œå¦‚æœæ­¤æ–‡æ¡£åŒ…å«æ­¤å­—ç¬¦ä¸²ï¼Œåˆ™æ­¤æ–‡æ¡£ä¸ºæˆ‘ä»¬è¦æ‰¾çš„æ–‡ä»¶ï¼Œæ¥ç€çœ‹ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œ</p><p>ç›´åˆ°æ‰«æå®Œæ‰€æœ‰çš„æ–‡ä»¶ã€‚å¦‚åˆ©ç”¨windowsçš„æœç´¢ä¹Ÿå¯ä»¥æœç´¢æ–‡ä»¶å†…å®¹ï¼Œåªæ˜¯ç›¸å½“çš„æ…¢ã€‚</p><p>ï¼ˆ2ï¼‰å…¨æ–‡æ£€ç´¢(Full-text Search)</p><p>å°†éç»“æ„åŒ–æ•°æ®ä¸­çš„ä¸€éƒ¨åˆ†ä¿¡æ¯æå–å‡ºæ¥ï¼Œé‡æ–°ç»„ç»‡ï¼Œä½¿å…¶å˜å¾—æœ‰ä¸€å®šç»“æ„ï¼Œç„¶åå¯¹æ­¤æœ‰ä¸€å®šç»“æ„çš„æ•°æ®è¿›è¡Œæœç´¢ï¼Œ</p><p>ä»è€Œè¾¾åˆ°æœç´¢ç›¸å¯¹è¾ƒå¿«çš„ç›®çš„ã€‚è¿™éƒ¨åˆ†ä»éç»“æ„åŒ–æ•°æ®ä¸­æå–å‡ºçš„ç„¶åé‡æ–°ç»„ç»‡çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ç§°ä¹‹ç´¢å¼•ã€‚</p><p>ä¾‹å¦‚ï¼šå­—å…¸ã€‚å­—å…¸çš„æ‹¼éŸ³è¡¨å’Œéƒ¨é¦–æ£€å­—è¡¨å°±ç›¸å½“äºå­—å…¸çš„ç´¢å¼•ï¼Œå¯¹æ¯ä¸€ä¸ªå­—çš„è§£é‡Šæ˜¯éç»“æ„åŒ–çš„ï¼Œ</p><p>å¦‚æœå­—å…¸æ²¡æœ‰éŸ³èŠ‚è¡¨å’Œéƒ¨é¦–æ£€å­—è¡¨ï¼Œåœ¨èŒ«èŒ«è¾æµ·ä¸­æ‰¾ä¸€ä¸ªå­—åªèƒ½é¡ºåºæ‰«æã€‚ç„¶è€Œå­—çš„æŸäº›ä¿¡æ¯å¯ä»¥æå–å‡ºæ¥è¿›è¡Œç»“æ„åŒ–å¤„ç†ï¼Œ</p><p>æ¯”å¦‚è¯»éŸ³ï¼Œå°±æ¯”è¾ƒç»“æ„åŒ–ï¼Œåˆ†å£°æ¯å’ŒéŸµæ¯ï¼Œåˆ†åˆ«åªæœ‰å‡ ç§å¯ä»¥ä¸€ä¸€åˆ—ä¸¾ï¼Œäºæ˜¯å°†è¯»éŸ³æ‹¿å‡ºæ¥æŒ‰ä¸€å®šçš„é¡ºåºæ’åˆ—ï¼Œ</p><p>æ¯ä¸€é¡¹è¯»éŸ³éƒ½æŒ‡å‘æ­¤å­—çš„è¯¦ç»†è§£é‡Šçš„é¡µæ•°ã€‚æˆ‘ä»¬æœç´¢æ—¶æŒ‰ç»“æ„åŒ–çš„æ‹¼éŸ³æœåˆ°è¯»éŸ³ï¼Œç„¶åæŒ‰å…¶æŒ‡å‘çš„é¡µæ•°ï¼Œä¾¿å¯æ‰¾åˆ°æˆ‘ä»¬çš„éç»“æ„åŒ–æ•°æ®â€”â€”ä¹Ÿå³å¯¹å­—çš„è§£é‡Šã€‚</p><p><strong>è¿™ç§å…ˆå»ºç«‹ç´¢å¼•ï¼Œå†å¯¹ç´¢å¼•è¿›è¡Œæœç´¢çš„è¿‡ç¨‹å°±å«å…¨æ–‡æ£€ç´¢(Full-text Search)ã€‚</strong></p><p>è™½ç„¶åˆ›å»ºç´¢å¼•çš„è¿‡ç¨‹ä¹Ÿæ˜¯éå¸¸è€—æ—¶çš„ï¼Œä½†æ˜¯ç´¢å¼•ä¸€æ—¦åˆ›å»ºå°±å¯ä»¥å¤šæ¬¡ä½¿ç”¨ï¼Œå…¨æ–‡æ£€ç´¢ä¸»è¦å¤„ç†çš„æ˜¯æŸ¥è¯¢ï¼Œæ‰€ä»¥è€—æ—¶é—´åˆ›å»ºç´¢å¼•æ˜¯å€¼å¾—çš„ã€‚</p><p>â€</p><h3 id="ä»€ä¹ˆæ˜¯Lucene"><a href="#ä»€ä¹ˆæ˜¯Lucene" class="headerlink" title="ä»€ä¹ˆæ˜¯Lucene"></a>ä»€ä¹ˆæ˜¯Lucene</h3><p><strong>Luceneæ˜¯apacheä¸‹çš„ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„å…¨æ–‡æ£€ç´¢å¼•æ“å·¥å…·åŒ…</strong>ã€‚æä¾›äº†å®Œæ•´çš„æŸ¥è¯¢å¼•æ“å’Œç´¢å¼•å¼•æ“ï¼Œéƒ¨åˆ†æ–‡æœ¬åˆ†æå¼•æ“ï¼ˆè‹±æ–‡ä¸å¾·æ–‡ä¸¤ç§è¥¿æ–¹è¯­è¨€ï¼‰ã€‚</p><p>å¯¹äºæ•°æ®é‡å¤§ã€æ•°æ®ç»“æ„ä¸å›ºå®šçš„æ•°æ®å¯é‡‡ç”¨å…¨æ–‡æ£€ç´¢æ–¹å¼æœç´¢ï¼Œæ¯”å¦‚ç™¾åº¦ã€Googleç­‰æœç´¢å¼•æ“ã€è®ºå›ç«™å†…æœç´¢ã€ç”µå•†ç½‘ç«™ç«™å†…æœç´¢ç­‰ã€‚</p><p><img src="/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/image-20210529105841-4936d6f.png" alt="image.png"></p><p>å¯¹æœç´¢çš„åŸå§‹å†…å®¹è¿›è¡Œç´¢å¼•æ„å»ºä¸€ä¸ªç´¢å¼•åº“ï¼Œç´¢å¼•è¿‡ç¨‹åŒ…æ‹¬ï¼šç¡®å®šåŸå§‹å†…å®¹å³è¦æœç´¢çš„å†…å®¹ã€é‡‡é›†æ–‡æ¡£ã€åˆ›å»ºæ–‡æ¡£ã€åˆ†ææ–‡æ¡£ã€ç´¢å¼•æ–‡æ¡£</p><p>ä»ç´¢å¼•åº“ä¸­æœç´¢å†…å®¹ï¼Œæœç´¢è¿‡ç¨‹åŒ…æ‹¬ï¼šç”¨æˆ·é€šè¿‡æœç´¢ç•Œé¢ã€åˆ›å»ºæŸ¥è¯¢ã€æ‰§è¡Œæœç´¢ï¼Œä»ç´¢å¼•åº“æœç´¢ã€æ¸²æŸ“æœç´¢ç»“æœ</p><p>â€</p><h3 id="å…¨æ–‡ç´¢å¼•"><a href="#å…¨æ–‡ç´¢å¼•" class="headerlink" title="å…¨æ–‡ç´¢å¼•"></a>å…¨æ–‡ç´¢å¼•</h3><p>æœç´¢å¼•æ“é€šå¸¸æ£€ç´¢çš„åœºæ™¯æ˜¯ï¼šç»™å®šå‡ ä¸ªå…³é”®è¯ï¼Œæ‰¾å‡ºåŒ…å«å…³é”®è¯çš„æ–‡æ¡£ã€‚æ€ä¹ˆå¿«é€Ÿæ‰¾åˆ°åŒ…å«æŸä¸ªå…³é”®è¯çš„æ–‡æ¡£å°±æˆä¸ºæœç´¢çš„å…³é”®ã€‚æ‰€ä»¥å…¨æ–‡æ£€ç´¢å¼•æ“ä¸€èˆ¬ä½¿ç”¨å€’æ’ç´¢å¼•ï¼Œå¦‚Luceneã€‚</p><p><strong>å…¨æ–‡æ­£æ’ç´¢å¼•</strong></p><p>ä¸€å¥è¯æ€»ç»“ï¼šé€šè¿‡æ–‡æ¡£æ‰¾åˆ°æ‰€æœ‰çš„è¯ï¼Œç§°ä¸ºæ­£æ’ç´¢å¼•</p><p>æ­£æ’è¡¨æ˜¯ä»¥æ–‡æ¡£çš„IDä¸ºå…³é”®å­—ï¼Œè¡¨ä¸­è®°å½•æ–‡æ¡£ä¸­æ¯ä¸ªå­—çš„ä½ç½®ä¿¡æ¯ï¼ŒæŸ¥æ‰¾æ—¶æ‰«æè¡¨ä¸­æ¯ä¸ªæ–‡æ¡£ä¸­å­—çš„ä¿¡æ¯ç›´åˆ°æ‰¾å‡ºæ‰€æœ‰åŒ…å«æŸ¥è¯¢å…³é”®å­—çš„æ–‡æ¡£ã€‚<br>æ­£æ’è¡¨ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼Œè¿™ç§ç»„ç»‡æ–¹æ³•åœ¨å»ºç«‹ç´¢å¼•çš„æ—¶å€™ç»“æ„æ¯”è¾ƒç®€å•ï¼Œå»ºç«‹æ¯”è¾ƒæ–¹ä¾¿ä¸”æ˜“äºç»´æŠ¤;å› ä¸ºç´¢å¼•æ˜¯åŸºäºæ–‡æ¡£å»ºç«‹çš„ï¼Œè‹¥æ˜¯æœ‰æ–°çš„æ–‡æ¡£åŠ å…¥ï¼Œç›´æ¥ä¸ºè¯¥æ–‡æ¡£å»ºç«‹ä¸€ä¸ªæ–°çš„ç´¢å¼•å—ï¼ŒæŒ‚æ¥åœ¨åŸæ¥ç´¢å¼•æ–‡ä»¶çš„åé¢ã€‚è‹¥æ˜¯æœ‰æ–‡æ¡£åˆ é™¤ï¼Œåˆ™ç›´æ¥æ‰¾åˆ°è¯¥æ–‡æ¡£å·æ–‡æ¡£å¯¹åº”çš„ç´¢å¼•ä¿¡æ¯ï¼Œå°†å…¶ç›´æ¥åˆ é™¤ã€‚ä½†æ˜¯åœ¨æŸ¥è¯¢çš„æ—¶å€™éœ€å¯¹æ‰€æœ‰çš„æ–‡æ¡£è¿›è¡Œæ‰«æä»¥ç¡®ä¿æ²¡æœ‰é—æ¼ï¼Œè¿™æ ·å°±ä½¿å¾—æ£€ç´¢æ—¶é—´å¤§å¤§å»¶é•¿ï¼Œæ£€ç´¢æ•ˆç‡ä½ä¸‹ã€‚<br>å°½ç®¡æ­£æ’è¡¨çš„å·¥ä½œåŸç†éå¸¸çš„ç®€å•ï¼Œä½†æ˜¯ç”±äºå…¶æ£€ç´¢æ•ˆç‡å¤ªä½ï¼Œé™¤éåœ¨ç‰¹å®šæƒ…å†µä¸‹ï¼Œå¦åˆ™å®ç”¨æ€§ä»·å€¼ä¸å¤§ã€‚</p><p><img src="/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/image-20210602160526-o4n214r.png" alt="image.png"></p><p>â€</p><p><strong>å…¨æ–‡å€’æ’ç´¢å¼•</strong></p><p>ä¸€å¥è¯æ€»ç»“ï¼šé€šè¿‡è¯æ‰¾åˆ°æ‰€æœ‰æ–‡æ¡£ï¼Œç§°ä¸ºå€’æ’ç´¢å¼•</p><p>å€’æ’è¡¨ä»¥å­—æˆ–è¯ä¸ºå…³é”®å­—è¿›è¡Œç´¢å¼•ï¼Œè¡¨ä¸­å…³é”®å­—æ‰€å¯¹åº”çš„è®°å½•è¡¨é¡¹è®°å½•äº†å‡ºç°è¿™ä¸ªå­—æˆ–è¯çš„æ‰€æœ‰æ–‡æ¡£ï¼Œä¸€ä¸ªè¡¨é¡¹å°±æ˜¯ä¸€ä¸ªå­—è¡¨æ®µï¼Œå®ƒè®°å½•è¯¥æ–‡æ¡£çš„IDå’Œå­—ç¬¦åœ¨è¯¥æ–‡æ¡£ä¸­å‡ºç°çš„ä½ç½®æƒ…å†µã€‚<br>ç”±äºæ¯ä¸ªå­—æˆ–è¯å¯¹åº”çš„æ–‡æ¡£æ•°é‡åœ¨åŠ¨æ€å˜åŒ–ï¼Œæ‰€ä»¥å€’æ’è¡¨çš„å»ºç«‹å’Œç»´æŠ¤éƒ½è¾ƒä¸ºå¤æ‚ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢çš„æ—¶å€™ç”±äºå¯ä»¥ä¸€æ¬¡å¾—åˆ°æŸ¥è¯¢å…³é”®å­—æ‰€å¯¹åº”çš„æ‰€æœ‰æ–‡æ¡£ï¼Œæ‰€ä»¥æ•ˆç‡é«˜äºæ­£æ’è¡¨ã€‚åœ¨å…¨æ–‡æ£€ç´¢ä¸­ï¼Œæ£€ç´¢çš„å¿«é€Ÿå“åº”æ˜¯ä¸€ä¸ªæœ€ä¸ºå…³é”®çš„æ€§èƒ½ï¼Œè€Œç´¢å¼•å»ºç«‹ç”±äºåœ¨åå°è¿›è¡Œï¼Œå°½ç®¡æ•ˆç‡ç›¸å¯¹ä½ä¸€äº›ï¼Œä½†ä¸ä¼šå½±å“æ•´ä¸ªæœç´¢å¼•æ“çš„æ•ˆç‡ã€‚</p><p><img src="/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/image-20210602160619-ul7mobu.png" alt="image.png"></p><p>â€</p><h3 id="Luceneçš„è¯„åˆ†æœºåˆ¶"><a href="#Luceneçš„è¯„åˆ†æœºåˆ¶" class="headerlink" title="Luceneçš„è¯„åˆ†æœºåˆ¶"></a>Luceneçš„è¯„åˆ†æœºåˆ¶</h3><ul><li>ç»“æœï¼šï¼ˆTF-IDFï¼Œæ–‡æ¡£idï¼‰</li><li>è¯é¢‘ï¼šTerm Frequencyï¼Œç®€ç§°TFâ€”â€”è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡</li><li>é€†æ–‡æ¡£é¢‘ç‡ï¼šInverse Document Frequencyï¼Œç®€ç§°IDFâ€”â€”è¯åœ¨æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡è¶Šä½ï¼Œè¯´æ˜è¯è¶Šé‡è¦</li></ul><p>â€</p><h3 id="ä¸­æ–‡åˆ†æå™¨"><a href="#ä¸­æ–‡åˆ†æå™¨" class="headerlink" title="ä¸­æ–‡åˆ†æå™¨"></a>ä¸­æ–‡åˆ†æå™¨</h3><p>Analyzeræ›¿æ¢æˆèƒ½å¤„ç†ä¸­æ–‡çš„åˆ†æå™¨</p><ul><li>åº–ä¸</li><li>ç›˜å¤</li><li>IK</li></ul><p>â€</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>ä¸»è¦ç›®æ ‡ï¼šé’ˆå¯¹txtå°è¯´æ–‡ä»¶è¿›è¡Œå…³é”®è¯æŸ¥è¯¢ï¼Œå…³é”®è¯ä¸º<code>æ³¡æ²« è´·æ¬¾</code></p><h3 id="æ­¥éª¤åˆ†è§£"><a href="#æ­¥éª¤åˆ†è§£" class="headerlink" title="æ­¥éª¤åˆ†è§£"></a>æ­¥éª¤åˆ†è§£</h3><p>1.æ˜ç¡®æŸ¥è¯¢èŒƒå›´ï¼Œå‡†å¤‡åŸºç¡€æ•°æ®ï¼Œå¹¶æ•´ç†åˆ°ç›®å½•ä¸‹</p><p><img src="/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/image-20210603145755-lvyw6f9.png" alt="image.png"></p><p>ã€æ³¨æ„ã€‘ä½¿ç”¨<code>IK Analyzer</code>è¦ä¿è¯æ–‡æ¡£æ˜¯<code>UTF_8</code>ç¼–ç æ ¼å¼</p><p>â€</p><p>2.åˆ›å»ºç´¢å¼•ç”Ÿæˆå™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºç´¢å¼•ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> IndexWriter <span class="title function_">createWriter</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡å®šç´¢å¼•ç”Ÿæˆç›®å½•å¹¶æ‰“å¼€</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(INDEX_DIR);</span><br><span class="line">    <span class="type">var</span> <span class="variable">dir</span> <span class="operator">=</span> FSDirectory.open(path);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡å®šè¯æ³•åˆ†æå™¨</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">analyzer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IKAnalyzer</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»ºé€ è€…æ¨¡å¼ç”Ÿæˆé…ç½®</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">writerConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IndexWriterConfig</span>(analyzer);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">IndexWriter</span>(dir, writerConfig);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦ä½¿ç”¨è‹±æ–‡åˆ†æå™¨ï¼Œåˆ™<code>new IKAnalyzer()</code>æ”¹ä¸º<code>new StandardAnalyzer()</code></p><p>â€</p><p>3.è¯»å–å°è¯´æ•°æ®ï¼Œç”±Luceneå¼•æ“åœ¨æŒ‡å®šç›®å½•åˆ›å»ºç´¢å¼•</p><p>4.åˆ›å»ºç´¢å¼•æœç´¢å™¨</p><p>5.ä½¿ç”¨ç´¢å¼•æœç´¢å™¨è¿›è¡Œæœç´¢ï¼Œæ³¨æ„æœç´¢ä¸­çš„åˆ†æå™¨å¿…é¡»ä¸<code>ç¬¬äºŒæ­¥</code>ä¸­çš„<strong>åˆ†æå™¨ä¸€è‡´</strong></p><blockquote><p>Luceneçš„æŸ¥è¯¢æ–¹å¼å¾ˆ ä¸°å¯Œï¼Œå¯¹äºæ•°å€¼ç±»å‹çš„æ•°æ®ï¼Œé‡‡å–TermRangeQueryçš„æ–¹å¼ï¼Œå¯¹äºStringç±»å‹çš„ï¼Œå°±å¯ä»¥é‡‡å–TermQueryç­‰ï¼ŒæŸ¥è¯¢æ–¹å¼äº†ï¼Œå¯ä»¥é€šè¿‡é‡‡å–åˆé€‚çš„æŸ¥è¯¢æ–¹å¼ï¼Œæ£€ç´¢åˆ°æ•°æ®ã€‚Queryparserè¿™ä¸ªæŸ¥è¯¢æ–¹å¼åŒ…å«äº†å…¶ä»–å‡ ç§æŸ¥è¯¢æ–¹å¼ã€‚</p></blockquote><p>ã€æ³¨æ„ã€‘å‡ ç§æŸ¥è¯¢æ–¹å¼çš„æ¯”è¾ƒ</p><table><thead><tr><th>TermQuery</th><th>ç²¾ç¡®æŸ¥è¯¢</th></tr></thead><tbody><tr><td>TermRangeQuery</td><td>æŸ¥è¯¢ä¸€ä¸ªèŒƒå›´</td></tr><tr><td>PrefixQuery</td><td>å‰ç¼€åŒ¹é…æŸ¥è¯¢</td></tr><tr><td>WildcardQuery</td><td>é€šé…ç¬¦æŸ¥è¯¢</td></tr><tr><td>BooleanQuery</td><td>å¤šæ¡ä»¶æŸ¥è¯¢</td></tr><tr><td>PhraseQuery</td><td>çŸ­è¯­æŸ¥è¯¢</td></tr><tr><td>FuzzyQuery</td><td>æ¨¡ç³ŠæŸ¥è¯¢</td></tr><tr><td>Queryparser</td><td>ä¸‡èƒ½æŸ¥è¯¢ï¼ˆä¸Šé¢çš„éƒ½å¯ä»¥ç”¨è¿™ä¸ªæ¥æŸ¥è¯¢åˆ°ï¼‰</td></tr></tbody></table><p>â€</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>Lucene.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lucene;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> data.Book;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Document;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Field;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.TextField;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.DirectoryReader;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexWriter;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexWriterConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.queryparser.classic.ParseException;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.queryparser.classic.QueryParser;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.IndexSearcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.FSDirectory;</span><br><span class="line"><span class="keyword">import</span> org.wltea.analyzer.lucene.IKAnalyzer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Luceneä¸­æ–‡åˆ†è¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LuceneCN</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">INDEX_DIR</span> <span class="operator">=</span> <span class="string">&quot;/Users/kalosora/Desktop/novel/index_data&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DATA_DIR</span> <span class="operator">=</span> <span class="string">&quot;/Users/kalosora/Desktop/novel/book&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç´¢å¼•ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> IndexWriter <span class="title function_">createWriter</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŒ‡å®šç´¢å¼•ç”Ÿæˆç›®å½•å¹¶æ‰“å¼€</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(INDEX_DIR);</span><br><span class="line">        <span class="type">var</span> <span class="variable">dir</span> <span class="operator">=</span> FSDirectory.open(path);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŒ‡å®šè¯æ³•åˆ†æå™¨</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">analyzer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IKAnalyzer</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å»ºé€ è€…æ¨¡å¼ç”Ÿæˆé…ç½®</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">writerConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IndexWriterConfig</span>(analyzer);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">IndexWriter</span>(dir, writerConfig);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºç´¢å¼•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createIndex</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–ç´¢å¼•ç”Ÿæˆå™¨</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="built_in">this</span>.createWriter();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡‡é›†æ•°æ®</span></span><br><span class="line">        Map&lt;Integer, Book&gt; bookMap = readFromBooks(DATA_DIR);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// TODO æŒ‰ç« èŠ‚åˆ†å‰²æ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// TODO å¤šçº¿ç¨‹å¤„ç†ä»¥æé«˜æ•ˆç‡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºæ–‡æ¡£å¯¹è±¡</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">documents</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Document&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Integer, Book&gt; entry : bookMap.entrySet()) &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">key</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">            <span class="type">Book</span> <span class="variable">value</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line"></span><br><span class="line">            <span class="type">var</span> <span class="variable">document</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>();</span><br><span class="line">            document.add(<span class="keyword">new</span> <span class="title class_">TextField</span>(<span class="string">&quot;Name&quot;</span>,</span><br><span class="line">                    value.getName(),</span><br><span class="line">                    Field.Store.YES));</span><br><span class="line"><span class="comment">//            document.add(new TextField(&quot;Author&quot;,</span></span><br><span class="line"><span class="comment">//                    value.getAuthor(),</span></span><br><span class="line"><span class="comment">//                    Field.Store.YES));</span></span><br><span class="line">            document.add(<span class="keyword">new</span> <span class="title class_">TextField</span>(<span class="string">&quot;Sentence&quot;</span>,</span><br><span class="line">                    value.getSentence(),</span><br><span class="line">                    Field.Store.YES));</span><br><span class="line"></span><br><span class="line">            documents.add(document);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹æ–‡æ¡£å¯¹è±¡åˆ›å»ºç´¢å¼•</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> document : documents) &#123;</span><br><span class="line">            writer.addDocument(document);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        writer.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¨æ–‡ç´¢å¼•ç”Ÿæˆå®Œæ¯•!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»æŒ‡å®šç›®å½•è¯»å–æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bookPath</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, Book&gt; <span class="title function_">readFromBooks</span><span class="params">(String bookPath)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Map&lt;Integer, Book&gt; bookMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–æ–‡ä»¶åˆ—è¡¨</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">booksPath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(bookPath);</span><br><span class="line">        <span class="type">var</span> <span class="variable">books</span> <span class="operator">=</span> booksPath.listFiles();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå†æ–‡ä»¶</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> book : books) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–ä¹¦åå’Œä½œè€…å</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> book.getName();</span><br><span class="line"></span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(book);</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(fis, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">context</span> <span class="operator">=</span> reader.readLine();</span><br><span class="line">            <span class="keyword">while</span> (context != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// ç»„è£…ä¹¦æœ¬ä¿¡æ¯</span></span><br><span class="line">                <span class="type">Book</span> <span class="variable">bookInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line">                bookInfo.setName(fileName);</span><br><span class="line">                <span class="comment">//bookInfo.setAuthor(bookAuthor);</span></span><br><span class="line">                bookInfo.setSentence(context);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å…¥é˜Ÿå¹¶è¯»å–ä¸‹ä¸€ä¸ªå¥å­</span></span><br><span class="line">                bookMap.put(count, bookInfo);</span><br><span class="line">                context = reader.readLine();</span><br><span class="line"></span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> bookMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç´¢å¼•æœç´¢å™¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> IndexSearcher <span class="title function_">createSearcher</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// æŒ‡å®šç´¢å¼•ç”Ÿæˆç›®å½•å¹¶æ‰“å¼€</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(INDEX_DIR);</span><br><span class="line">        <span class="type">var</span> <span class="variable">dir</span> <span class="operator">=</span> FSDirectory.open(path);</span><br><span class="line">        <span class="type">var</span> <span class="variable">reader</span> <span class="operator">=</span> DirectoryReader.open(dir);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">IndexSearcher</span>(reader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»ç´¢å¼•æœç´¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> keyWord</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">queryIndex</span><span class="params">(String keyWord)</span> <span class="keyword">throws</span> ParseException, IOException &#123;</span><br><span class="line">        <span class="type">var</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryParser</span>(<span class="string">&quot;Sentence&quot;</span>, <span class="keyword">new</span> <span class="title class_">IKAnalyzer</span>()).parse(keyWord);</span><br><span class="line"></span><br><span class="line">        <span class="type">var</span> <span class="variable">searcher</span> <span class="operator">=</span> <span class="built_in">this</span>.createSearcher();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»…æŸ¥è¯¢å‰10æ¡</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">docs</span> <span class="operator">=</span> searcher.search(query, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> scoreDoc : docs.scoreDocs) &#123;</span><br><span class="line">            <span class="type">var</span> <span class="variable">docID</span> <span class="operator">=</span> scoreDoc.doc;</span><br><span class="line">            <span class="type">var</span> <span class="variable">doc</span> <span class="operator">=</span> searcher.doc(docID);</span><br><span class="line"><span class="comment">//            System.out.format(&quot;%s %s %s %s\n&quot;, scoreDoc.score,</span></span><br><span class="line"><span class="comment">//                    doc.get(&quot;Author&quot;),</span></span><br><span class="line"><span class="comment">//                    doc.get(&quot;Name&quot;),</span></span><br><span class="line"><span class="comment">//                    doc.get(&quot;Sentence&quot;));</span></span><br><span class="line"></span><br><span class="line">            System.out.format(<span class="string">&quot;%s %s %s\n&quot;</span>, scoreDoc.score,</span><br><span class="line">                    doc.get(<span class="string">&quot;Name&quot;</span>),</span><br><span class="line">                    doc.get(<span class="string">&quot;Sentence&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>main.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸­æ–‡åˆ†è¯å…¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ParseException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">LuceneCN</span> <span class="variable">lucene</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LuceneCN</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºç´¢å¼•</span></span><br><span class="line">        <span class="comment">//lucene.createIndex();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŸ¥è¯¢å…³é”®è¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> <span class="string">&quot;è´·æ¬¾ æ³¡æ²«&quot;</span>;</span><br><span class="line">        lucene.queryIndex(keyword);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>pom.xml</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;project xmlns=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="line">         xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">         xsi:schemaLocation=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br><span class="line">    &lt;modelVersion&gt;<span class="number">4.0</span><span class="number">.0</span>&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;org.example&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;LuceneX&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.0</span>-SNAPSHOT&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;!-- Lucene Lib --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;lucene-memory&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">7.1</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;lucene-core&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">7.1</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.lucene&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;lucene-queryparser&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">7.1</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- IK ä¸­æ–‡åˆ†è¯ --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.magese&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;ik-analyzer&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">7.4</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;source&gt;<span class="number">12</span>&lt;/source&gt;</span><br><span class="line">                    &lt;target&gt;<span class="number">12</span>&lt;/target&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>è¾“å‡ºç›®å½•</p><p><img src="/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/image-20210603151149-q6tptou.png" alt="image.png"></p><p>â€</p><p>è¿è¡Œç»“æœ</p><p><img src="/2024/04/15/Lucene%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D/image-20210603151130-diflmqr.png" alt="image.png"></p><p>â€</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://zhuanlan.zhihu.com/p/47764999">Java å…¨æ–‡æ£€ç´¢å¼•æ“å·¥å…·åŒ… Lucene åŸç†è§£æ</a></p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Luceneä¸­æ–‡åˆ†è¯&quot;&gt;&lt;a href=&quot;#Luceneä¸­æ–‡åˆ†è¯&quot; class=&quot;headerlink&quot; title=&quot;Luceneä¸­æ–‡åˆ†è¯&quot;&gt;&lt;/a&gt;Luceneä¸­æ–‡åˆ†è¯&lt;/h1&gt;&lt;h2 id=&quot;åŸºæœ¬æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŸºæœ¬æ¦‚å¿µ&quot; class=&quot;head</summary>
      
    
    
    
    <category term="Java" scheme="http://example.com/categories/Java/"/>
    
    
    <category term="Java Core" scheme="http://example.com/tags/Java-Core/"/>
    
  </entry>
  
  <entry>
    <title>æ—…ç¨‹è¿˜åœ¨ç»§ç»­</title>
    <link href="http://example.com/2024/03/29/%E6%97%85%E7%A8%8B%E8%BF%98%E5%9C%A8%E7%BB%A7%E7%BB%AD/"/>
    <id>http://example.com/2024/03/29/%E6%97%85%E7%A8%8B%E8%BF%98%E5%9C%A8%E7%BB%A7%E7%BB%AD/</id>
    <published>2024-03-29T14:22:13.000Z</published>
    <updated>2024-03-30T03:31:59.330Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ—…ç¨‹è¿˜åœ¨ç»§ç»­"><a href="#æ—…ç¨‹è¿˜åœ¨ç»§ç»­" class="headerlink" title="æ—…ç¨‹è¿˜åœ¨ç»§ç»­"></a>æ—…ç¨‹è¿˜åœ¨ç»§ç»­</h1><p>ä¸€å¹´åŠæ²¡æœ‰æ›´æ–°åšå®¢ï¼ŒåŸå› æ˜¯Macé‡ç½®æ•°æ®ä»¥åï¼Œæˆ‘å‘ç°åšå®¢æ•°æ®æ²¡æœ‰å¤‡ä»½â€¦</p><p>è¿˜å¥½æœ‰è®°ä¸‹hexoé…ç½®çš„è¿‡ç¨‹ï¼Œäºæ˜¯åªèƒ½ä»å¤´æ¥è¿‡</p><p>Hexo NEXTä¸»é¢˜ä¹Ÿä»åŸæ¥çš„5.Xå‡çº§åˆ°äº†7.X</p><p>â€‹<img src="/2024/03/29/%E6%97%85%E7%A8%8B%E8%BF%98%E5%9C%A8%E7%BB%A7%E7%BB%AD/image-20240317124230-zpap1uq.png" alt="image">â€‹</p><p>â€</p><p>æ—…ç¨‹è¿˜åœ¨ç»§ç»­ï¼Œå­¦ä¹ ä¹Ÿä¸èƒ½æ­¢æ­¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ—…ç¨‹è¿˜åœ¨ç»§ç»­&quot;&gt;&lt;a href=&quot;#æ—…ç¨‹è¿˜åœ¨ç»§ç»­&quot; class=&quot;headerlink&quot; title=&quot;æ—…ç¨‹è¿˜åœ¨ç»§ç»­&quot;&gt;&lt;/a&gt;æ—…ç¨‹è¿˜åœ¨ç»§ç»­&lt;/h1&gt;&lt;p&gt;ä¸€å¹´åŠæ²¡æœ‰æ›´æ–°åšå®¢ï¼ŒåŸå› æ˜¯Macé‡ç½®æ•°æ®ä»¥åï¼Œæˆ‘å‘ç°åšå®¢æ•°æ®æ²¡æœ‰å¤‡ä»½â€¦&lt;/p&gt;
&lt;p&gt;è¿˜å¥½æœ‰è®°ä¸‹hexoé…ç½®</summary>
      
    
    
    
    <category term="éšè®°" scheme="http://example.com/categories/%E9%9A%8F%E8%AE%B0/"/>
    
    
    <category term="éšè®°" scheme="http://example.com/tags/%E9%9A%8F%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Oracle å¼€å‘å¸¸ç”¨ä»£ç </title>
    <link href="http://example.com/2022/06/14/Oracle%20%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81/"/>
    <id>http://example.com/2022/06/14/Oracle%20%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81/</id>
    <published>2022-06-14T03:04:05.000Z</published>
    <updated>2024-03-29T14:19:05.191Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åŸºæœ¬"><a href="#åŸºæœ¬" class="headerlink" title="åŸºæœ¬"></a>åŸºæœ¬</h2><h3 id="è·å–ç¯å¢ƒä¿¡æ¯"><a href="#è·å–ç¯å¢ƒä¿¡æ¯" class="headerlink" title="è·å–ç¯å¢ƒä¿¡æ¯"></a>è·å–ç¯å¢ƒä¿¡æ¯</h3><p>USEREVN()æ–¹æ³•è¿”å›ç”¨æˆ·ç¯å¢ƒçš„ä¿¡æ¯ã€‚</p><p>option å¯ä»¥æ˜¯ ENTRYID,SESSIONID,TERMINAL,ISDBA,LANGUAGE,CLIENT_INFO,LANG,VSIZE</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--æŸ¥çœ‹å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯ DBAï¼Œå¦‚æœæ˜¯è¿”å› true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;isbda&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å› SESSION ä¼šè¯ ID </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;sessionid&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å›å¤šäººä¼šè¯äººæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;entryid&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å›å½“å‰ instance æ ‡å¿—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;instance&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å›å½“å‰è¯­è¨€ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;language&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å›å½“å‰è¯­è¨€ç¯å¢ƒçš„ç¼©å†™ï¼Œå¦‚ ZHS,EN ç­‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;lang&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å›ç”¨æˆ·ç»ˆç«¯æˆ–æœºå™¨æ ‡è¯†</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(<span class="string">&#x27;terminal&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">--è¿”å›ä¼ å…¥å­—ç¬¦çš„å­—èŠ‚æ•°ï¼Œä»¥ X ä¸ºä¾‹ï¼Œè¿”å›çš„å°±æ˜¯ X å­—ç¬¦çš„å¤§å°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> userevn(X) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="æˆªå–åˆ°æŸä¸€ä¸ªå­—ç¬¦ä¸²å‰é¢çš„å†…å®¹"><a href="#æˆªå–åˆ°æŸä¸€ä¸ªå­—ç¬¦ä¸²å‰é¢çš„å†…å®¹" class="headerlink" title="æˆªå–åˆ°æŸä¸€ä¸ªå­—ç¬¦ä¸²å‰é¢çš„å†…å®¹"></a>æˆªå–åˆ°æŸä¸€ä¸ªå­—ç¬¦ä¸²å‰é¢çš„å†…å®¹</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;210-1106000001&#x27;</span>,<span class="number">1</span>,instr(<span class="string">&#x27;210-1106000001&#x27;</span>,<span class="string">&#x27;-&#x27;</span>)<span class="number">-1</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="è®¾ç½®å½“å‰ä¼šè¯æ—¥æœŸæ ¼å¼"><a href="#è®¾ç½®å½“å‰ä¼šè¯æ—¥æœŸæ ¼å¼" class="headerlink" title="è®¾ç½®å½“å‰ä¼šè¯æ—¥æœŸæ ¼å¼"></a>è®¾ç½®å½“å‰ä¼šè¯æ—¥æœŸæ ¼å¼</h3><p>è®¾ç½®å½“å‰ä¼šè¯æ—¥æœŸæ ¼å¼ä¸ºè‹±æ–‡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> session <span class="keyword">set</span> nls_date_language<span class="operator">=</span>american;</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="å¼€å¯æ§åˆ¶å°è¾“å‡º"><a href="#å¼€å¯æ§åˆ¶å°è¾“å‡º" class="headerlink" title="å¼€å¯æ§åˆ¶å°è¾“å‡º"></a>å¼€å¯æ§åˆ¶å°è¾“å‡º</h3><p>ç”¨äºä½¿ <code>dbms_output.put_line()</code> ç”Ÿæ•ˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> serveroutput <span class="keyword">on</span>;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure><p>â€</p><h3 id="å…³é—­å‚æ•°è¾“å…¥"><a href="#å…³é—­å‚æ•°è¾“å…¥" class="headerlink" title="å…³é—­å‚æ•°è¾“å…¥"></a>å…³é—­å‚æ•°è¾“å…¥</h3><p>ä½¿Oracleçš„å‚æ•°ç¬¦å· <code>&amp;</code> å¤±æ•ˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">define</span> off;</span><br><span class="line"><span class="operator">/</span></span><br></pre></td></tr></table></figure><p>â€</p><h2 id="æ•°æ®åº“æŒ‡æ ‡"><a href="#æ•°æ®åº“æŒ‡æ ‡" class="headerlink" title="æ•°æ®åº“æŒ‡æ ‡"></a>æ•°æ®åº“æŒ‡æ ‡</h2><h3 id="æŸ¥çœ‹å ç”¨è¡¨ç©ºé—´å¤§å°"><a href="#æŸ¥çœ‹å ç”¨è¡¨ç©ºé—´å¤§å°" class="headerlink" title="æŸ¥çœ‹å ç”¨è¡¨ç©ºé—´å¤§å°"></a>æŸ¥çœ‹å ç”¨è¡¨ç©ºé—´å¤§å°</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> se.username,</span><br><span class="line">       se.sid,</span><br><span class="line">       su.extents,</span><br><span class="line">       su.blocks <span class="operator">*</span> to_number(rtrim(p.value)) <span class="keyword">AS</span> Space,</span><br><span class="line">       tablespace,</span><br><span class="line">       segtype,</span><br><span class="line">       sql_text</span><br><span class="line">  <span class="keyword">FROM</span> v$sort_usage su, v$<span class="keyword">parameter</span> p, v$session se, v$<span class="keyword">sql</span> s</span><br><span class="line"> <span class="keyword">WHERE</span> p.name <span class="operator">=</span> <span class="string">&#x27;db_block_size&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> su.session_addr <span class="operator">=</span> se.saddr</span><br><span class="line">   <span class="keyword">AND</span> s.hash_value <span class="operator">=</span> su.sqlhash</span><br><span class="line">   <span class="keyword">AND</span> s.address <span class="operator">=</span> su.sqladdr</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> se.username, se.sid;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><h3 id="æŸ¥çœ‹å ç”¨çš„ç£ç›˜ç©ºé—´"><a href="#æŸ¥çœ‹å ç”¨çš„ç£ç›˜ç©ºé—´" class="headerlink" title="æŸ¥çœ‹å ç”¨çš„ç£ç›˜ç©ºé—´"></a>æŸ¥çœ‹å ç”¨çš„ç£ç›˜ç©ºé—´</h3><p>å¯¹äºäº§ç”Ÿå¤§é‡DMLçš„åœºæ™¯ï¼Œä¼šéœ€è¦ç›‘æ§ç£ç›˜ç©ºé—´ã€‚å¦‚æœç©ºé—´çˆ†æ»¡ä¼šå¯¼è‡´Oracleå®•æœºã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TRUNC(first_time) &quot;Date&quot;,</span><br><span class="line">       to_char(first_time, <span class="string">&#x27;Dy&#x27;</span>) &quot;Day&quot;,</span><br><span class="line">       <span class="built_in">COUNT</span>(<span class="number">1</span>) &quot;Total(GB)&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;00&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h0&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;01&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h1&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;02&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h2&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;03&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h3&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;04&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h4&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;05&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h5&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;06&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h6&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;07&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h7&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;08&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h8&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;09&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h9&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;10&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h10&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;11&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h11&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;12&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h12&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;13&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h13&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;14&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h14&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;15&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h15&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;16&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h16&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;17&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h17&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;18&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h18&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;19&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h19&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;20&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h20&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;21&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h21&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;22&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h22&quot;,</span><br><span class="line">       <span class="built_in">SUM</span>(DECODE(to_char(first_time, <span class="string">&#x27;hh24&#x27;</span>), <span class="string">&#x27;23&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;h23&quot;,</span><br><span class="line">       ROUND(<span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="operator">/</span> <span class="number">24</span>, <span class="number">2</span>) &quot;Avg&quot;</span><br><span class="line">  <span class="keyword">FROM</span> gv$log_history</span><br><span class="line"> <span class="keyword">WHERE</span> thread# <span class="operator">=</span> inst_id</span><br><span class="line">   <span class="keyword">AND</span> TRUNC(first_time) <span class="operator">&gt;=</span> to_date(<span class="string">&#x27;2022/01/25&#x27;</span>, <span class="string">&#x27;yyyy/mm/dd&#x27;</span>)</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> TRUNC(first_time), to_char(first_time, <span class="string">&#x27;Dy&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><h3 id="æŸ¥è¯¢é”ä½çš„è¡¨"><a href="#æŸ¥è¯¢é”ä½çš„è¡¨" class="headerlink" title="æŸ¥è¯¢é”ä½çš„è¡¨"></a>æŸ¥è¯¢é”ä½çš„è¡¨</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> dob.object_name &quot;å¯¹è±¡åç§°&quot;,</span><br><span class="line">       lo.session_id &quot;ä¼šè¯ID&quot;,</span><br><span class="line">       vss.serial# &quot;ç©¿è¡Œ&quot;,</span><br><span class="line">       vss.action &quot;èŒè´£&quot;,</span><br><span class="line">       vss.module &quot;è¡¨å•&quot;,</span><br><span class="line">       vss.blocking_session &quot;ç­‰å¾…å…¶ä»–ä¼šè¯ID&quot;,</span><br><span class="line">       vss.client_identifier &quot;ç”¨æˆ·&quot;,</span><br><span class="line">       vql.sql_text &quot;SQLè¯­å¥&quot;,</span><br><span class="line">       <span class="string">&#x27;alter system kill session &#x27;</span> <span class="operator">||</span> <span class="string">&#x27;&#x27;&#x27;&#x27;</span> <span class="operator">||</span> lo.session_id <span class="operator">||</span> <span class="string">&#x27;,&#x27;</span> <span class="operator">||</span> vss.serial# <span class="operator">||</span> <span class="string">&#x27;&#x27;&#x27;immediate;&#x27;</span> &quot;å‘½ä»¤&quot;</span><br><span class="line">  <span class="keyword">FROM</span> v$locked_object lo,</span><br><span class="line">       dba_objects     dob,</span><br><span class="line">       v$session       vss,</span><br><span class="line">       v$process       vps,</span><br><span class="line">       v$<span class="keyword">sql</span>           vql</span><br><span class="line"> <span class="keyword">WHERE</span> lo.object_id <span class="operator">=</span> dob.object_id</span><br><span class="line">   <span class="keyword">AND</span> lo.session_id <span class="operator">=</span> vss.sid</span><br><span class="line">   <span class="keyword">AND</span> vss.paddr <span class="operator">=</span> vps.addr</span><br><span class="line">   <span class="keyword">AND</span> vql.sql_id(<span class="operator">+</span>) <span class="operator">=</span> vss.sql_id</span><br><span class="line">   <span class="comment">--AND OBJECT_NAME = &#x27;AP_INVOICES_ALL&#x27;</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> lo.session_id;</span><br></pre></td></tr></table></figure><p>â€</p><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><h3 id="æ•°å­—è½¬æ¢æˆå¤§å†™"><a href="#æ•°å­—è½¬æ¢æˆå¤§å†™" class="headerlink" title="æ•°å­—è½¬æ¢æˆå¤§å†™"></a>æ•°å­—è½¬æ¢æˆå¤§å†™</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FUNCTION</span> convert_money(input_nbr1 NUMBER) <span class="keyword">RETURN</span> VARCHAR2 <span class="keyword">IS</span></span><br><span class="line">    input_nbr_bak  NUMBER(<span class="number">20</span>);</span><br><span class="line">    num_character  VARCHAR2(<span class="number">200</span>) :<span class="operator">=</span> <span class="string">&#x27;é›¶å£¹è´°åè‚†ä¼é™†æŸ’æŒç–&#x27;</span>;</span><br><span class="line">    unit_character VARCHAR2(<span class="number">400</span>) :<span class="operator">=</span> <span class="string">&#x27;åˆ†è§’åœ†æ‹¾ä½°ä»Ÿä¸‡æ‹¾ä½°ä»Ÿäº¿æ‹¾ä½°ä»Ÿä¸‡æ‹¾ä½°ä»Ÿäº¿&#x27;</span>;</span><br><span class="line">    output_string  VARCHAR2(<span class="number">1000</span>) :<span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    remain_nbr     NUMBER(<span class="number">20</span>);</span><br><span class="line">    bit_num        NUMBER(<span class="number">20</span>);</span><br><span class="line">    bit_unit       VARCHAR2(<span class="number">20</span>);</span><br><span class="line">    bit_indic      NUMBER(<span class="number">1</span>) :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    i              NUMBER(<span class="number">2</span>) :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    spe_unit       VARCHAR2(<span class="number">20</span>) :<span class="operator">=</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    sign_indic     VARCHAR2(<span class="number">10</span>);</span><br><span class="line">    input_nbr      NUMBER(<span class="number">38</span>);</span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    input_nbr :<span class="operator">=</span> input_nbr1 <span class="operator">*</span> <span class="number">100</span>;</span><br><span class="line">    IF input_nbr <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">      <span class="keyword">RETURN</span> <span class="string">&#x27;é›¶åœ†æ•´&#x27;</span>;</span><br><span class="line">    ELSIF input_nbr <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">      sign_indic    :<span class="operator">=</span> <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">      input_nbr_bak :<span class="operator">=</span> input_nbr;</span><br><span class="line">    ELSIF input_nbr <span class="operator">&lt;</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">      sign_indic    :<span class="operator">=</span> <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">      input_nbr_bak :<span class="operator">=</span> <span class="operator">-</span>input_nbr;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    LOOP</span><br><span class="line">      remain_nbr    :<span class="operator">=</span> <span class="built_in">floor</span>(input_nbr_bak <span class="operator">/</span> <span class="number">10</span>);</span><br><span class="line">      bit_num       :<span class="operator">=</span> input_nbr_bak <span class="operator">-</span> remain_nbr <span class="operator">*</span> <span class="number">10</span>;</span><br><span class="line">      input_nbr_bak :<span class="operator">=</span> remain_nbr;</span><br><span class="line">      bit_unit      :<span class="operator">=</span> rtrim(substr(unit_character,</span><br><span class="line">                                    i <span class="operator">+</span> <span class="number">1</span>,</span><br><span class="line">                                    <span class="number">1</span>));</span><br><span class="line">      IF bit_num <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">        bit_indic :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        IF i <span class="operator">=</span> <span class="number">6</span></span><br><span class="line">           <span class="keyword">OR</span> i <span class="operator">=</span> <span class="number">14</span> <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">          spe_unit :<span class="operator">=</span> <span class="string">&#x27;ä¸‡&#x27;</span>;</span><br><span class="line">        ELSIF (i <span class="operator">&gt;=</span> <span class="number">7</span> <span class="keyword">AND</span> i <span class="operator">&lt;=</span> <span class="number">9</span>)</span><br><span class="line">              <span class="keyword">OR</span> (i <span class="operator">&gt;=</span> <span class="number">15</span> <span class="keyword">AND</span> i <span class="operator">&lt;=</span> <span class="number">17</span>) <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">          IF spe_unit <span class="operator">!=</span> <span class="string">&#x27;ä¸‡&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">            output_string :<span class="operator">=</span> <span class="string">&#x27;ä¸‡&#x27;</span> <span class="operator">||</span> output_string;</span><br><span class="line">            spe_unit      :<span class="operator">=</span> <span class="string">&#x27;ä¸‡&#x27;</span>;</span><br><span class="line">          <span class="keyword">END</span> IF;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">        output_string :<span class="operator">=</span> substr(num_character,</span><br><span class="line">                                bit_num <span class="operator">+</span> <span class="number">1</span>,</span><br><span class="line">                                <span class="number">1</span>) <span class="operator">||</span> bit_unit <span class="operator">||</span> output_string;</span><br><span class="line">      <span class="keyword">ELSE</span></span><br><span class="line"> </span><br><span class="line">        IF bit_indic <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">          output_string :<span class="operator">=</span> <span class="string">&#x27;é›¶&#x27;</span> <span class="operator">||</span> output_string;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">        IF bit_unit <span class="keyword">IN</span> (<span class="string">&#x27;åœ†&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;äº¿&#x27;</span>) <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">          spe_unit      :<span class="operator">=</span> bit_unit;</span><br><span class="line">          output_string :<span class="operator">=</span> bit_unit <span class="operator">||</span> output_string;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">        bit_indic :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">END</span> IF;</span><br><span class="line">      i :<span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">      EXIT <span class="keyword">WHEN</span> input_nbr_bak <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line">    IF <span class="built_in">MOD</span>(input_nbr,</span><br><span class="line">           <span class="number">100</span>) <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line"> </span><br><span class="line">      output_string :<span class="operator">=</span> output_string <span class="operator">||</span> <span class="string">&#x27;æ•´&#x27;</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    IF sign_indic <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line">      output_string :<span class="operator">=</span> <span class="string">&#x27;è´Ÿ&#x27;</span> <span class="operator">||</span> output_string;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">RETURN</span> output_string;</span><br><span class="line">  <span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åŸºæœ¬&quot;&gt;&lt;a href=&quot;#åŸºæœ¬&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬&quot;&gt;&lt;/a&gt;åŸºæœ¬&lt;/h2&gt;&lt;h3 id=&quot;è·å–ç¯å¢ƒä¿¡æ¯&quot;&gt;&lt;a href=&quot;#è·å–ç¯å¢ƒä¿¡æ¯&quot; class=&quot;headerlink&quot; title=&quot;è·å–ç¯å¢ƒä¿¡æ¯&quot;&gt;&lt;/a&gt;è·</summary>
      
    
    
    
    <category term="Database" scheme="http://example.com/categories/Database/"/>
    
    
    <category term="Oracle" scheme="http://example.com/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>Java å•ä¾‹æ¨¡å¼çš„å®‰å…¨æ€§</title>
    <link href="http://example.com/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/"/>
    <id>http://example.com/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/</id>
    <published>2022-05-26T02:14:13.000Z</published>
    <updated>2024-03-29T14:17:51.079Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><p>å•ä¾‹æ¨¡å¼æ˜¯æŒ‡ï¼ŒæŸä¸ªå¯¹è±¡åœ¨è¿è¡Œæ—¶ä»…å­˜åœ¨ä¸€ä¸ªï¼Œå¹¶å¯¹å¤–æä¾›ç»Ÿä¸€è®¿é—®æ–¹å¼ã€‚</p><ul><li>é¥¿æ±‰æ¨¡å¼ï¼šç±»è¢«åŠ è½½çš„æ—¶å€™å°±ç«‹å³åˆå§‹åŒ–å¹¶åˆ›å»ºå”¯ä¸€å®ä¾‹</li><li>æ‡’æ±‰æ¨¡å¼ï¼šåœ¨è¢«é¦–æ¬¡è°ƒç”¨çš„æ—¶å€™æ‰åˆ›å»ºå”¯ä¸€å®ä¾‹ã€‚åŠ å…¥åŒé‡æ£€æŸ¥é”æœºåˆ¶èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li></ul><p>â€</p><h3 id="é¥¿æ±‰å•ä¾‹æ¨¡å¼"><a href="#é¥¿æ±‰å•ä¾‹æ¨¡å¼" class="headerlink" title="é¥¿æ±‰å•ä¾‹æ¨¡å¼"></a>é¥¿æ±‰å•ä¾‹æ¨¡å¼</h3><p>å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanContainerStaving</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">BeanContainerStaving</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanContainerStaving</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¦æ­¢è®¿é—®æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">BeanContainerStaving</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BeanContainerStaving <span class="title function_">getInstance</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 1 get instance&quot;</span>);</span><br><span class="line">                System.out.println(BeanContainerStaving.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 2 get instance&quot;</span>);</span><br><span class="line">                System.out.println(BeanContainerStaving.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        thread2.start();</span><br><span class="line">        thread1.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœ</p><p>ä¿è¯è·å–åˆ°çš„æ˜¯å”¯ä¸€å®ä¾‹</p><p><img src="/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/image-20220527094219-vqdoi4y.png" alt="image.png"></p><p>â€</p><h3 id="æ‡’æ±‰å•ä¾‹æ¨¡å¼"><a href="#æ‡’æ±‰å•ä¾‹æ¨¡å¼" class="headerlink" title="æ‡’æ±‰å•ä¾‹æ¨¡å¼"></a>æ‡’æ±‰å•ä¾‹æ¨¡å¼</h3><p>å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanContainerLazy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜²æ­¢æŒ‡ä»¤é‡æ’åº</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span>  BeanContainerLazy instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">BeanContainerLazy</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BeanContainerLazy <span class="title function_">getInstance</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åŒé‡æ£€æµ‹</span></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (BeanContainerLazy.class)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">BeanContainerLazy</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 1 get instance: &quot;</span> + BeanContainerLazy.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 2 get instance: &quot;</span> + BeanContainerLazy.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        thread2.start();</span><br><span class="line">        thread1.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœ</p><p>æ‡’æ±‰æ¨¡å¼åŒæ ·ä¿è¯äº†å®ä¾‹åœ¨è¿è¡Œæ—¶å”¯ä¸€</p><p><img src="/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/image-20220527094800-q1lz1rw.png" alt="image.png"></p><p>â€</p><h2 id="å•ä¾‹çš„å®‰å…¨æ€§"><a href="#å•ä¾‹çš„å®‰å…¨æ€§" class="headerlink" title="å•ä¾‹çš„å®‰å…¨æ€§"></a>å•ä¾‹çš„å®‰å…¨æ€§</h2><p>å°½ç®¡å•ä¾‹æ¨¡å¼å·²ç»å°†æ„é€ æ–¹æ³•è®¾ç½®ä¸º <code>private</code> ä½†æ˜¯ä¾ç„¶å­˜åœ¨è®©å•ä¾‹ä¸å”¯ä¸€çš„æ‰‹æ®µã€‚</p><ul><li>åå°„æ”»å‡»</li><li>åºåˆ—åŒ–æ”»å‡»</li></ul><p>â€</p><h3 id="åå°„æ”»å‡»"><a href="#åå°„æ”»å‡»" class="headerlink" title="åå°„æ”»å‡»"></a>åå°„æ”»å‡»</h3><p>å®ç°ï¼šé€šè¿‡åå°„åˆ›å»ºå®ä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 1 get instance: &quot;</span> + BeanContainerLazy.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 2 get instance: &quot;</span> + BeanContainerLazy.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åå°„åˆ›å»ºæ‡’æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="type">Class</span> <span class="variable">lazyClazz</span> <span class="operator">=</span> BeanContainerLazy.class;</span><br><span class="line">                <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    constructor = lazyClazz.getDeclaredConstructor();</span><br><span class="line">                    constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;Thread 3 get instance: &quot;</span> + constructor.newInstance());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        thread2.start();</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœï¼šå‡ºç°äº†åœ°å€ä¸ç›¸åŒçš„å®ä¾‹ï¼Œè¡¨æ˜é€šè¿‡åå°„å¯ä»¥ç ´åå•ä¾‹æ¨¡å¼çš„å”¯ä¸€æ€§</p><p><img src="/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/image-20220527150904-rey5u1e.png" alt="image.png"></p><p>â€</p><h3 id="åºåˆ—åŒ–æ”»å‡»"><a href="#åºåˆ—åŒ–æ”»å‡»" class="headerlink" title="åºåˆ—åŒ–æ”»å‡»"></a>åºåˆ—åŒ–æ”»å‡»</h3><p>æ‡’æ±‰å¼å•ï¼Œå®ç°åºåˆ—åŒ–æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * å®ç°åºåˆ—åŒ–æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanContainerLazySel</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜²æ­¢æŒ‡ä»¤é‡æ’åº</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> BeanContainerLazySel instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">BeanContainerLazySel</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BeanContainerLazySel <span class="title function_">getInstance</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åŒé‡æ£€æµ‹</span></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (BeanContainerLazySel.class)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">BeanContainerLazySel</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>æµ‹è¯•åºåˆ—åŒ–æ”»å‡»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> instance</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setObject</span><span class="params">(BeanContainerLazySel instance)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;instance&quot;</span>));</span><br><span class="line">        outputStream.writeObject(instance);</span><br><span class="line">        outputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> BeanContainerLazySel <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;instance&quot;</span>));</span><br><span class="line">        <span class="type">BeanContainerLazySel</span> <span class="variable">object</span> <span class="operator">=</span> (BeanContainerLazySel)inputStream.readObject();</span><br><span class="line">        inputStream.close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">BeanContainerLazySel</span> <span class="variable">instance</span> <span class="operator">=</span> BeanContainerLazySel.getInstance();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        setObject(instance);</span><br><span class="line"></span><br><span class="line">        <span class="type">BeanContainerLazySel</span> <span class="variable">object</span> <span class="operator">=</span> getObject();</span><br><span class="line">        System.out.println(object);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœï¼šåœ¨æ‡’æ±‰å¼å•ä¾‹ä¸‹ï¼Œé€šè¿‡åºåˆ—åŒ–æ¥è·å–å•ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°åœ°å€ä¸ä¸€è‡´ã€‚</p><p><img src="/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/image-20220529101039-2xeopat.png" alt="image.png"></p><p>â€</p><h3 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h3><h4 id="æŠµå¾¡åå°„æ”»å‡»"><a href="#æŠµå¾¡åå°„æ”»å‡»" class="headerlink" title="æŠµå¾¡åå°„æ”»å‡»"></a>æŠµå¾¡åå°„æ”»å‡»</h4><p><strong>ä½¿ç”¨æšä¸¾ç±»å‹</strong></p><p>æŠŠæ‡’æ±‰å¼å•ä¾‹å­˜æ”¾åˆ°æšä¸¾ç±»å‹ä¸­ï¼Œå¯é˜²æ­¢åå°„å’Œåºåˆ—åŒ–æ”»å‡»</p><p>ä»¥æ‡’æ±‰å¼å•ä¾‹ä¸ºä¾‹å­ï¼š</p><p>å®ç°ï¼ˆæšä¸¾ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * å®ç°åºåˆ—åŒ–æ¥å£</span></span><br><span class="line"><span class="comment"> * å•ä¾‹å­˜æ”¾åœ¨æšä¸¾ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnumBeanContainerStavingSel</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EnumBeanContainerStavingSel</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EnumBeanContainerStavingSel <span class="title function_">getInstance</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ContainerHolder.HOLDER.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">enum</span> <span class="title class_">ContainerHolder</span></span><br><span class="line">    &#123;</span><br><span class="line">        HOLDER;</span><br><span class="line">        <span class="keyword">private</span> EnumBeanContainerStavingSel instance;</span><br><span class="line"></span><br><span class="line">        ContainerHolder()</span><br><span class="line">        &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">EnumBeanContainerStavingSel</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coding.singleton;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> instance</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setObject</span><span class="params">(EnumBeanContainerStavingSel instance)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;instance&quot;</span>));</span><br><span class="line">        outputStream.writeObject(instance);</span><br><span class="line">        outputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> EnumBeanContainerStavingSel <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;instance&quot;</span>));</span><br><span class="line">        <span class="type">EnumBeanContainerStavingSel</span> <span class="variable">object</span> <span class="operator">=</span> (EnumBeanContainerStavingSel)inputStream.readObject();</span><br><span class="line">        inputStream.close();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Thread 1 get instance: &quot;</span> + EnumBeanContainerStavingSel.getInstance());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åå°„æ”»å‡»</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> EnumBeanContainerStavingSel.class.getDeclaredConstructor();</span><br><span class="line">                    constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    <span class="type">EnumBeanContainerStavingSel</span> <span class="variable">enumBeanContainerStavingSel</span> <span class="operator">=</span> (EnumBeanContainerStavingSel)constructor.newInstance();</span><br><span class="line">                    System.out.println(<span class="string">&quot;Thread 2 get instance: &quot;</span> + enumBeanContainerStavingSel.getInstance());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åºåˆ—åŒ–æ”»å‡»</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="type">EnumBeanContainerStavingSel</span> <span class="variable">instance</span> <span class="operator">=</span> EnumBeanContainerStavingSel.getInstance();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// æŠŠå¯¹è±¡å†™å…¥åˆ°ç£ç›˜</span></span><br><span class="line">                    setObject(instance);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// ä»ç£ç›˜ä¸­è¯»å–å¯¹è±¡ï¼Œå¹¶è§‚å¯Ÿæ˜¯å¦ä¸è¿è¡Œä¸­çš„å®ä¾‹ç›¸åŒ</span></span><br><span class="line">                    <span class="type">EnumBeanContainerStavingSel</span> <span class="variable">object</span> <span class="operator">=</span> getObject();</span><br><span class="line">                    System.out.println(<span class="string">&quot;Thread 3 get instance: &quot;</span> + object);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        thread2.start();</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœ</p><p>å¯ä»¥çœ‹åˆ°æ”¾åœ¨æšä¸¾ä¸­çš„å®:</p><ol><li>åå°„çš„æ–¹å¼è¯»å–éƒ½æ˜¯åŒä¸€ä¸ªç±»ã€‚</li><li>åºåˆ—åŒ–æ–¹å¼è¯»å–ï¼Œå´ä¸æ˜¯åŒä¸€ä¸ªç±»ï¼Œä¹Ÿå°±æ˜¯è¯´æšä¸¾ç±»å‹èƒ½å¤ŸæŠµå¾¡åå°„æ”»å‡»ï¼Œå´ä¸èƒ½æŠµå¾¡åºåˆ—åŒ–æ”»å‡»</li></ol><p><img src="/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/image-20220529103748-ram6wrj.png" alt="image.png"></p><p>â€</p><h4 id="æŠµå¾¡åºåˆ—åŒ–æ”»å‡»"><a href="#æŠµå¾¡åºåˆ—åŒ–æ”»å‡»" class="headerlink" title="æŠµå¾¡åºåˆ—åŒ–æ”»å‡»"></a>æŠµå¾¡åºåˆ—åŒ–æ”»å‡»</h4><p>åœ¨ç±»ä¸­å®šä¹‰ <code>readResolve</code> çš„é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * å®ç°åºåˆ—åŒ–æ¥å£</span></span><br><span class="line"><span class="comment"> * å•ä¾‹å­˜æ”¾åœ¨æšä¸¾ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnumBeanContainerStavingSel</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EnumBeanContainerStavingSel</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EnumBeanContainerStavingSel <span class="title function_">getInstance</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ContainerHolder.HOLDER.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">enum</span> <span class="title class_">ContainerHolder</span></span><br><span class="line">    &#123;</span><br><span class="line">        HOLDER;</span><br><span class="line">        <span class="keyword">private</span> EnumBeanContainerStavingSel instance;</span><br><span class="line"></span><br><span class="line">        ContainerHolder()</span><br><span class="line">        &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">EnumBeanContainerStavingSel</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(getInstance() == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">EnumBeanContainerStavingSel</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> ContainerHolder.HOLDER.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><p>ä½¿ç”¨åŒæ ·çš„æµ‹è¯•ç”¨ä¾‹è¿›è¡Œæµ‹è¯•ï¼Œç»“æœå¦‚ä¸‹</p><p><img src="/2022/05/26/Java%20%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7/image-20220529104010-0nrheqc.png" alt="image.png"></p><p>â€</p><h4 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h4><ol><li>æšä¸¾ç±»å‹å®é™…ä¸Šæ˜¯ <code>static</code> çš„ä»£ç å—ï¼Œä¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™æ‰§è¡Œï¼Œä¸èƒ½è¢«åå°„åˆ›å»ºã€‚æšä¸¾ç±»å‹ä¸­çš„å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li><li>åœ¨åºåˆ—åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœè¦ä¿è¯å•ä¾‹ï¼Œåˆ™éœ€è¦å®ç° <code>readResolve()</code> æ–¹æ³•ä¿è¯å¯¹è±¡å”¯ä¸€ã€‚</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å•ä¾‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#å•ä¾‹æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;å•ä¾‹æ¨¡å¼&quot;&gt;&lt;/a&gt;å•ä¾‹æ¨¡å¼&lt;/h2&gt;&lt;p&gt;å•ä¾‹æ¨¡å¼æ˜¯æŒ‡ï¼ŒæŸä¸ªå¯¹è±¡åœ¨è¿è¡Œæ—¶ä»…å­˜åœ¨ä¸€ä¸ªï¼Œå¹¶å¯¹å¤–æä¾›ç»Ÿä¸€è®¿é—®æ–¹å¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¥¿æ±‰æ¨¡å¼ï¼šç±»è¢«åŠ è½½çš„æ—¶å€™å°±ç«‹å³</summary>
      
    
    
    
    <category term="Java" scheme="http://example.com/categories/Java/"/>
    
    
    <category term="Java Core" scheme="http://example.com/tags/Java-Core/"/>
    
  </entry>
  
  <entry>
    <title>MinIOæ­å»ºOSS</title>
    <link href="http://example.com/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/"/>
    <id>http://example.com/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/</id>
    <published>2021-08-23T06:34:17.000Z</published>
    <updated>2024-03-29T14:15:51.448Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MinIOæ­å»ºOSS"><a href="#MinIOæ­å»ºOSS" class="headerlink" title="MinIOæ­å»ºOSS"></a>MinIOæ­å»ºOSS</h1><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>ç¯å¢ƒåŸºäºdokcerã€‚</p><p>é¦–å…ˆç¡®ä¿dockerå¯åŠ¨çŠ¶æ€ï¼Œè¾“å…¥å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull minio/minio</span><br></pre></td></tr></table></figure><p>â€</p><p>ç­‰å¾…ä¸‹è½½å®Œæ¯•åï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼šconfigå’Œdataï¼Œä½œä¸ºminIOçš„dockeræ˜ å°„æ–‡ä»¶å¤¹</p><p><img src="/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/image-20210823142734-i76o6a9.png" alt="image.png"></p><p>â€</p><p>æ‰§è¡Œå‘½ä»¤ï¼Œå¯åŠ¨å®¹å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  -p 9000:9000 \</span><br><span class="line">  -p 9001:9001 \</span><br><span class="line">  --name minio \</span><br><span class="line">  -e <span class="string">&quot;MINIO_ROOT_USER=KALOSORA&quot;</span> \</span><br><span class="line">  -e <span class="string">&quot;MINIO_ROOT_PASSWORD=KALOSORA&quot;</span> \</span><br><span class="line">  -v /Users/kalosora/docker-reflection/minio/data:/data \</span><br><span class="line">  -v /Users/kalosora/docker-reflection/minio/config:/root/.minio \</span><br><span class="line">  minio/minio server /data --console-address <span class="string">&quot;:9001&quot;</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤è¯´æ˜ï¼š</p><ul><li>éœ€è¦æ˜ å°„ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªæ˜¯apiç«¯å£ï¼Œå¦ä¸€ä¸ªæ˜¯webæ§åˆ¶å°ç«¯å£ï¼Œæœ€åè¦ç”¨ <code>--console-address</code> æŒ‡å®šæ§åˆ¶å°ï¼Œé‚£ä¹ˆæ­¤æ—¶9001è¢«æŒ‡å®šä¸ºæ§åˆ¶å°ç«¯å£ï¼Œå¦ä¸€ä¸ª9000å°±ä¼šè‡ªåŠ¨å˜æˆAPIç«¯å£</li><li>USERå’ŒPASSWORDæœ€å¥½æ˜¯çº¯è‹±æ–‡å­—ç¬¦ä¸²ï¼Œä¸è¦åŒ…å«ç‰¹æ®Šç¬¦å·ï¼Œå› ä¸ºæ›¾ç»è¯•è¿‡ç™»å½•ä»¥åJavaä¸Šä¼ ä¸äº†æ–‡ä»¶</li><li>è¿™é‡Œæ˜ å°„çš„&#x2F;dataå’Œ&#x2F;configè·¯å¾„å¯¹åº”ä¸Šé¢åˆ›å»ºçš„ä¸¤ä¸ªæ–‡ä»¶å¤¹è·¯å¾„</li></ul><p>â€</p><p>å½“dockeråå°æ˜¾ç¤ºå¦‚ä¸‹å³ä¸ºæ­å»ºå®Œæˆ</p><p><img src="/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/image-20210823143155-j8ejxnc.png" alt="image.png"></p><p>â€</p><h2 id="è®¾ç½®è®¿é—®ç­–ç•¥"><a href="#è®¾ç½®è®¿é—®ç­–ç•¥" class="headerlink" title="è®¾ç½®è®¿é—®ç­–ç•¥"></a>è®¾ç½®è®¿é—®ç­–ç•¥</h2><p>ç™»é™†åˆ°æ§åˆ¶å°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:9001</span><br></pre></td></tr></table></figure><p>â€</p><p>ç‚¹å‡»å³ä¸Šè§’æ·»åŠ å­˜å‚¨æ¡¶</p><p><img src="/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/image-20210823143309-9r3x26w.png" alt="image.png"></p><p>â€</p><p>æ·»åŠ å®Œæ¯•åï¼Œè®¾ç½®è®¿é—®ç­–ç•¥ä¸ºpublicï¼Œè¿™æ ·å¯ä»¥é€šè¿‡ <code>http://127.0.0.1:9001/å­˜å‚¨æ¡¶åç§°/æ–‡ä»¶å</code> çš„å½¢å¼è®¿é—®</p><p><img src="/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/image-20210823143432-vdi8abb.png" alt="image.png"></p><p>â€</p><p>æœ€åæ·»åŠ ä¸€ä¸ªè®¿é—®è§„åˆ™</p><p><img src="/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/image-20210823143517-dmvj87d.png" alt="image.png"></p><p>â€</p><p>æŒ‰ç…§å›¾é‡Œçš„è¿›è¡Œè®¾ç½®å³å¯</p><p><img src="/2021/08/23/MinIO%E6%90%AD%E5%BB%BAOSS/image-20210823143543-6cub0ux.png" alt="image.png"></p><p>â€</p><h2 id="ç®€å•å®ä¾‹"><a href="#ç®€å•å®ä¾‹" class="headerlink" title="ç®€å•å®ä¾‹"></a>ç®€å•å®ä¾‹</h2><p>mavenä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--           Minio     --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â€</p><h3 id="æœ¬åœ°æ–‡ä»¶ä¸Šä¼ "><a href="#æœ¬åœ°æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æœ¬åœ°æ–‡ä»¶ä¸Šä¼ "></a>æœ¬åœ°æ–‡ä»¶ä¸Šä¼ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// MinIO OSS</span></span><br><span class="line"><span class="comment">// æµ‹è¯•æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException, NoSuchAlgorithmException, InvalidKeyException &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Base information</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">accessKey</span> <span class="operator">=</span> <span class="string">&quot;KALOSORA&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">secretKey</span> <span class="operator">=</span> <span class="string">&quot;KALOSORA&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">serverUrl</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:9000&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">bucketName</span> <span class="operator">=</span> <span class="string">&quot;images&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a minioClient with the MinIO server playground, its access key and secret key.</span></span><br><span class="line">        <span class="type">MinioClient</span> <span class="variable">minioClient</span> <span class="operator">=</span></span><br><span class="line">                MinioClient.builder()</span><br><span class="line">                        .endpoint(serverUrl)</span><br><span class="line">                        .credentials(accessKey, secretKey)</span><br><span class="line">                        .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Make &#x27;asiatrip&#x27; bucket if not exist.</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">found</span> <span class="operator">=</span></span><br><span class="line">                minioClient.bucketExists(BucketExistsArgs.builder().bucket(bucketName).build());</span><br><span class="line">        <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">            <span class="comment">// Make a new bucket called &#x27;asiatrip&#x27;.</span></span><br><span class="line">            minioClient.makeBucket(MakeBucketArgs.builder().bucket(bucketName).build());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Bucket already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Upload &#x27;/home/user/Photos/asiaphotos.zip&#x27; as object name &#x27;asiaphotos-2015.zip&#x27; to bucket</span></span><br><span class="line">        <span class="comment">// &#x27;asiatrip&#x27;.</span></span><br><span class="line">        minioClient.uploadObject(</span><br><span class="line">                UploadObjectArgs.builder()</span><br><span class="line">                        <span class="comment">//.contentType(&quot;image/jpg&quot;)</span></span><br><span class="line">                        .bucket(bucketName)</span><br><span class="line">                        .object(<span class="string">&quot;portal-cover.jpg&quot;</span>)</span><br><span class="line">                        .filename(<span class="string">&quot;/Users/kalosora/Desktop/portal-cover.jpg&quot;</span>)</span><br><span class="line">                        .build());</span><br><span class="line">        System.out.println(<span class="string">&quot;File has been uploaded!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MinioException e) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Error occurred: &quot;</span> + e);</span><br><span class="line">        System.out.println(<span class="string">&quot;HTTP trace: &quot;</span> + e.httpTrace());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="æ–‡ä»¶æµä¸Šä¼ "><a href="#æ–‡ä»¶æµä¸Šä¼ " class="headerlink" title="æ–‡ä»¶æµä¸Šä¼ "></a>æ–‡ä»¶æµä¸Šä¼ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, NoSuchAlgorithmException, InvalidKeyException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Base information</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">accessKey</span> <span class="operator">=</span> <span class="string">&quot;KALOSORA&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">secretKey</span> <span class="operator">=</span> <span class="string">&quot;KALOSORA&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">serverUrl</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:9000&quot;</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">bucketName</span> <span class="operator">=</span> <span class="string">&quot;article&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Create a minioClient with the MinIO server playground, its access key and secret key.</span></span><br><span class="line">            <span class="type">MinioClient</span> <span class="variable">minioClient</span> <span class="operator">=</span></span><br><span class="line">                    MinioClient.builder()</span><br><span class="line">                            .endpoint(serverUrl)</span><br><span class="line">                            .credentials(accessKey, secretKey)</span><br><span class="line">                            .build();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Make &#x27;asiatrip&#x27; bucket if not exist.</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">found</span> <span class="operator">=</span></span><br><span class="line">                    minioClient.bucketExists(BucketExistsArgs.builder().bucket(bucketName).build());</span><br><span class="line">            <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">                <span class="comment">// Make a new bucket called &#x27;asiatrip&#x27;.</span></span><br><span class="line">                minioClient.makeBucket(MakeBucketArgs.builder().bucket(bucketName).build());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Bucket &#x27;test&#x27; already exists.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é€šè¿‡æ–‡ä»¶æµä¸Šä¼ </span></span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/Users/kalosora/Downloads/tempfile/210426A9N10GBYNC_æ•°æ®ç»“æ„ - é›†åˆ.md&quot;</span>);</span><br><span class="line">            minioClient.putObject(</span><br><span class="line">                    PutObjectArgs.builder().bucket(bucketName)</span><br><span class="line">                            .object(<span class="string">&quot;kalosora/article.md&quot;</span>) <span class="comment">// è¿™é‡Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆkalosoraæ–‡ä»¶å¤¹</span></span><br><span class="line">                            .stream(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file), -<span class="number">1</span>, <span class="number">10485760</span>)</span><br><span class="line">                            .build());</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;File has been uploaded!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MinioException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Error occurred: &quot;</span> + e);</span><br><span class="line">            System.out.println(<span class="string">&quot;HTTP trace: &quot;</span> + e.httpTrace());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€</p><h2 id="Springbootæ•´åˆ"><a href="#Springbootæ•´åˆ" class="headerlink" title="Springbootæ•´åˆ"></a>Springbootæ•´åˆ</h2><p>â€</p><p>å‰ç«¯å¼•ç”¨ä¸Šä¼ åçš„å›¾ç‰‡</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:9000/images/portal-cover.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Photo 1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;img-fluid&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>å®Œæ•´å®ä¾‹1</p><blockquote><p><a href="https://blog.csdn.net/zhuyu19911016520/article/details/109448375?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_v2~rank_aggregation-15-109448375.pc_agg_rank_aggregation&utm_term=minio+%E5%AD%98%E5%82%A8%E8%A7%86%E9%A2%91&spm=1000.2123.3001.4430">https://blog.csdn.net/zhuyu19911016520/article/details/109448375?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_v2~rank_aggregation-15-109448375.pc_agg_rank_aggregation&amp;utm_term=minio+å­˜å‚¨è§†é¢‘&amp;spm=1000.2123.3001.4430</a></p></blockquote><p>å®Œæ•´å®ä¾‹2</p><blockquote><p><a href="https://blog.csdn.net/qq_43230007/article/details/108701081?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_v2~rank_aggregation-2-108701081.pc_agg_rank_aggregation&utm_term=minio%E6%96%87%E4%BB%B6%E6%B5%81&spm=1000.2123.3001.4430">https://blog.csdn.net/qq_43230007/article/details/108701081?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_v2~rank_aggregation-2-108701081.pc_agg_rank_aggregation&amp;utm_term=minioæ–‡ä»¶æµ&amp;spm=1000.2123.3001.4430</a></p></blockquote><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MinIOæ­å»ºOSS&quot;&gt;&lt;a href=&quot;#MinIOæ­å»ºOSS&quot; class=&quot;headerlink&quot; title=&quot;MinIOæ­å»ºOSS&quot;&gt;&lt;/a&gt;MinIOæ­å»ºOSS&lt;/h1&gt;&lt;h2 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;head</summary>
      
    
    
    
    <category term="Java" scheme="http://example.com/categories/Java/"/>
    
    
    <category term="Spring" scheme="http://example.com/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>Dockeréƒ¨ç½²Eureka</title>
    <link href="http://example.com/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/"/>
    <id>http://example.com/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/</id>
    <published>2021-07-14T07:21:03.000Z</published>
    <updated>2025-03-04T00:53:03.048Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Dockeréƒ¨ç½²Eureka"><a href="#Dockeréƒ¨ç½²Eureka" class="headerlink" title="Dockeréƒ¨ç½²Eureka"></a>Dockeréƒ¨ç½²Eureka</h1><h2 id="SpringCloudæ‰“åŒ…"><a href="#SpringCloudæ‰“åŒ…" class="headerlink" title="SpringCloudæ‰“åŒ…"></a>SpringCloudæ‰“åŒ…</h2><p>ã€æ³¨æ„ã€‘</p><ul><li><p>å…¶ä»–å¾®æœåŠ¡ç»„ä»¶éƒ¨ç½²æ–¹å¼ç›¸åŒï¼Œå¦‚zuulä¹Ÿèƒ½è¿™æ ·éƒ¨ç½²ï¼ˆéƒ¨ç½²ä¾ç„¶å¤±è´¥ï¼‰</p></li><li><p>éƒ¨ç½²zuulè¦æŒ‡å®šæœ¬åœ°ç½‘ç»œ <code>--network=host </code></p><ul><li><blockquote><p>docker run â€“network&#x3D;host â€“name zuul-server  -d -p 7070:7070 springcloud&#x2F;zuul-server</p></blockquote></li></ul></li></ul><p>â€</p><p>1.åœ¨éœ€è¦æ‰“åŒ…çš„é¡¹ç›®çš„ <code>pom.xml</code> ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ‰“åŒ…å‚æ•° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ‰“åŒ…çš„æ–‡ä»¶åç§° --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>eureka<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>â€</p><p>2.æ›´æ–°mavenï¼Œå¹¶å…¨å±€install</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714091040-72udekv.png" alt="image.png">  </p><p>â€</p><p>ç›´åˆ°å‡ºç°æ„å»ºæˆåŠŸå­—æ ·</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714091121-5crabt0.png" alt="image.png">  </p><p>â€</p><p>3.æ‰¾åˆ°éœ€è¦æ‰“åŒ…çš„é¡¹ç›®ï¼Œè¿™é‡Œä»¥ eureka ä¸ºä¾‹ï¼Œç‚¹å‡»package</p><p>ç›´åˆ°å‡ºç°æ‰“åŒ…æˆåŠŸå­—æ ·</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714091257-0fnxdxv.png" alt="image.png">  </p><p>â€</p><p>4.å‘½ä»¤ç»ˆç«¯è¿è¡Œï¼Œæµ‹è¯•ç³»ç»Ÿæ˜¯å¦æ­£å¸¸è¿æ¥åˆ°è¯¥é¡¹ç›®</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">java </span>-<span class="keyword">jar </span>eureka.<span class="keyword">jar</span></span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœå¦‚ä¸‹ï¼ˆéœ€è¦ç»ˆæ­¢æ—¶ï¼Œ<code>ctrl + c</code> æˆ– å…³é—­ç»ˆç«¯çª—å£ å³å¯ï¼‰</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714091413-79bzuse.png" alt="image.png">  </p><h2 id="jaræ„å»ºé•œåƒ"><a href="#jaræ„å»ºé•œåƒ" class="headerlink" title="jaræ„å»ºé•œåƒ"></a>jaræ„å»ºé•œåƒ</h2><p>1.æ‹‰å–jdké•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull java:8</span><br></pre></td></tr></table></figure><p>â€</p><p>2.æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”æŠŠjaråŒ…æ”¾è¿›å»</p><p>3.åœ¨æ–°å»ºçš„ç›®å½•ä¸­ï¼Œåˆ›å»ºåä¸ºDockerfileçš„æ–‡ä»¶</p><ul><li>EXPOSEï¼šè¡¨æ˜æš´éœ²çš„ç«¯å£å·</li><li>ADDï¼šè¡¨æ˜è¦æ·»åŠ çš„jaråŒ…</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line">EXPOSE 7070</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD eureka.jar app.jar</span><br><span class="line">RUN sh -c &#x27;touch /app.jar&#x27;</span><br><span class="line">ENV JAVA_OPTS=&quot;&quot;</span><br><span class="line">ENTRYPOINT [ &quot;sh&quot;, &quot;-c&quot;, &quot;java $JAVA_OPTS -Djava.security.egd=file:/dev/./urandom -jar /app.jar&quot; ]</span><br></pre></td></tr></table></figure><p>â€</p><p>ç›®å½•å†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714100334-l0hh2wd.png" alt="image.png">  </p><p>â€</p><p>4.å‘½ä»¤ç»ˆç«¯cdè¿›å…¥è¯¥ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤</p><p>ã€æ³¨æ„ã€‘å‘½ä»¤æœ«å°¾æœ‰ä¸ª â€˜.â€™ ä»£è¡¨å½“å‰è·¯å¾„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t springcloud/eureka .</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœï¼š</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714095258-vnft06a.png" alt="image.png">  </p><p>â€</p><p>5.åœ¨dockerä¸­æŸ¥çœ‹é•œåƒ</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤ <code>docker images</code></p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714095344-w6ih4fz.png" alt="image.png">  </p><p>â€</p><p>6.åˆ›å»ºå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 7070:7070 springcloud/eureka</span><br></pre></td></tr></table></figure><p>â€</p><p>7.è®¿é—®eureka</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:7070</span><br></pre></td></tr></table></figure><p>â€</p><p>ç»“æœå¯ä»¥çœ‹åˆ°è¿è¡ŒæˆåŠŸ</p><p><img src="/2021/07/14/Docker%E9%83%A8%E7%BD%B2Eureka/image-20210714095610-yyuntu2.png" alt="image.png">  </p><p>â€</p><p>â€</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Dockeréƒ¨ç½²Eureka&quot;&gt;&lt;a href=&quot;#Dockeréƒ¨ç½²Eureka&quot; class=&quot;headerlink&quot; title=&quot;Dockeréƒ¨ç½²Eureka&quot;&gt;&lt;/a&gt;Dockeréƒ¨ç½²Eureka&lt;/h1&gt;&lt;h2 id=&quot;SpringCloudæ‰“åŒ…&quot;&gt;&lt;a</summary>
      
    
    
    
    <category term="Cloud Native" scheme="http://example.com/categories/Cloud-Native/"/>
    
    
    <category term="Docker" scheme="http://example.com/tags/Docker/"/>
    
    <category term="Spring" scheme="http://example.com/tags/Spring/"/>
    
    <category term="Devops" scheme="http://example.com/tags/Devops/"/>
    
  </entry>
  
</feed>
